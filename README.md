# 文档翻译与结构化解析

## 项目介绍
本项目完成了对2024(short list)md全文翻译 + 结构化解析为程序友好的json格式，已完成两大核心任务：  
将原始文档全文翻译为中文并保留 Markdown 格式（输出full_zh.md）  
将文档转化为程序友好的 QA 格式 JSON 数组（输出full_zh.json）  
## 代码结构
results/  
├── full_zh.md  # 翻译完成的中文文档  
├── full_zh.json  # 程序友好json文档  
src/  
├── call_llm_api.py   # LLM接口调用封装（如GLM模型）  
├── clean_md.py       # Markdown格式清洗、标准化工具  
├── translate.py      # 文档翻译任务（任务一核心脚本）  
└── create_data.py    # QA结构化解析任务（任务二核心脚本）  
README.md  
  
## 核心功能 & 项目亮点
### 1. 翻译任务：精准 + 高效的 Markdown 格式保留
1. 格式无损翻译：自动识别公式、图片、标题等 Markdown 元素，仅翻译文本内容，完全保留原始格式  
2. 重复内容缓存：通过文本清洗生成缓存 Key，自动跳过重复段落翻译，大幅节省 LLM Token 消耗（翻译条数1437->960）  
3. 分段安全处理：按段落拆分文档后逐段翻译，避免长文本截断，同时兼容公式 / 图片 / 标题的 “免翻译” 逻辑  
### 2. QA 结构化解析：智能 + 鲁棒的文档拆分
1. 规则提取：通过正则自动拆分题目块（识别# A1./C2.等题号），问题（通过每道题后的（国家）解析），答案（通过"答案："解析），解题方法（通过"解答1："解析）  
2. LLM保底提取：在复杂块规则提取失败时候,自动降级为 LLM 解析，保证极端场景下的鲁棒性  
3. 图片 Base64 嵌入：自动将文档中的图片转为 Base64 编码并嵌入 JSON，实现数据 “单文件化” 存储  

## 解题思路
### 1.查看full.md与原文档full.pdf
1.1 发现md文档中许多格式错乱之处，如标题，漏解析内容等，使用python脚本清理md文档  
### 2.翻译任务
2.1 根据文档特点，按段落切分翻译，以下几类内容可以跳过：1.图片；2.公式；3.标题  
2.2 文档中有大量重复内容，如国家名称，Solution中也包含Problem中的题目，所以可以去重，减少翻译使用token数：1.清理段落内容删去符号Latex公式等作为key；2.组件翻译缓存，以此去重  
### 3.结构化解析任务
3.1 根据文档格式规则提取  
3.2 使用LLM在提取失败时候保底  

## 不足 & 后续可优化点
1. 细节处理不足：如有些图片的图例未翻译，后续可以在正则规则上加入一步检查解决  
2. 调用LLM API进行批量任务时，可根据API可接受的并发大小/是否支持批处理，使用异步并发/batch调用，以此加速  
3. 泛化性不足。大多逻辑来源于对数据（2024 short list）的格式观察，难以直接迁移到相似任务中  