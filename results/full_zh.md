# 入围题目

含解决方案

![](images/887553d1131f80d9bb9f062f009381d2eedbb3f6f9d9df11fbfef3957b1824c5.jpg)

# 精选题目及解答

候选名单必须严格保密，直至下届国际数学奥林匹克竞赛结束。IMO总章程§6.6

# 参与贡献的国家

2024年国际数学奥林匹克竞赛组织委员会与选题委员会感谢以下63个国家提供229道题目提案：

阿尔及利亚， 澳大利亚， 阿塞拜疆， 孟加拉国， 白俄罗斯， 巴西， 保加利亚,加拿大， 中国， 哥伦比亚， 克罗地亚， 塞浦路斯， 捷克共和国， 丹麦,多米尼加共和国, 厄瓜多尔, 爱沙尼亚, 法国, 格鲁吉亚, 德国, 加纳,希腊，香港，印度，印度尼西亚，爱尔兰， 伊朗，以色列， 日本,哈萨克斯坦， 科索沃， 拉脱维亚， 立陶宛， 卢森堡, 马来西亚， 墨西哥,摩尔多瓦， 荷兰， 新西兰， 挪威， 秘鲁， 波兰， 葡萄牙,罗马尼亚， 塞内加尔， 塞尔维亚， 新加坡， 斯洛伐克, 斯洛文尼亚， 南非,韩国, 西班牙, 瑞典, 瑞士, 叙利亚, 台湾, 泰国, 突尼斯,土耳其, 乌干达, 乌克兰, 美国, 乌兹别克斯坦

# 命题委员会

![](images/4a25c17d8e5d644bc1fc27cad1ac18895c2d2a125e774ac92c0bd73f8adc551c.jpg)

阿伦·托马斯, 艾英华, 吴恩达, 盖扎·科什, 郭艾文, 爱丽丝·卡洛蒂, 詹姆斯·亚伦森, 萨姆·比林, 艾德里安·阿吉西劳, 詹姆斯·克兰奇, 约瑟夫·迈尔斯 (主席), 游哈维, 玛丽亚-罗米娜·伊万, 任迈克尔, 伊丽莎·洛伦佐·加西亚

# 问题

# 代数

# A1.

求所有实数 $\alpha$ 使得该数

$$
\lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor
$$

对于每一个正整数 $n$，都是 $n$ 的倍数。（此处 $\lfloor z \rfloor$ 表示小于或等于 $z$ 的最大整数）

(哥伦比亚)

# A2.

设 $n$ 为一个正整数。
求最小可能值

$$
S = 2 ^ { 0 } x _ { 0 } ^ { 2 } + 2 ^ { 1 } x _ { 1 } ^ { 2 } + \cdot \cdot \cdot + 2 ^ { n } x _ { n } ^ { 2 } ,
$$

其中 $x _ { 0 }$ ， $x _ { 1 }$ ， $\cdot \cdot \cdot$ ， $x _ { n }$ 是非负整数，使得 $x _ { 0 } + x _ { 1 } + \cdot \cdot \cdot + x _ { n } = n$ ：

(中国)

# A3.

判断是否对于每个正实数序列（$u _ { n }$），

$$
\frac { 3 ^ { a _ { 1 } } + 3 ^ { a _ { 2 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } < \frac { 1 } { 2 0 2 4 }
$$

对于至少一个正整数 $n$ 成立

(中国)

# A4.

设 $\mathbb{Z}_{>0}$ 为所有正整数构成的集合。试确定集合 $\{2^0, 2^1, 2^2, \dots\}$ 的所有子集 $\boldsymbol{S}$，使得存在一个函数 $f \colon \mathbb{Z}_{>0} \to \mathbb{Z}_{>0}$ 满足：

$$
\begin{array} { r } { S = \{ f ( a + b ) - f ( a ) - f ( b ) \mid a , b \in \mathbb { Z } _ { > 0 } \} . } \end{array}
$$

(泰国)

# A5.

求所有由实数构成的周期序列 $a _ { 1 }$ $\ 1 , a _ { 2 } , \ldots$，使得以下条件对于所有 $n \geqslant 1$ 成立：：

$$
a _ { n + 2 } + a _ { n } ^ { 2 } = a _ { n } + a _ { n + 1 } ^ { 2 } \qquad { \mathrm { a n d } } \qquad | a _ { n + 1 } - a _ { n } | \leqslant 1 .
$$

(科索乌)

# A6.

设 $a _ { 0 }$ ， $a _ { 1 }$ ， $a _ { 2 }$ ,... 为一个无限严格递增的正整数序列，使得对于每个 $n \geqslant 1$ 我们有

$$
a _ { n } \in \left\{ { \frac { a _ { n - 1 } + a _ { n + 1 } } { 2 } } , { \sqrt { a _ { n - 1 } \cdot a _ { n + 1 } } } \right\} .
$$

设 $b _ { 1 }$ ， $b _ { 2 }$ ，... 是一个由字母组成的无限序列，定义为

$$
b _ { n } = { \left\{ \begin{array} { l l } { A , } & { { \mathrm { i f ~ } } a _ { n } = { \frac { 1 } { 2 } } ( a _ { n - 1 } + a _ { n + 1 } ) ; } \\ { G , } & { { \mathrm { o t h e r w i s e } } . } \end{array} \right. }
$$

证明存在正整数 $n _ { 0 }$ 和 $d$，使得对于所有 $n \geqslant n _ { 0 }$ 都有 $b _ { n + d } = b _ { n }$。

(捷克共和国)

# A7.

令 $\mathbb { Q }$ 为有理数的集合。令 $f \colon \mathbb { Q } \to \mathbb { Q }$ 为一函数，满足以下性质：对于所有 $x$ ， $y \in \mathbb { Q }$ ，

$$
f ( x + f ( y ) ) = f ( x ) + y \qquad { \mathrm { o r } } \qquad f ( f ( x ) + y ) = x + f ( y ) .
$$

求集合 $\{ f ( x ) + f ( - x ) \mid x \in \mathbb { Q } \}$ 的最大可能元素个数

# A8.

设 $p \neq q$ 是互质的正整数。确定所有由正整数组成的无穷序列 $a _ { 1 }$ ， $a _ { 2 }$ ，...，使其对于所有 $n \geqslant 1$ 都满足以下条件：

$$
\begin{array} { r l } & { \operatorname* { m a x } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + p } ) - \operatorname* { m i n } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + p } ) = p \qquad \mathrm { a n d } } \\ & { \operatorname* { m a x } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + q } ) - \operatorname* { m i n } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + q } ) = q . } \end{array}
$$

# 组合数学

# C1.

设 $n$ 为一个正整数。一个有 $n$ 名学生的班级进行 $n$ 场比赛，每场比赛都有排名且没有平局。对于正整数 $a$ 和 $b$，如果一名学生在至少 $a$ 场比赛中都进入了前 $b$ 名，则该学生有资格获得一个评级 $( a , b )$。他们的最终得分是其所有有资格获得的评级中，$a - b$ 的最大值。

求n名学生所有分数的最大可能和。

(澳大利亚)

# C2.

设 $n$ 为一个正整数。将整数 1, 2, 3, ..., $n ^ { 2 }$ 填入一个 $n \times n$ 的棋盘，每个整数填入恰好一个格子，且每个格子中恰好有一个整数。对于每一个满足 $d \mid n$ 的整数 $d$，棋盘的 $d$-划分是指将棋盘划分为 $( n / d ) ^ { 2 }$ 个不重叠的 $d \times d$ 子棋盘，且每个格子恰好属于一个 $d \times d$ 子棋盘。

我们称 $n$ 为一个酷数，如果可以将整数写在 $n \times n$ 的棋盘上，使得对于每个满足 $d \mid n$ 且 $1 < d < n$ 的整数 $d$，在棋盘的 $d$-划分中，每个 $d \times d$ 子棋盘中所写整数的和都不是 $d$ 的倍数：

请找出所有偶冷数。

(土耳其)

# C3.

设 $n$ 为一个正整数。有 $2n$ 位骑士围坐在一张圆桌旁。他们由 $n$ 对伙伴组成，每一对都希望握手。一对伙伴只有在彼此相邻时才能握手。每分钟，有一对相邻的骑士交换位置。

找出相邻骑士交换的最小次数，使得无论初始的排列如何，每个骑士都能在某个时刻与她的搭档相遇并握手。

(白俄罗斯)

# C4.

在一个有2024行和2023列的棋盘上，蜗牛特博试图从第一行移动到最后一行。在每次尝试中，他选择从第一行的任意一个单元格开始，然后一次移动一步，到一个有公共边的相邻单元格。如果他到达最后一行的任意一个单元格，他就赢了。然而，在2022个单元格中，有2022个预先设定的、隐藏的怪物，在除第一行和最后一行之外的每一行中各有一个，并且没有任何两个怪物共享同一列。如果特博不幸到达一个有怪物的单元格，他的尝试就结束了，并且他会被传送回第一行以开始新的尝试。这些怪物不会移动。

假设Turbo被允许进行$n$次尝试。确定$n$的最小值，使得他有一个保证能到达最后一行的策略，无论怪物的位置如何。

(香港)

# C5.

令 $N$ 是一个正整数。Geoff 和 Ceri 玩一个游戏，游戏开始时，他们在黑板上写下数字 1, 2,..., $N$。然后他们轮流进行操作，由 Geoff 先开始。每一步操作包括：选择一对整数 $( k , n )$，其中 $k \geqslant 0$ 且 $n$ 是黑板上的一个整数，然后擦除黑板上所有满足 $2 ^ { k }$ 整除 $n - s$ 的整数 $s$。游戏持续进行，直到黑板变空。擦除黑板上最后一个整数的玩家输。

确定所有$N$的值，使得无论Ceri如何行动，Geoff都能确保自己获胜。

(印度尼西亚)

# C6.

设 $n$ 和 $T$ 为正整数。James 有 $4n$ 个弹珠，重量分别为 1, 2, ..., 4n。他将这些弹珠放在一个天平上，使得两边的重量相等。Andrew 可以将一个弹珠从天平的一边移动到另一边，使得两边重量的绝对差至多为 $T$：

求用 $n$ 表示的最小正整数 $T$，使得 Andrew 可以进行一系列移动，从而无论 James 最初如何放置弹珠，每个弹珠最终都位于天平的另一侧。

(加纳)

# C7.

设 $N$ 为一个正整数，并设 $a _ { 1 }$ ， $a _ { 2 }$ ，...为一个由正整数组成的无限序列。假设对于每个 $n > N$，$a _ { n }$ 等于 $a _ { n - 1 }$ 在列表 a1, a2, ..., an-1 中出现的次数。

证明序列 $a _ { 1 }$ ， $a _ { 3 }$ ， $a _ { 5 }$ ，... 和 $a _ { 2 }$ ， $a _ { 4 }$ ， $a _ { 6 }$ ，... 中至少有一个是最终周期的。

(澳大利亚)

# C8.

设 $n$ 为一个正整数。给定一个 $n \times n$ 的棋盘，左上角的单位方格最初被涂成黑色，而其他方格则被涂成白色。然后我们对该棋盘进行一系列的涂色操作。在每次操作中，我们选择一个恰好有一个方格被涂成黑色的 $2 \times 2$ 正方形，并将该正方形中其余的三个方格涂成黑色。

确定所有 $n$ 的值，使得整个棋盘可以被涂成黑色。

# 几何

# G1.

设 $A B C D$ 为一个圆内接四边形，且满足 $A C < B D < A D$ 且 $\angle D B A < 9 0 ^ { \circ }$ ： 点 $E$ 位于过点 $\boldsymbol { D }$ 且与 $A B$ 平行的直线上，且满足 $E$ 和 $C$ 位于直线 $A D$ 的两侧，且 $A C = D E$ 。 点 $F$ 位于过点 $A$ 且与 $\boldsymbol C \boldsymbol D$ 平行的直线上，且满足 $F$ 和 $C$ 位于直线 $A D$ 的两侧，且 $B D = A F$ ：

证明线段BC和EF的垂直平分线在四边形ABCD的外接圆上相交。

(乌克兰)

# G2.

设 $ABC$ 为一个满足 $AB < AC < BC$ 的三角形，其内心为 $I$，内切圆为 $\omega$。
设 $X$ 为边 $BC$ 内部的一点，使得过 $X$ 且平行于 $AC$ 的直线与 $\omega$ 相切：
同理，设 $Y$ 为边 $BC$ 内部的一点，使得过 $Y$ 且平行于 $AB$ 的直线与 $\omega$ 相切。
设 $AI$ 与三角形 $ABC$ 的外接圆交于另一点 $P \neq A$。
设 $K$ 和 $L$ 分别为 $AB$ 和 $AC$ 的中点。

证明 $\angle K I L + \angle Y P X = 1 8 0 ^ { \circ }$

(波兰)

# G3.

设 $ABCDE$ 是一个凸五边形，且 $M$ 是 $AB$ 的中点。假设线段 $AB$ 与三角形 $CME$ 的外接圆相切于点 $M$，且 $D$ 位于三角形 $AME$ 和 $BMC$ 的外接圆上。直线 $AD$ 和 $ME$ 相交于点 $K$，直线 $BD$ 和 $MC$ 相交于点 $L$。点 $P$ 和 $Q$ 位于直线 $EC$ 上，使得 $\angle PDC = \angle EDQ = \angle ADB$：

证明直线$KP$、$LQ$和$MD$共点。

(白俄罗斯)

# G4.

设 $ABCD$ 为一个四边形，其中 $AB$ 平行于 $CD$ 且 $AB < CD$。直线 $AD$ 和 $BC$ 相交于点 $P$。在三角形 $ABC$ 的外接圆上有一点 $X \neq C$，使得 $PC = PX$。在三角形 $ABD$ 的外接圆上有一点 $Y \neq D$，使得 $PD = PY$：直线 $AX$ 和 $BY$ 相交于点 $Q$：

证明 $P Q$ 平行于 $A B$

(乌克兰)

# G5.

设 $ABC$ 是一个以 $I$ 为内心的三角形，设 $\Omega$ 为三角形 $BIC$ 的外接圆：设 $K$ 为线段 $BC$ 内部的一点，使得 $\angle BAK < \angle KAC$。$\angle BKA$ 的角平分线与 $\Omega$ 相交于点 $W$ 和 $X$，且 $A$ 和 $W$ 位于 $BC$ 的同一侧，$\angle CKA$ 的角平分线与 $\Omega$ 相交于点 $Y$ 和 $Z$，且 $A$ 和 $Y$ 位于 $BC$ 的同一侧。

证明 $\angle W A Y = \angle Z A X$

(乌兹别克斯坦)

# G6.

设 $ABC$ 为一个锐角三角形，且 $AB < AC$，设 $\Gamma$ 为 $ABC$ 的外接圆：
点 $X$ 和 $Y$ 位于 $\Gamma$ 上，使得 $XY$ 和 $BC$ 相交于 $\angle BAC$ 的外角平分线上。假设 $\Gamma$ 在点 $X$ 和 $Y$ 处的切线相交于点 $T$，且 $T$ 与 $A$ 在 $BC$ 的同侧，且 $TX$ 和 $TY$ 分别与 $BC$ 相交于点 $U$ 和 $V$。设 $J$ 为三角形 $TUV$ 的与顶点 $T$ 相对的旁切圆的圆心：

求证 $A J$ 平分 $\angle B A C$

# G7.

设 $ABC$ 为一个三角形，内心为 $I$，且满足 $AB < AC < BC$。直线 $AI$、$BI$ 和 $CI$ 与三角形 $ABC$ 的外接圆的第二个交点分别为 $M_A$、$M_B$ 和 $M_C$。直线 $AI$ 与 $BC$ 相交于点 $D$，直线 $BM_C$ 与 $CM_B$ 相交于点 $X$。设三角形 $XM_BM_C$ 和 $XBC$ 的外接圆再次相交于点 $S \neq X$。直线 $BX$ 和 $CX$ 与三角形 $SXM_A$ 的外接圆再次相交，交点分别为 $P \neq X$ 和 $Q \neq X$。

证明三角形 $SID$ 的外心在 $PQ$ 上。

(泰国)

# G8.

设 $ABC$ 为一个满足 $AB < AC < BC$ 的三角形，且设 $D$ 为线段 $BC$ 内部的一点。
设 $E$ 为三角形 $ABC$ 的外接圆上的一点，使得点 $A$ 和点 $E$ 位于直线 $BC$ 的两侧，且 $\angle BAD = \angle EAC$。
设 $I$，$I_B$，$I_C$，$J_B$，和 $J_C$ 分别为三角形 $ABC$，$ABD$，$ADC$，$ABE$，和 $AEC$ 的内心。

证明 $I _ { B }$ ， $I _ { C }$ ， $J _ { B }$ 和 $J _ { C }$ 共圆当且仅当 $A I$ ， $I _ { B } J _ { C }$ 和 $J _ { B } I _ { C }$ 共点。

(加拿大)

# 数论

# N1.

求所有正整数 $n$ 满足以下条件：对于 $n$ 的所有正因数 $d$，都有 $d + 1$ 整除 $n$ 或 $d + 1$ 是素数。

# N2.

确定所有由正整数组成的有限的、非空集合 $\boldsymbol{S}$，使得对于任意 $a$, $b \in S$，都存在 $c \in S$ 满足 $a \mid b + 2c$：

(荷兰)

# N3.

求出所有由正整数组成的序列 $a _ { 1 }$ ， $a _ { 2 }$ ，..，使得对于任意一对满足 $m \leqslant n$ 的正整数，算术平均和几何平均

$$
\frac { a _ { m } + a _ { m + 1 } + \cdot \cdot \cdot + a _ { n } } { n - m + 1 } \mathrm { a n d } ( a _ { m } a _ { m + 1 } \cdot \cdot \cdot a _ { n } ) ^ { \frac { 1 } { n - m + 1 } }
$$

都是整数。

(新加坡)

# N4. 

确定所有正整数 $a$ 和 $b$，使得存在一个正整数 $g$，满足对于所有足够大的 $n$，都有 $\gcd(a^n + b, b^n + a) = g$：

(印度尼西亚)

# N5.

设 $\boldsymbol { S }$ 为由素数组成的有限非空集合。令 $1 = b _ { 1 } < b _ { 2 } < \cdots$ 为所有素因数均属于 $\boldsymbol { S }$ 的正整数序列。证明：除有限个正整数 $n$ 外，存在正整数 $a _ { 1 }$，$a _ { 2 }$，…，$a _ { n }$ 使得

$$
{ \frac { a _ { 1 } } { b _ { 1 } } } + { \frac { a _ { 2 } } { b _ { 2 } } } + \cdots + { \frac { a _ { n } } { b _ { n } } } = \left\lceil { \frac { 1 } { b _ { 1 } } } + { \frac { 1 } { b _ { 2 } } } + \cdots + { \frac { 1 } { b _ { n } } } \right\rceil .
$$

(克罗地亚)

# N6.

设 $n$ 为一个正整数。我们称一个具有整数系数的多项式 $P$ 是 $n$-好的，如果存在一个具有整数系数的次数为 2 的多项式 $Q$，使得对于任意整数 $k$，$Q ( k ) ( P ( k ) + Q ( k ) )$ 都不被 $n$ 整除：

确定所有整数$n$，使得每个具有整数系数的多项式都是$n$-好多项式。

(法国)

# N7.

设 $\mathbb { Z } _ { > 0 }$ 表示正整数集合。设 $f \colon \mathbb { Z } _ { > 0 } \to \mathbb { Z } _ { > 0 }$ 是一个满足以下性质的函数：对于 $m$ ， $n \in \mathbb { Z } _ { > 0 }$ ，方程

$$
f ( m n ) ^ { 2 } = f ( m ^ { 2 } ) f ( f ( n ) ) f ( m f ( n ) )
$$

当且仅当 $m$ 和 $n$ 互质时成立。

对于每一个正整数 $n$，确定 $f(n)$ 的所有可能的值。

# 解决方案

# 代数

# A1.

求所有实数 $\alpha$ 使得该数

$$
\lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor
$$

对于每一个正整数 $n$，都是 $n$ 的倍数。（此处 $\lfloor z \rfloor$ 表示小于或等于 $z$ 的最大整数）

(哥伦比亚)

答案：所有偶数都满足问题的条件，且没有其他实数 $\alpha$ 也如此。

解法1. 首先我们将证明偶数满足该条件。若 $\alpha = 2 m$ 其中 $m$ 为整数，则

$$
\lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor = 2 m + 4 m + \cdot \cdot \cdot + 2 m n = m n ( n + 1 )
$$

其为 $n$ 的倍数

现在我们将证明它们是满足该问题条件的唯一实数。令 $\alpha = k + \epsilon$，其中 $k$ 是一个整数且 $0 \leqslant \epsilon < 1$。那么这个数

$$
\begin{array} { r } { \lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \dots + \lfloor n \alpha \rfloor = k + \lfloor \epsilon \rfloor + 2 k + \lfloor 2 \epsilon \rfloor + \dots + n k + \lfloor n \epsilon \rfloor } \\ { = \displaystyle \frac { k n ( n + 1 ) } { 2 } + \lfloor \epsilon \rfloor + \lfloor 2 \epsilon \rfloor + \dots + \lfloor n \epsilon \rfloor } \end{array}
$$

必须是 $n$ 的倍数。我们根据 $k$ 的奇偶性考虑两种情况：

情形1：$k$为偶数

那么kn(n+1)总是n的倍数。因此

$$
\lfloor \epsilon \rfloor + \lfloor 2 \epsilon \rfloor + \cdot \cdot \cdot + \lfloor n \epsilon \rfloor
$$

也必须是 $n$ 的倍数：

我们将通过强归纳法证明，对于每一个正整数 $n$，$\lfloor n \epsilon \rfloor = 0$。基础情况 $n = 1$ 由 $0 \leqslant \epsilon < 1$ 这一事实得出。假设对于所有 $1 \leqslant m < n$，都有 $\lfloor m \epsilon \rfloor = 0$：那么该数

$$
\lfloor \epsilon \rfloor + \lfloor 2 \epsilon \rfloor + \cdot \cdot \cdot + \lfloor n \epsilon \rfloor = \lfloor n \epsilon \rfloor
$$

必须是 $n$ 的倍数。因为 $0 \leqslant \epsilon < 1$，所以 $0 \leqslant n \epsilon < n$，这意味着 $\lfloor n \epsilon \rfloor$ 这个数必须等于 $0$：

等式 $\lfloor n \epsilon \rfloor = 0$ 意味着 $0 \leqslant \epsilon < 1 / n$。由于这对所有的n都必须成立，我们得出结论 $\epsilon = 0$，于是 $\alpha$ 是一个偶数。

情况 2: $k$ 是奇数。

我们将通过强归纳法证明，对于每一个自然数 $n$，都有 $\lfloor n \epsilon \rfloor = n - 1$。
基础情况 $n = 1$ 同样由 $0 \leqslant \epsilon < 1$ 这一事实得出。
让我们假设，对于每一个 $1 \leqslant m < n$，都有 $\lfloor m \epsilon \rfloor = m - 1$。
我们需要这个数

$$
{ \begin{array} { r l } & { { \frac { k n ( n + 1 ) } { 2 } } + \left\lfloor \epsilon \right\rfloor + \left\lfloor 2 \epsilon \right\rfloor + \cdot \cdot \cdot + \left\lfloor n \epsilon \right\rfloor = { \frac { k n ( n + 1 ) } { 2 } } + 0 + 1 + \cdot \cdot \cdot + ( n - 2 ) + \left\lfloor n \epsilon \right\rfloor } \\ & { \qquad = { \frac { k n ( n + 1 ) } { 2 } } + { \frac { ( n - 2 ) ( n - 1 ) } { 2 } } + \left\lfloor n \epsilon \right\rfloor } \\ & { \qquad = { \frac { k + 1 } { 2 } } n ^ { 2 } + { \frac { k - 3 } { 2 } } n + 1 + \left\lfloor n \epsilon \right\rfloor } \end{array} }
$$

是 $n$ 的倍数。因为 $k$ 是奇数，我们需要 $1 + \lfloor n \epsilon \rfloor$ 是 $n$ 的倍数。此外，由于 $0 \leqslant \epsilon < 1$，那么 $0 \leqslant n \epsilon < n$，所以 $\lfloor n \epsilon \rfloor = n - 1$，正如我们所期望的。

这意味着 $\textstyle 1 - { \frac { 1 } { n } } \leqslant \epsilon < 1$ 对于所有的 $n$，这是荒谬的。因此，在这种情况下没有其他解。

解法二. 与解法一类似，我们验证对于偶数，该条件成立。然后，不失一般性，我们可以假设 $0 \leqslant \alpha < 2$ 。我们设 $S _ { n } = \lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor$ ：注意到

$$
\begin{array} { l l } { { S _ { n } \equiv 0 } } & { { ( \mathrm { m o d } n ) } } \\ { { S _ { n } \equiv S _ { n } - S _ { n - 1 } = \lfloor n \alpha \rfloor } } & { { ( \mathrm { m o d } n - 1 ) } } \end{array}
$$

由于$\operatorname* { g c d } ( n , n - 1 ) = 1$，(1)和(2)意味着

$$
S _ { n } \equiv n { \bigl \lfloor } n \alpha { \bigr \rfloor } { \pmod { n ( n - 1 ) } } .
$$

此外，

$$
0 \leqslant n \lfloor n \alpha \rfloor - S _ { n } = \sum _ { k = 1 } ^ { n } \left( \lfloor n \alpha \rfloor - \lfloor k \alpha \rfloor \right) < \sum _ { k = 1 } ^ { n } \left( n \alpha - k \alpha + 1 \right) = { \frac { n ( n - 1 ) } { 2 } } \alpha + n .
$$

对于足够大的 $n$，(4) 式的右边小于 $n ( n - 1 )$ 。于是 (3) 式迫使

$$
0 = S _ { n } - n { \big \lfloor } n \alpha { \big \rfloor } = \sum _ { k = 1 } ^ { n } { \Big ( } { \big \lfloor } n \alpha { \big \rfloor } - { \big \lfloor } k \alpha { \big \rfloor } { \Big ) }
$$

对于足够大的$n$。

因为对于 $1 \leqslant k \leqslant n$，有 $\lfloor n \alpha \rfloor - \lfloor k \alpha \rfloor \geqslant 0$，我们从(5)式得到，对于所有足够大的 $n$，所有这些不等式都成为等式。特别地，对于所有足够大的 $n$，有 $\lfloor \alpha \rfloor = \lfloor n \alpha \rfloor$，这是荒谬的，除非 $\alpha = 0$：

注释。前一个解决方案的补充解法如下。

根据定义，我们有 $S _ { n } \leqslant \alpha \frac { n ( n + 1 ) } { 2 }$ ，另一方面 (5）推出 $S _ { n } \geqslant \alpha n ^ { 2 } - n$ 对于所有足够大的 $n$ ，所以 $\alpha = 0$ ：

解法三。同其他解法，不失一般性，我们可以假设 $0 \leqslant \alpha < 2$：偶数满足该条件，因此我们假设 $0 < \alpha < 2$ 并将导出矛盾。

对$n$进行归纳，我们将同时证明

$$
\lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor = n ^ { 2 } ,
$$

$$
\mathrm { a n d } \qquad { \frac { 2 n - 1 } { n } } \leqslant \alpha < 2 .
$$

基本情况是 $n = 1$ ：若 $\alpha < 1$ ，考虑 $\begin{array} { r } { m = \left| \frac { 1 } { \alpha } \right| > 1 } \end{array}$ ，则

$$
\lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor m \alpha \rfloor = 1
$$

不是 $m$ 的倍数，因此我们推导出 (7)。因此，$\lfloor \alpha \rfloor = 1$ 并且 (6) 成立。

对于归纳步骤：假设归纳假设对于 $n$ 成立，那么根据 (7)

$$
2 n + 1 - \frac { 1 } { n } \leqslant ( n + 1 ) \alpha < 2 n + 2 .
$$

因此，

$$
n ^ { 2 } + 2 n \leqslant \lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot + \lfloor n \alpha \rfloor + \lfloor ( n + 1 ) \alpha \rfloor = n ^ { 2 } + \lfloor ( n + 1 ) \alpha \rfloor < n ^ { 2 } + 2 n + 2 .
$$

因此，必然地 $\lfloor ( n + 1 ) \alpha \rfloor = 2 n + 1$ 且

$$
\lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor + \lfloor ( n + 1 ) \alpha \rfloor = ( n + 1 ) ^ { 2 }
$$

为了得到 $n + 1$ 的一个倍数。这两个等式分别给出了 (6) 和 (7)。最后，我们注意到条件 (7) 对于所有 $n$ 都成立会导致矛盾。

解法4. 与其他解法类似，不失一般性，我们假设 $0 < \alpha < 2$ 并导出矛盾。对于每个 $n$ ，我们定义

$$
b _ { n } = { \frac { \lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor } { n } } ,
$$

根据问题条件和我们的假设，这是一个非负整数。请注意

$$
\lfloor ( n + 1 ) \alpha \rfloor \geqslant \left\lfloor \alpha \right\rfloor , \left\lfloor 2 \alpha \right\rfloor , \ldots , \left\lfloor n \alpha \right\rfloor \quad { \mathrm { a n d } } \quad \left\lfloor ( n + 1 ) \alpha \right\rfloor > \left\lfloor \alpha \right\rfloor
$$

对于所有 $\textstyle n > { \frac { 1 } { \alpha } }$ 。因此，对于 $\textstyle n > { \frac { 1 } { \alpha } }$，有 $b _ { n + 1 } > b _ { n } \implies b _ { n + 1 } \geqslant b _ { n } + 1$ 。于是，对于所有这样的 $n$ ，

$$
b _ { n } \geqslant n + C
$$

其中 $C$ 是一个固定的整数。另一方面，$b _ { n }$ 的定义给出

$$
b _ { n } = { \frac { \lfloor \alpha \rfloor + \lfloor 2 \alpha \rfloor + \cdot \cdot \cdot + \lfloor n \alpha \rfloor } { n } } \leqslant { \frac { \alpha + 2 \alpha + \cdot \cdot \cdot + n \alpha } { n } } = { \frac { \alpha } { 2 } } ( n + 1 ) ,
$$

对于充分大的$n$，这是一个矛盾

# A2.

设 $n$ 为一个正整数。
求最小可能值

$$
S = 2 ^ { 0 } x _ { 0 } ^ { 2 } + 2 ^ { 1 } x _ { 1 } ^ { 2 } + \cdot \cdot \cdot + 2 ^ { n } x _ { n } ^ { 2 } ,
$$

其中 $x _ { 0 }$ ， $x _ { 1 }$ ，··.， $x _ { n }$ 是非负整数，满足 $x _ { 0 } + x _ { 1 } + \cdot \cdot \cdot + x _ { n } = n$ ：

(中国)

答案：最小值是 n(n+1)。

解法 1. 对于一个固定的 $n$，令 $f ( n )$ 表示 $S$ 的最小可能值。考虑以下变体：在所有由非负整数组成的无限序列 $x _ { 0 }$ ， $x _ { 1 }$ ，... 中，其中只有有限个是非零的，满足 $x _ { 0 } + x _ { 1 } + \cdot \cdot \cdot = n$，令 $g ( n )$ 表示...的最小可能值

$$
T = 2 ^ { 0 } x _ { 0 } ^ { 2 } + 2 ^ { 1 } x _ { 1 } ^ { 2 } + 2 ^ { 2 } x _ { 2 } ^ { 2 } + \cdot \cdot \cdot .
$$

显然，$g ( n ) \leqslant f ( n )$ 。反之，易见，如果一个序列 $x _ { 0 }$ ， $x _ { 1 } , \ldots .$ 达到了 $g ( n )$ 的最小值，那么 $x _ { 0 } \geqslant x _ { 1 } \geqslant \cdot \cdot \cdot$，从而 $x _ { n + 1 } = x _ { n + 2 } = \cdot \cdot \cdot = 0$ 。特别地，$f ( n ) = g ( n )$ ：

现在，我们希望得到一个关于 $g ( n )$ 的归纳公式。

请注意，为了在 $n \geqslant 1$ 时最小化 $T$，我们必须有 $x _ { 0 } \geqslant 1$，因为序列 $( x _ { i } )$ 是非递增的。请注意，的最小值

$$
2 ^ { 1 } x _ { 1 } ^ { 2 } + 2 ^ { 2 } x _ { 2 } ^ { 2 } + \cdot \cdot \cdot = 2 ( 2 ^ { 0 } x _ { 1 } ^ { 2 } + 2 ^ { 1 } x _ { 2 } ^ { 2 } + \cdot \cdot \cdot )
$$

对于所有满足 $x _ { 1 } + x _ { 2 } + \cdot \cdot \cdot = m$ 的非负整数无限序列，其结果恰好是 $2 g ( m )$。因此，对于 $n \geqslant 1$，我们有

$$
g ( n ) = \operatorname* { m i n } _ { x _ { 0 } \in \{ 1 , 2 , \ldots , n \} } \left( x _ { 0 } ^ { 2 } + 2 g ( n - x _ { 0 } ) \right) .
$$

我们现在用数学归纳法证明 $\begin{array} { r } { g ( n ) = \frac { n ( n + 1 ) } { 2 } } \end{array}$。
显然，$g ( 0 ) = 0$。
假设对于 $n = 0$ ， $1$ ，..., $N - 1$ ，该式已经得证。
那么，

$$
\begin{array} { l } { { x _ { 0 } ^ { 2 } + 2 g ( N - x _ { 0 } ) = x _ { 0 } ^ { 2 } + ( N - x _ { 0 } ) ( N - x _ { 0 } + 1 ) } } \\ { { \ \qquad = 2 x _ { 0 } ^ { 2 } - ( 2 N + 1 ) x _ { 0 } + N ( N + 1 ) } } \\ { { \ \qquad = \displaystyle \frac 1 2 \left[ ( 2 x _ { 0 } - N ) ( 2 x _ { 0 } - N - 1 ) + N ^ { 2 } + N \right] . } } \end{array}
$$

两个连续整数 $( 2 x _ { 0 } - N ) ( 2 x _ { 0 } - N - 1 )$ 的乘积总是非负的，并且当且仅当 $2 x _ { 0 }$ 是 $\{ N , N + 1 \}$ 中的偶数时它为零。因此，等式(1)中最终表达式的最小值是 $(N^2 + N)$，所以 $g(N) \leq (N+1)$，完成了归纳证明。

解法 2. 考虑下表，其中行和列的索引从 0 开始，且对于 $i, j \geqslant 0$，有 $a _ { i , j } = 2 ^ { i } ( 2 j + 1 )$：

<table><tr><td></td><td>j=0 1</td><td>2</td><td>3</td><td>4</td><td>5</td><td></td></tr><tr><td>i=0</td><td>1</td><td>3</td><td>5</td><td>7</td><td>9 11</td><td></td></tr><tr><td>1</td><td>2</td><td>6 10</td><td></td><td>14 18</td><td>22</td><td></td></tr><tr><td>2</td><td>4</td><td>12 20</td><td></td><td>28</td><td>36 44</td><td></td></tr><tr><td>3</td><td>8 24</td><td>40</td><td>56</td><td>72</td><td>88</td><td></td></tr><tr><td>4</td><td>16 48</td><td>80</td><td>112</td><td>144</td><td>176</td><td></td></tr><tr><td>：</</td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>

每一个数都可以唯一地写成一个2的幂与一个奇数的乘积，所以每一个正整数在上方的表格中都恰好出现一次。
很容易看出，每一行和每一列中的数都是严格递增的。
由于前$x$个正奇数的和是$x ^ { 2 }$，所以第$k$行中前$x_k$个数的和是$2 ^ { k } x _ { k } ^ { 2 }$，也就是出现在$S$中的第$k$项：

因此，该总和可以被解释为：从第 $k$ 行中选取 $x_k$ 个数（其中 $\begin{array} { r } { \sum _ { k = 1 } ^ { n } x _ { k } = n , } \end{array}$），然后计算这 $n$ 个数的和。特别地，$S$ 的最小可能值等于该表格中最小的 $n$ 个数的和，因为该表格的每一行和每一列都是严格递增的。

此外，最小的 $n$ 个数，即 1, 2, ..., $n$，出现在前 $n$ 行，所以 $S$ 的最小值是

$$
1 + 2 + \cdots + n = { \frac { n ( n + 1 ) } { 2 } } .
$$

注：如解法2中的表格所示，该问题的等号成立情况由以下给出：

$$
x _ { i } = \left\lfloor { \frac { n } { 2 ^ { i + 1 } } } + { \frac { 1 } { 2 } } \right\rfloor .
$$

S₀ $x _ { i }$ 是将 $\frac { n } { 2 ^ { i + 1 } }$ 四舍五入到最接近整数的结果。这也给出了该恒等式的证明。

$$
n = \sum _ { i = 0 } ^ { \infty } \left\lfloor { \frac { n } { 2 ^ { i + 1 } } } + { \frac { 1 } { 2 } } \right\rfloor ,
$$

这可以通过对$n$进行归纳来单独证明：当$n$增加1时，右边正好有一项，即对应于$i = \nu _ { 2 } ( n )$的那一项，增加了1，而其余的保持不变。

注释. 如果将 $x _ { i }$ 是非负整数的条件放宽为 $x _ { i }$ 是非负实数，该问题可以通过应用柯西-施瓦茨不等式来解决：

$$
\begin{array} { c } { { ( 2 ^ { 0 } + 2 ^ { - 1 } + \dots + 2 ^ { - n } ) ( 2 ^ { 0 } x _ { 0 } ^ { 2 } + 2 ^ { 1 } x _ { 1 } ^ { 2 } + \dots + 2 ^ { n } x _ { n } ^ { 2 } ) \geqslant ( x _ { 0 } + \dots + x _ { n } ) ^ { 2 } = n ^ { 2 } } } \\ { { { } } } \\ \\ { { \Longrightarrow ~ 2 ^ { 0 } x _ { 0 } ^ { 2 } + 2 ^ { 1 } x _ { 1 } ^ { 2 } + \dots + 2 ^ { n } x _ { n } ^ { 2 } \geqslant \displaystyle \frac { n ^ { 2 } } { 2 - 2 ^ { - n } } . } } \end{array}
$$

该松弛问题的等式成立情形由……给出

$$
x _ { i } = { \frac { 2 ^ { - i } n } { 2 - 2 ^ { - n } } } \approx \left\lfloor { \frac { n } { 2 ^ { i + 1 } } } + { \frac { 1 } { 2 } } \right\rfloor .
$$

事实上，当实数情况下的最优序列中的各项全部被四舍五入到最接近的整数时，我们便得到了原问题的最优序列。虽然思考实数情况可能会为原问题的等号成立情况提供指引，但似乎并不能轻易地延续为一个完整的解。

# A3.

判断是否对于每个正实数序列 ( $u _ { n }$ )，

$$
\frac { 3 ^ { a _ { 1 } } + 3 ^ { a _ { 2 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } < \frac { 1 } { 2 0 2 4 }
$$

对于至少一个正整数 $n$ 成立

注释。该问题可以以几种形式提出，如下：

(i) 可以要求学生， 如上，证明这样一个 $n$ 的存在， (ii) 可以要求学生证明，对于所有足够大的 $n$，这一点都成立， (iii） 可以给学生一个具体的正整数 $N$，并要求证明对于所有 $n > N$，该命题都成立 ：

以下解法为$N$提供了不同的范围

答案：答案是“是”：总是存在这样的一个 $n$ ：

常用说明。记作 ε = 2024

解法 1. 对于每个正整数 $n$ ，令 $M _ { n } = \operatorname* { m a x } ( a _ { 1 } , a _ { 2 } , \ldots , a _ { n } )$ 。我们 frst 证明

$$
\frac { 3 ^ { a _ { 1 } } + 3 ^ { a _ { 2 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } \leqslant \bigg ( \frac { 3 } { 4 } \bigg ) ^ { M _ { n } } .
$$

对于 $i = 1$ ，2，...，$n$ ，由 $\left( { \frac { 3 } { 2 } } \right) ^ { a _ { i } } \leqslant \left( { \frac { 3 } { 2 } } \right) ^ { M _ { n } }$ 我们可以得到 $\begin{array} { r } { 3 ^ { a _ { i } } \leqslant \left( \frac { 3 } { 4 } \right) ^ { M _ { n } } \cdot 2 ^ { M _ { n } } \cdot 2 ^ { a _ { i } } } \end{array}$ . 通过对所有 $i$ 求和，

$$
\sum _ { i = 1 } ^ { n } 3 ^ { a _ { i } } \leqslant \left( \frac { 3 } { 4 } \right) ^ { M _ { n } } \cdot 2 ^ { M _ { n } } \cdot \sum _ { i = 1 } ^ { n } 2 ^ { a _ { i } } \leqslant \left( \frac { 3 } { 4 } \right) ^ { M _ { n } } \cdot \left( \sum _ { i = 1 } ^ { n } 2 ^ { a _ { i } } \right) ^ { 2 } ,
$$

等价于(2)

令 $\mu = \log _ { 4 / 3 } \frac { 1 } { \varepsilon }$，使得 $\mu$ 为满足 $\left( { \frac { 3 } { 4 } } \right) ^ { \mu } = \varepsilon$ 的正实数。如果存在一个下标 $n$ 使得 $a _ { n } > \mu$，那么 $M _ { n } \geqslant a _ { n } > \mu$，因此

$$
{ \frac { 3 ^ { a _ { 1 } } + 3 ^ { a _ { 2 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } } \leqslant \left( { \frac { 3 } { 4 } } \right) ^ { M _ { n } } < \left( { \frac { 3 } { 4 } } \right) ^ { \mu } = \varepsilon .
$$

否则，对于所有正整数 $i$，我们有 $0 < a _ { i } \leqslant \mu$，s0

$$
{ \frac { 3 ^ { a _ { 1 } } + 3 ^ { a _ { 2 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } } \leqslant { \frac { n \cdot 3 ^ { \mu } } { ( n \cdot 1 ) ^ { 2 } } } = { \frac { 3 ^ { \mu } } { n } } .
$$

如果 n > $\left\lfloor \frac{3^{\mu}}{\varepsilon} \right\rfloor$，则该值小于 ε：

注。也可以通过对 $n$ 进行归纳来证明（2）。基础情形 $n = 1$ 显然成立。在归纳步骤中，将 $a _ { 1 }$ ， $a _ { 2 }$ ，…， $a _ { n }$ 按递增顺序排列为 $b _ { 1 } \leqslant b _ { 2 } \leqslant \cdots \leqslant b _ { n }$ 后，例如，只需验证即可

$$
\frac { 3 ^ { b _ { 1 } } + 3 ^ { b _ { 2 } } + \cdot \cdot \cdot + 3 ^ { b _ { n } } } { ( 2 ^ { b _ { 1 } } + 2 ^ { b _ { 2 } } + \cdot \cdot \cdot + 2 ^ { b _ { n } } ) ^ { 2 } } \leqslant \frac { 3 ^ { b _ { 1 } } + 3 ^ { b _ { 2 } } + \cdot \cdot \cdot + 3 ^ { b _ { n } } } { ( 2 ^ { b _ { 1 } } + 2 ^ { b _ { 2 } } + \cdot \cdot \cdot + 2 ^ { b _ { n } } ) ( 2 ^ { b _ { 2 } } + \cdot \cdot \cdot + 2 ^ { b _ { n } } ) } \leqslant \frac { 3 ^ { b _ { 2 } } + \cdot \cdot \cdot + 3 ^ { b _ { n } } } { ( 2 ^ { b _ { 2 } } + \cdot \cdot \cdot + 2 ^ { b _ { n } } ) ^ { 2 } } .
$$

第二个不等式等价于 $3 ^ { b _ { 1 } } \sum _ { i = 2 } ^ { n } 2 ^ { b _ { i } } \leqslant 2 ^ { b _ { 1 } } \sum _ { i = 2 } ^ { n } 3 ^ { b _ { i } }$ ，这可以由 $\left( { \frac { 3 } { 2 } } \right) ^ { b _ { 1 } } \leqslant \left( { \frac { 3 } { 2 } } \right) ^ { b _ { i } }$ 得出

方案二。我们将结合两个上界。

首先，从平凡估计开始

$$
\frac { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } \leqslant \frac { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { 4 ^ { a _ { 1 } } + \cdot \cdot \cdot + 4 ^ { a _ { n } } } .
$$

通过将詹森不等式应用于凸函数 $x ^ { \log _ { 3 } 4 }$ 可得

$$
{ \frac { 4 ^ { a _ { 1 } } + \cdot \cdot \cdot + 4 ^ { a _ { n } } } { n } } = { \frac { \left( 3 ^ { a _ { 1 } } \right) ^ { \log _ { 3 } { 4 } } + \cdot \cdot \cdot + \left( 3 ^ { a _ { n } } \right) ^ { \log _ { 3 } { 4 } } } { n } } \geqslant \left( { \frac { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { n } } \right) ^ { \log _ { 3 } { 4 } } ,
$$

所以

$$
{ \frac { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } } \leqslant { \frac { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { 4 ^ { a _ { 1 } } + \cdot \cdot \cdot + 4 ^ { a _ { n } } } } \leqslant { \bigg ( } { \frac { n } { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } } { \bigg ) } ^ { \log _ { 3 } 4 - 1 } .
$$

因此，(1）每当……时成立

$$
3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } > \left( { \frac { 1 } { \varepsilon } } \right) ^ { \frac { 1 } { \log _ { 3 } 4 - 1 } } \cdot n .
$$

第二，显而易见地

$$
{ \frac { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } } \leqslant { \frac { 3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { n ^ { 2 } } } ,
$$

因此(1)在……条件下成立

$$
3 ^ { a _ { 1 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } < \varepsilon \cdot n ^ { 2 } .
$$

$\begin{array} { r } { n > \left( \frac { 1 } { \varepsilon } \right) ^ { 1 + } \frac { 1 } { \log _ { 3 } 4 - 1 } } \end{array}$ 则 $\left( { \frac { 1 } { \varepsilon } } \right) { \sqrt { \log _ { 3 } 4 - 1 } } \ \cdot n < \varepsilon \cdot n ^ { 2 }$，因此(3)和(4)中至少有一个成立。

解法3. 定义 $C = \log _ { 4 / 3 } \frac { 2 } { \varepsilon }$ ，因此若 $a _ { i } > C$ 则 $3 ^ { a _ { i } } < \frac { \varepsilon } { 2 } \cdot 4 ^ { a _ { i } }$ 。我们根据各项与 $C$ 的比较关系将序列划分为“小项”和“大项”：令

$$
{ \mathcal S } _ { n } = \{ i \leqslant n \mid a _ { i } \leqslant C \} \quad \mathrm { a n d } \quad { \mathcal L } _ { n } = \{ i \leqslant n \mid a _ { i } > C \} .
$$

那么（1）等价于

$$
\frac { \sum _ { i \in S _ { n } } 3 ^ { a _ { i } } } { \left( \sum _ { i \in S _ { n } } 2 ^ { a _ { i } } + \sum _ { i \in \mathcal { L } _ { n } } 2 ^ { a _ { i } } \right) ^ { 2 } } + \frac { \sum _ { i \in \mathcal { L } _ { n } } 3 ^ { a _ { i } } } { \left( \sum _ { i \in S _ { n } } 2 ^ { a _ { i } } + \sum _ { i \in \mathcal { L } _ { n } } 2 ^ { a _ { i } } \right) ^ { 2 } } < \frac { \varepsilon } { 2 } + \frac { \varepsilon } { 2 } .
$$

若 ${ \mathcal { L } } _ { n }$ 非空，则我们有

$$
\frac { \sum _ { i \in \mathcal { L } _ { n } } 3 ^ { a _ { i } } } { \left( \sum _ { i \in \mathcal { S } _ { n } } 2 ^ { a _ { i } } + \sum _ { i \in \mathcal { L } _ { n } } 2 ^ { a _ { i } } \right) ^ { 2 } } < \frac { \varepsilon } { 2 } \cdot \frac { \sum _ { i \in \mathcal { L } _ { n } } 4 ^ { a _ { i } } } { \left( \sum _ { i \in \mathcal { L } _ { n } } 2 ^ { a _ { i } } \right) ^ { 2 } } \leqslant \frac { \varepsilon } { 2 } ,
$$

并且当 ${ \mathcal { L } } _ { n }$ 为空时，这一点也平凡地成立（在这种情况下，左边为零）。

现在假设 $\begin{array} { r } { n \geqslant \frac { 2 } { \varepsilon } \left( \frac { 3 } { 2 } \right) ^ { C } } \end{array}$ 。注意到对于 $i \in S _ { n }$ 有 $\begin{array} { r } { \small \mathrm { 3 } ^ { a _ { i } } \leqslant \left( \frac { 3 } { 2 } \right) ^ { C } 2 ^ { a _ { i } } } \end{array}$ ，因此我们得到

$$
\frac { \sum _ { i \in S _ { n } } 3 ^ { a _ { i } } } { \sum _ { i \in S _ { n } } 2 ^ { a _ { i } } + \sum _ { i \in { \cal C } _ { n } } 2 ^ { a _ { i } } \Big ) ^ { 2 } } \leqslant \frac { \left( \frac { 3 } { 2 } \right) ^ { C } \sum _ { i \in S _ { n } } 2 ^ { a _ { i } } } { \left( \sum _ { i \in S _ { n } } 2 ^ { a _ { i } } + \sum _ { i \in { \cal C } _ { n } } 2 ^ { a _ { i } } \right) ^ { 2 } } \leqslant \frac { \left( \frac { 3 } { 2 } \right) ^ { C } } { \sum _ { i \in S _ { n } } 2 ^ { a _ { i } } + \sum _ { i \in { \cal C } _ { n } } 2 ^ { a _ { i } } } < \frac { \left( \frac { 3 } { 2 } \right) ^ { C } } { n } \leqslant \frac { \left( \frac { 1 } { 2 } \right) ^ { C } } { n } .
$$

所以我们得到(1)。

解法4. 对于每个索引 $i = 1$，2，...，$n$，将加权AM-GM不等式应用于数 $2^{a_i}$ 和 $(n-1)$，权重为 $\log_2 \frac{3}{2} \approx 0.585$ 和 $\log_2 \frac{4}{3} \approx 0.415$，如

$$
\begin{array} { c } { { 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } \geqslant 2 ^ { a _ { i } } + ( n - 1 ) } } \\ { { > \log _ { 2 } \frac 3 2 \cdot 2 ^ { a _ { i } } + \log _ { 2 } \frac 4 3 \cdot ( n - 1 ) \geqslant \bigl ( 2 ^ { a _ { i } } \bigr ) ^ { \log _ { 2 } \frac 3 2 } \cdot ( n - 1 ) ^ { \log _ { 2 } \frac 4 3 } } } \\ { { = \biggl ( \frac 3 2 \biggr ) ^ { a _ { i } } \cdot ( n - 1 ) ^ { \log _ { 2 } \frac 4 3 } > \biggl ( \frac 3 2 \biggr ) ^ { a _ { i } } \cdot ( n - 1 ) ^ { 2 / 5 } . } } \end{array}
$$

对 $i = 1 , 2 , \dots , n$ 求和

$$
( 2 ^ { a _ { 1 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } = \sum _ { i = 1 } ^ { n } 2 ^ { a _ { i } } { \left( 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } \right) } > ( n - 1 ) ^ { 2 / 5 } \sum _ { i = 1 } ^ { n } 3 ^ { a _ { i } }
$$

所以

$$
\frac { 3 ^ { a _ { 1 } } + 3 ^ { a _ { 2 } } + \cdot \cdot \cdot + 3 ^ { a _ { n } } } { ( 2 ^ { a _ { 1 } } + 2 ^ { a _ { 2 } } + \cdot \cdot \cdot + 2 ^ { a _ { n } } ) ^ { 2 } } < \frac { 1 } { ( n - 1 ) ^ { 2 / 5 } } .
$$

如果n≥10，那么(n-1)2/5<ε。

# A4.

设 $\mathbb{Z}_{>0}$ 为所有正整数构成的集合。试确定集合 $\{2^0, 2^1, 2^2, \dots\}$ 的所有子集 $\boldsymbol{S}$，使得存在一个函数 $f \colon \mathbb{Z}_{>0} \to \mathbb{Z}_{>0}$ 满足：

$$
\begin{array} { r } { S = \{ f ( a + b ) - f ( a ) - f ( b ) \mid a , b \in \mathbb { Z } _ { > 0 } \} . } \end{array}
$$

(泰国)

答案：$\boldsymbol { S }$ 可以是任意大小为1或2的子集。

通用备注。对于本题，使用诸如 $\{ a , b , c \}$ 的记号来表示多重集（而非集合）更为方便，子集关系也相应地指多重集的子集关系。两种解法都使用了2的幂的以下性质：如果 $2 ^ { a } + 2 ^ { b } = 2 ^ { c } + 2 ^ { d }$ ，那么 $\{ a , b \}$ 和 $\{ c , d \}$ 是相同的多重集。定义 $e ( a , b ) = \log _ { 2 } ( f ( a + b ) - f ( a ) - f ( b ) ) = e ( b , a )$ 。因此，

$$
f ( a + b ) = 2 ^ { e ( a , b ) } + f ( a ) + f ( b ) .
$$

解法 1. 显然，$\boldsymbol { S }$ 必须是非空的。我们从 $1 \leqslant | S | \leqslant 2$ 的情况开始构造。

·如果 $S = \{ 2 ^ { k } \}$ ，那么对于任意整数 $c > 2 ^ { k }$，取 $f ( x ) = c x - 2 ^ { k }$

· 如果 $S = \{ 2 ^ { k } , 2 ^ { \ell } \}$ 其中 $k > \ell$ ， 则令 $f ( x ) = ( 2 ^ { k } - 2 ^ { \ell } ) \lfloor \alpha x \rfloor - 2 ^ { \ell }$ ，其中 $\alpha > 2$ 不是整数。之所以如此，是因为对于所有 $x$ 和 $y$，$\lfloor \alpha ( x + y ) \rfloor - ( \lfloor \alpha x \rfloor + \lfloor \alpha y \rfloor ) \in \{ 0 , 1 \}$，并且会取到这两个值；$\alpha$ 的下界确保了 $f$ 的值是正数。

观察到，归纳地，

$$
f ( n ) = 2 ^ { e ( 1 , 1 ) } + 2 ^ { e ( 2 , 1 ) } + \cdot \cdot \cdot + 2 ^ { e ( n - 1 , 1 ) } + n f ( 1 ) .
$$

引理1. 对于任意正整数 $n$ 和 $k$ ，

$$
\{ e ( 1 , 1 ) , e ( 2 , 1 ) , \ldots , e ( k - 1 , 1 ) \} \subsetneq \{ e ( n , 1 ) , e ( n + 1 , 1 ) , \ldots , e ( n + k - 1 , 1 ) \} .
$$

证明。我们对$k$进行归纳法证明；当$k = 1$时，第一个多重集为空集，这构成了我们的基础情况。

对于归纳步骤，假设 $k \geqslant 2$ 并且我们知道

$$
\{ e ( 1 , 1 ) , e ( 2 , 1 ) , \ldots , e ( k - 2 , 1 ) \} \subset \{ e ( n , 1 ) , e ( n + 1 , 1 ) , \ldots , e ( n + k - 2 , 1 ) \} .
$$

根据定义，$f ( n + k ) - f ( n ) - f ( k ) = 2 ^ { e ( n , k ) }$，且利用第一个观察可知

$$
- f ( n ) - f ( k ) = \left( 2 ^ { \epsilon ( n , 1 ) } + 2 ^ { \epsilon ( n + 1 , 1 ) } + \cdot \cdot \cdot 2 ^ { \epsilon ( n + k - 1 , 1 ) } \right) - \left( 2 ^ { \epsilon ( 1 , 1 ) } + 2 ^ { \epsilon ( 2 , 1 ) } + \cdot \cdot \cdot + 2 ^ { \epsilon ( k - 1 , 1 ) } \right) - \frac { 1 } { 2 ^ { k - 1 } }
$$

根据归纳假设，我们可以写出

$$
\{ e ( n , 1 ) , e ( n + 1 , 1 ) , \ldots , e ( n + k - 2 , 1 ) \} = \{ e ( 1 , 1 ) , e ( 2 , 1 ) , \ldots , e ( k - 2 , 1 ) \} \cup \{ a \}
$$

存在某个 $a$ 。因此

$$
2 ^ { e ( n , k ) } = 2 ^ { a } + 2 ^ { e ( n + k - 1 , 1 ) } - 2 ^ { e ( k - 1 , 1 ) } \ / .
$$

因此 $\{ e ( n , k ) , e ( k - 1 , 1 ) \} = \{ a , e ( n + k - 1 , 1 ) \}$ . 于是 $e ( k - 1 , 1 ) = a$ 或 $e ( k - 1 , 1 ) = e ( n + k - 1 , 1 )$ ，无论哪种情况我们都得到了我们的结果. □

引理 $\mathcal { Z }$ .序列 $e ( 1 , 1 )$ ， $e ( 2 , 1 )$ ， $e ( 3 , 1 )$ ，... 最多取两个不同的值。

证明. 为导出矛盾，假设 $k \geqslant 2$ 是满足 $e ( k , 1 ) \neq e ( 1 , 1 )$ 的最小下标，并且存在某个 $\ell > k$ 使得 $e ( \ell , 1 ) \not \in \{ e ( k , 1 ) , e ( 1 , 1 ) \}$。根据引理1，序列的任意一个由 $k$ 个连续值组成的块中，至少有 $k - 1$ 个值等于 $e ( 1 , 1 )$。这就迫使

$$
e ( \ell - 1 , 1 ) = e ( \ell - 2 , 1 ) = \dots = e ( \ell - ( k - 1 ) , 1 ) = e ( 1 , 1 )
$$

和

$$
e ( \ell + 1 , 1 ) = e ( \ell + 2 , 1 ) = \cdot \cdot \cdot = e ( \ell + ( k - 1 ) , 1 ) = e ( 1 , 1 ) .
$$

但是，该块 $e ( \ell - 1 , 1 )$ ， $e ( \ell , 1 )$ ， $e ( \ell + 1 , 1 )$ ， $e ( \ell + 2 , 1 )$ ，.， $e ( \ell + ( k - 1 ) , 1 )$ 的长度为 $k + 1$ 且不包含 $e ( k , 1 )$ ，这就产生了矛盾。□

最后，对于任意$a$和$b$有

$$
\begin{array} { c } { { f ( a + b ) - f ( a ) - f ( b ) = \left( 2 ^ { e ( a , 1 ) } + 2 ^ { e ( a + 1 , 1 ) } + \cdot \cdot \cdot 2 ^ { e ( a + b - 1 , 1 ) } \right) - \left( 2 ^ { e ( 1 , 1 ) } + 2 ^ { e ( 2 , 1 ) } + \cdot \cdot \cdot + \cdot 2 ^ { e ( a + b - 1 , 1 ) } \right) } } \\ { { = 2 ^ { e ( i , 1 ) } } } \end{array}
$$

对于某个 $a \leqslant i \leqslant a + b - 1$ 。所以 $| S | \leqslant 2$ ：

注释.在函数的构造中，$\alpha > 2$ 仅在 $k = \ell + 1$ 时才是必要的，以确保 $f(1) \neq 0$。否则，任何大于1的非整数$\alpha$即可。

解法 2. 大小为 $1$ 或 $2$ 的子集可以像在解法 1 中那样实现，并且 $\boldsymbol { S }$ 必须是非空的。我们考虑这样一个集合 $\boldsymbol { S }$，其 $| S | \geqslant 3$，以及一个对应的函数 $f$，以期导出矛盾。我们将把 $e ( a , b )$ 与满足 $c + 1 < a + b$ 的 $e ( c , 1 )$ 的值联系起来，从而得出解法 1 中引理 2 的一个不依赖于该解法中引理 1 的证明。

假设 $a > 1$。我们有 $f ( a + b ) - f ( a ) - f ( b ) = 2 ^ { e ( a , b ) }$，并且 $f ( a ) - f ( a - 1 ) - f ( 1 ) =$ $2 ^ { e ( a - 1 , 1 ) }$，所以

$$
f ( a + b ) - f ( a - 1 ) - f ( 1 ) - f ( b ) = 2 ^ { e ( a , b ) } + 2 ^ { e ( a - 1 , 1 ) } .
$$

类似地，$f ( a + b ) - f ( a - 1 ) - f ( b + 1 ) = 2 ^ { e ( a - 1 , b + 1 ) }$ 并且 $f ( b + 1 ) - f ( 1 ) - f ( b ) = 2 ^ { e ( b , 1 ) }$ ，s0

$$
f ( a + b ) - f ( a - 1 ) - f ( 1 ) - f ( b ) = 2 ^ { e ( a - 1 , b + 1 ) } + 2 ^ { e ( b , 1 ) } .
$$

因此，要么

$$
e ( a , b ) = e ( a - 1 , b + 1 ) \quad { \mathrm { a n d } } \quad e ( a - 1 , 1 ) = e ( b , 1 )
$$

或

$$
e ( a , b ) = e ( b , 1 ) \quad { \mathrm { a n d } } \quad e ( a - 1 , b + 1 ) = e ( a - 1 , 1 ) .
$$

对于 $n \geqslant 4$ ，当 $( a , b )$ 取遍所有满足 $a + b = n$ 的对时，我们考虑这些可能性。如果第一种情况对每一个这样的对都成立（即，对于所有满足 $c + d = n - 1$ 的情况，都有 $e ( c , 1 ) = e ( d , 1 )$ ），那么所有满足 $a + b = n$ 的 $e ( a , b )$ 都相等（并且上述等式并不约束该值是否与任何满足 $c + 1 < n$ 的 $e ( c , 1 )$ 相同）。否则，满足 $a + b = n$ 的 $e ( a , b )$ 的值，完全由那些满足 $e ( c , 1 ) \neq e ( n - 1 - c , 1 )$ 的 $e ( c , 1 )$ 的值所决定，并且它们不全相等。

具体来说，如果 $e ( c , 1 ) = j$ 且 $e ( n { - } 1 { - } c , 1 ) = k$ 且 $j \neq k$ ，我们有 $e ( c , n - c ) = j = e ( n - c , c )$ 并且 $e ( c + 1 , n - c - 1 ) = k = e ( n - c - 1 , c + 1 )$ 。所有其他满足 $a + b = n$ 的 $e ( a , b )$ 的值，然后由以下规则确定：如果 $e ( a - 1 , 1 ) \ = \ e ( b , 1 )$ ，则 $e ( a , b ) \ = \ e ( a - 1 , b + 1 )$ ：:如果我们有 $e ( c , 1 ) \neq e ( n - 1 - c , 1 )$ 且 $e ( c ^ { \prime } , 1 ) \neq e ( n - 1 - c ^ { \prime } , 1 )$ ，但对于所有满足 $c < d < c ^ { \prime }$ 的 $d$，有 $e ( d , 1 ) = e ( n - 1 - d , 1 )$ ，那么如果 $c < c ^ { \prime } - 1$，我们有 $e ( c ^ { \prime } - 1 , n - ( c ^ { \prime } - 1 ) ) = e ( c ^ { \prime } , n - c ^ { \prime } )$ ，那么如果 $c < c ^ { \prime } - 2$，我们有 e(c - 2,n - (c -2)) $\mathbf { \eta } = e ( c ^ { \prime } - 1 , n - ( c ^ { \prime } - 1 ) ) = e ( c ^ { \prime } , n - c ^ { \prime } )$ ，依此类推，直到 $e ( c + 1 , n - c - 1 ) = e ( c ^ { \prime } , n - c ^ { \prime } )$ （如果 $e ( n - c - 1 , 1 ) \not = e ( c ^ { \prime } , 1 )$ 则会产生矛盾：），如果 $c + 1 = c ^ { \prime }$ 且 $e ( n - c - 1 , 1 ) \neq e ( c ^ { \prime } , 1 )$ ，这种矛盾也同样会平凡地出现，.如果 $c$ 是满足 $e ( c , 1 ) \neq e ( n - 1 - c , 1 )$ 的最小整数，那么对于 $a < c$ 的 $e ( a , b )$ 的值，同样被确定为等于 $e ( c , n - c )$ （对于 $a > n - c$ 的情况也同样如此）

换句话说，如果我们按 $a$ 从 1 到 $n - 1$ 的升序列出这些值，
在 $e ( c , 1 ) \neq e ( n - 1 - c , 1 )$ 时确定的相邻值对之间的任何间隙，都会被之前确定的相邻值的副本填满，
并且如果这样一个间隙两侧的值是不同的，我们就会得到一个矛盾
（包括在这些对是相邻或重叠的退化情况下，如果 $c + 1 = c ^ { \prime }$ ）。特别注意，$e ( a , b )$ 的每一个值都是某个满足 $c + 1 \leqslant a + b$ 的 $c$ 所对应的 $e ( c , 1 )$ 的值：

如果 $| S | \geqslant 3$ ，这意味着 $e ( c , 1 )$ 至少取三个不同的值。令 $m$ 满足：$e ( m , 1 )$ 不等于任何 $c < m$ 时的 $e ( c , 1 )$ ，并且对于 $c < m$，$e ( c , 1 )$ 恰好有两个不同的值（因此 $m \geqslant 3$ ）

因为 $e ( m , 1 )$ 不等于任何 $c < m$ 时的 $e ( c , 1 )$，所以我们有所有满足 $a + b = m + 1$ 的 $e ( a , b )$ 都相等，并且对于所有 $c + d = m$，都有 $e ( c , 1 ) = e ( d , 1 )$。我们现在考虑由上述规则确定的、满足 $a + b = m + 2$ 的 $e ( a , b )$ 的值。因为 $e ( m , 1 ) \neq e ( 1 , 1 )$，所以我们有 $e ( 1 , m + 1 ) = e ( 1 , 1 )$ 并且 $e ( 2 , m ) = e ( m , 1 )$。如果存在任何其他的 $e ( d , 1 ) \neq e ( m + 1 - d , 1 )$，考虑其中 $d > 1$ 最小的那个；因为 $e ( m , 1 ) \neq e ( d , 1 )$，我们就会得出一个矛盾。所以，对于所有满足 $c + d = m + 1$ 的 $c$ 和 $d$，$e ( c , 1 ) = e ( d , 1 )$ 都成立，除了 $e ( m , 1 ) \neq e ( 1 , 1 )$ 的情况。但是，这些等式构成了一条路径，连接了所有 $c < m$ 时的 $e ( c , 1 )$。

$$
e ( 1 , 1 ) = e ( m - 1 , 1 ) = e ( 2 , 1 ) = e ( m - 2 , 1 ) = e ( 3 , 1 ) = \cdot \cdot \cdot
$$

这与我们所作的假设相矛盾，即对于$c < m$，$e ( c , 1 )$恰好有两个不同的值：

解法 3. 对于 $1 \leqslant | S | \leqslant 2$ 的构造已在解法 1 中给出，且 $\boldsymbol { S }$ 必须非空。我们假设 $| S | \geqslant 3$ 以导出矛盾。

断言 1. $e ( a , b )$ ， $e ( b , c )$ ,and $e ( a , c )$ 最多可以取两个不同的值。

证明. 通过展开 $f ( a + b + c ) \quad$ 以三种不同的方式，我们得到

$$
2 ^ { e ( a , b ) } + 2 ^ { e ( c , a + b ) } = 2 ^ { e ( b , c ) } + 2 ^ { e ( a , b + c ) } = 2 ^ { e ( a , c ) } + 2 ^ { e ( b , a + c ) } .
$$

该结果源于三个指数多重集的相等性。

对于论断2到4，我们固定$k$，并令$N$为最小的整数，使得对于某个$a \leqslant N$，有$e ( a , N - a + 1 ) = k$：

命题2. 对于任意满足 $b \leqslant N$ 的 $b$，必须满足 $e ( b , N - b + 1 ) = k$

证明. 假设 $e ( a , N - a + 1 ) = k$ 且 $a < b$ . 以两种不同方式展开 $f ( a + ( b - a ) + N - b + 1 )$ ，我们看到

$$
2 ^ { e ( a , b - a ) } + 2 ^ { e ( b , N - b + 1 ) } = 2 ^ { e ( N - b + 1 , b - a ) } + 2 ^ { e ( N - a + 1 , a ) } .
$$

由 $N$ 的极小性， 必有 $e ( b , N - b + 1 ) = e ( N - a + 1 , a )$ 。 $a > b$ 的情况， 通过将 $a$ 和 $b$ 分别替换为 $N - a + 1$ 和 $N - b + 1$ ： □

断言 $\mathcal{J}$：$e(a, 1) = e(N - a + 1, 1)$ 对于任意满足 $1 < a < N$ 的 $a$：

证明. 根据引理2，$e ( a , N { - } a { + } 1 ) = k$ 。然后根据引理1，$e ( a , N { - } a { + } 1 )$ ， $e ( a , 1 )$ 和 $e ( N { - } a { + } 1 , 1 )$ 至多可以取两个不同的值。但是，根据$N$的最小性，我们必须有 $e ( a , N { - } a { + } 1 ) \neq$ $e ( a , 1 ) = e ( N - a + 1 , 1 )$ ： □

断言 4. $e ( a , 1 ) = e ( N - a , 1 )$ 对任意满足 $1 \leqslant a < N$ 的 $a$。

证明. 根据引理2，$e ( a , N - a + 1 ) = e ( a + 1 , N - a ) = k$ . 以两种不同的方式展开 $f ( 1 + a + ( N - a ) )$，我们看到

$$
2 ^ { e ( 1 , a ) } + 2 ^ { e ( a + 1 , N - a ) } = 2 ^ { e ( 1 , N - a ) } + 2 ^ { e ( N - a + 1 , a ) } .
$$

因此 $e ( 1 , a ) = e ( 1 , N - a )$ ，如所要求的。

如果 $| S | \geqslant 3$ ，那么存在 $1 < N _ { k } < N _ { \ell }$ ，其中 $N _ { k }$ 和 $N _ { \ell }$ 是 $k$ 和 $\ell$ 对应的最小值。但断言3和4意味着，对于所有 $1 \leqslant a < N _ { \ell }$，$e ( a , 1 )$ 是常数，这是一个矛盾。

# A5.

求所有的实数周期序列 $a _ { 1 }$ ， $a _ { 2 }$ ，...，使得以下条件对所有 $n \geqslant 1$ 成立：

$$
a _ { n + 2 } + a _ { n } ^ { 2 } = a _ { n } + a _ { n + 1 } ^ { 2 } \qquad { \mathrm { a n d } } \qquad | a _ { n + 1 } - a _ { n } | \leqslant 1 .
$$

答案：满足问题条件的序列是：

$$
\begin{array} { l } { { c , - c , c , - c , \ldots , } } \\ { { d , d , d , d , \ldots , } } \end{array}
$$

其中 $c \in [ - \frac { 1 } { 2 } , \frac { 1 } { 2 } ]$ 且 $d$ 为任意实数。

解决方案1. 我们将第一个条件改写为

$$
a _ { n + 2 } + a _ { n + 1 } = ( a _ { n + 1 } + a _ { n } ) ( a _ { n + 1 } - a _ { n } + 1 ) .
$$

如果存在一个正整数 $m$ 使得 $a _ { m + 1 } + a _ { m } = 0$ ，那么根据方程 (1），对所有正整数 $n \geqslant m$ ，有 $a _ { n + 1 } + a _ { n } = 0$ 。根据数列 $\left( a _ { i + 1 } + a _ { i } \right)$ 的周期性，可得对所有正整数 $i$ ，$a _ { i + 1 } + a _ { i } = 0$ 。因此，数列 $\left( { { a } _ { i } } \right)$ 的形式为 $c , - c , c , - c , \ldots$ ，其中 $| c | \leqslant { \frac { 1 } { 2 } }$ ：

现在假设对于任意正整数 $n$ 都有 $a _ { n + 1 } + a _ { n } \neq 0$。设 $T$ 为该数列的周期。由方程 (1） 可得

$$
1 = \prod _ { i = 1 } ^ { T } { \frac { a _ { i + 2 } + a _ { i + 1 } } { a _ { i + 1 } + a _ { i } } } = \prod _ { i = 1 } ^ { T } ( a _ { i + 1 } - a _ { i } + 1 ) .
$$

结合第二个条件 $| a _ { i + 1 } - a _ { i } | \leqslant 1$ ，我们得到 $a _ { i + 1 } - a _ { i } + 1 > 0$ 。利用算术-几何平均不等式可得

$$
1 = \prod _ { i = 1 } ^ { T } ( a _ { i + 1 } - a _ { i } + 1 ) \leqslant \left( \frac { \sum _ { i = 1 } ^ { T } ( a _ { i + 1 } - a _ { i } + 1 ) } { T } \right) ^ { T } = 1 .
$$

因此等式成立，且我们得到

$$
a _ { 2 } - a _ { 1 } = a _ { 3 } - a _ { 2 } = \cdot \cdot \cdot = a _ { T + 1 } - a _ { T } ,
$$

这意味着 $\left( { { a } _ { i } } \right)$ 是一个常数序列。

因此，所有满足问题条件的序列就是上面列出的那些。

解法二。定义 $s _ { n } = a _ { n + 1 } + a _ { n }$ 和 $d _ { n } = a _ { n + 1 } - a _ { n }$，因此原序列是周期性的当且仅当这两个序列都是周期性的。重新排列给定条件可得 $s _ { n + 1 } =$ $s _ { n } ( 1 + d _ { n } )$ 和 $d _ { n + 1 } = d _ { n } ( s _ { n } - 1 )$，且对于所有 $n$ 有 $\left| d _ { n } \right| \leqslant 1$：

如果对于某个 $n$，有 $s _ { n } = 0$，那么对于所有 $i \geqslant n$，都有 $s _ { i } = 0$，并且为了使该序列是周期的，我们必须有所有的 $s _ { i } = 0$，并且该序列为 $c$，$-c$，$c$，$-c$，...，其中 $| c | \leqslant { \frac { 1 } { 2 } }$。类似地，如果对于某个 $n$，有 $d _ { n } = 0$ 并且该序列是周期的，那么所有的 $d _ { i } = 0$ 并且该序列为 $c$，$c$，$c$，....。

我们断言这些是唯一的周期序列，因此，为导出矛盾，我们假设存在一个周期序列，其中没有任何 $s _ { i }$ 或 $d _ { i }$ 为 $0$。在此假设下，我们将证明 ( $s _ { n }$ ）， $( d _ { n }$ ） 具有以下性质。

1. 所有 $s _ { n }$ 都是正数。由于 $\left| d _ { n } \right| \leqslant 1$ 且 $s _ { n + 1 } = s _ { n } ( 1 { + } d _ { n } ) \neq 0$ ，可得 $d _ { n } > - 1$ 且所有 $s _ { n }$ 具有相同的符号（全为正或全为负）。如果所有 $s _ { n }$ 都是负数，那么 $| d _ { n + 1 } | = | d _ { n } ( s _ { n } - 1 ) | > | d _ { n } |$ ，因此 $| d _ { i } |$ 是一个严格递增的序列，这与周期性相矛盾。 2.每当 $d _ { n } > 0$ 时，我们有 $0 < s _ { n } < 1$ 。反证法，假设对于某个 $n$，有 $d _ { n } > 0$ 且 $s _ { n } \geqslant 1$ 。因为 $d _ { n + 1 } \neq 0$，所以 $s _ { n } > 1$ ，于是 $d _ { n + 1 } > 0$ ， $s _ { n + 1 } > s _ { n } > 1$ ：由归纳法可知，对于所有 $i \geqslant n$，都有 $d _ { i } > 0$ 且 $s _ { i + 1 } > s _ { i }$ ，这与周期性相矛盾。

现在，我们可以如下得到所需的收缩。假设 $( a _ { i } )$ 的周期为 $T$，那么 $\begin{array} { r } { \sum _ { i = 1 } ^ { T } d _ { i } = a _ { T + 1 } - a _ { 1 } = 0 } \end{array}$，因此存在一个 $n$ 使得 $d _ { n } > 0$。根据性质2，我们得到 $0 < s _ { n } < 1$，并且特别地 $s _ { n } < 2$。假设我们有 $s _ { i } < 2$。如果 $d _ { i } < 0$，那么 $s _ { i + 1 } = s _ { i } ( 1 + d _ { i } ) < s _ { i } < 2$；如果 $d _ { i } > 0$，那么根据性质2我们有 $0 < s _ { i } < 1$，然后 $s _ { i + 1 } = s _ { i } ( 1 + d _ { i } ) \leqslant 2 s _ { i } < 2$。在这两种情况下，我们都得到 $s _ { i + 1 } < 2$，然后通过归纳法，我们得到对于所有 $k \geqslant n$，有 $s _ { k } < 2$。但是，我们有 $| d _ { k + 1 } | = | d _ { k } ( s _ { k } - 1 ) | < | d _ { k } |$，这与 $\left( d _ { k } \right)$ 是周期序列的事实相矛盾。

所以唯一的周期序列就是上述列出的两个。

解 3. 注意到如果对于任意 $n$，有 $a _ { n + 1 } = - a _ { n }$，那么 $a _ { n + 2 } = a _ { n } = - a _ { n + 1 }$，从而通过周期性得到第一个答案。另外，如果对于任意 $n$，有 $u _ { n + 1 } = u _ { n }$，那么 $u _ { n + 2 } = u _ { n } = u _ { n + 1 }$，从而通过周期性得到第二个答案。如果对于任意 $n$，有 $u _ { n + 2 } = u _ { n }$，那么 $a _ { n } ^ { 2 } = a _ { n + 1 } ^ { 2 }$，所以 $a _ { n + 1 } = \pm a _ { n }$，并且这两种情况中必有一种适用。此后，在解的其余部分，我们将假设该数列不是这两个答案中的任何一个，并且对于所有 $n$，有 $a _ { n } \neq a _ { n + 1 }$，$- a _ { n + 1 }$，$a _ { n + 2 }$。注意到该递推关系可整理为

$$
a _ { n + 2 } - a _ { n + 1 } = ( a _ { n + 1 } ^ { 2 } - a _ { n + 1 } ) - ( a _ { n } ^ { 2 } - a _ { n } ) = ( a _ { n + 1 } - a _ { n } ) ( a _ { n + 1 } + a _ { n } - 1 ) .
$$

断言 1. 对于所有 $n$，有 $\begin{array} { r } { a _ { n } \leqslant \frac { 1 } { 2 } } \end{array}$：

证明.
首先，我们不能对所有 $n$ 都有 $\begin{array} { r } { a _ { n } > \frac { 1 } { 2 } } \end{array}$。
否则，$a _ { n + 1 } + a _ { n } - 1$ 对所有 $n$ 都是正的，
所以 (2) 式意味着 $a _ { n + 2 } - a _ { n + 1 }$ 与 $a _ { n + 1 } - a _ { n }$ 对所有 $n$ 都有相同的符号。
这意味着该序列是单调的，这与周期性相矛盾。

另一方面，如果 $\textstyle a _ { n + 1 } \leqslant { \frac { 1 } { 2 } }$ 且 $a _ { n + 2 } > \frac { 1 } { 2 }$ ，则

$$
a _ { n + 1 } ^ { 2 } = a _ { n + 2 } + a _ { n } ^ { 2 } - a _ { n } \geqslant a _ { n + 2 } - { \frac { 1 } { 4 } } > { \frac { 1 } { 4 } } \implies | a _ { n + 1 } | > { \frac { 1 } { 2 } } ,
$$

这里我们利用了对于所有 $t \in \mathbb { R }$，$t ^ { 2 } - t \geqslant - \frac 1 4$ 这一事实。由于 $\textstyle a _ { n + 1 } \leqslant { \frac { 1 } { 2 } }$，这意味着 $a _ { n + 1 } < - \frac { 1 } { 2 }$。所以 $| a _ { n + 1 } - a _ { n + 2 } | > 1$，矛盾。□

恒等式(2)现在表明对于所有$n$，$a_{n+2}-a_{n+1}$与$a_{n+1}-a_n$符号相反，因此$a_n < a_{n+1}$当且仅当$a_{n+1} > a_{n+2}$。

断言 $\boldsymbol { \mathcal { Z } }$。$a _ { n } > 0$ 当且仅当 $a _ { n + 1 } \leqslant 0$：即，该序列的符号是交替的。

证明。首先，不可能对于所有的 $n$ 都有 $a _ { n } \ > \ 0$ 。事实上，根据引理1，对于所有的 $n$，我们会有 $| a _ { n + 1 } + a _ { n } - 1 | < 1$ ，根据(2)，这意味着 $\left| a _ { n + 1 } - a _ { n } \right|$ 关于 $n$ 是严格递减的，这与序列的周期性相矛盾。同样，也不可能对于所有的 $n$ 都有 $a _ { n } \leqslant 0$ ，因为那样的话，对于所有的 $n$，我们会有 $| a _ { n + 1 } + a _ { n } - 1 | > 1$（注意到根据非恒定假设，我们永远不会出现 $a _ { n } = a _ { n + 1 } = 0$ 的情况）所以 $\left| a _ { n + 1 } - a _ { n } \right|$ 关于 $n$ 是严格递增的：

因此，如果 $a _ { n }$ 的符号不是交替的，那么根据周期性，存在 $n$ 使得 $a _ { n } > 0$ 且 $a _ { n + 1 } , a _ { n + 2 } \leqslant 0$，或者 $a _ { n } , a _ { n + 1 } > 0$ 且 $a _ { n + 2 } \leqslant 0$。在这两种情况下，我们有

$$
a _ { n } ^ { 2 } - a _ { n } = a _ { n + 1 } ^ { 2 } - a _ { n + 2 } \geqslant a _ { n + 1 } ^ { 2 } \geqslant 0 \implies a _ { n } > 1
$$

由于 $a _ { n }$ 为正数且 $a _ { n + 2 }$ 为非正数。

在前一种情形中，我们有 $a _ { n } - a _ { n + 1 } > 1$ ，矛盾。在后一种情形中，由于 $a _ { n + 1 } > a _ { n + 2 }$ ，我们必须有 $a _ { n } < a _ { n + 1 }$ 。但此时我们有 $a _ { n + 1 } - a _ { n + 2 } > a _ { n } - a _ { n + 2 } > 1$ ，矛盾。□

注意现在我们不能对任何$n$有$a _ { n + 2 } > - a _ { n + 1 } > a _ { n }$，因为这样我们就会

$$
a _ { n + 1 } ^ { 2 } - a _ { n } ^ { 2 } = a _ { n + 2 } - a _ { n } > - a _ { n + 1 } - a _ { n } > 0 \implies a _ { n } - a _ { n + 1 } > 1 ,
$$

一个矛盾。同理，对于任何 $n$，我们不能有 $a _ { n } > - a _ { n + 1 } > a _ { n + 2 }$，因为那样我们将会有

$$
a _ { n } ^ { 2 } - a _ { n + 1 } ^ { 2 } = a _ { n } - a _ { n + 2 } > a _ { n } + a _ { n + 1 } > 0 \implies a _ { n } - a _ { n + 1 } > 1 .
$$

排除了这些情况后，我们可以断言：对于任何 $n$，$\left| a _ { n + 1 } \right|$ 都不在 $\left| a _ { n } \right|$ 和 $\left| a _ { n + 2 } \right|$ 之间：

令 $k$ 为一个指标，使得 $| a _ { k } |$ 是最大的。注意，我们不能有 $| a _ { k - 2 } | = | a _ { k } |$ ，因为根据引理2，那将意味着 $u _ { k - 2 } = u _ { k }$ 。我们也不能有 $| a _ { k - 2 } | \leqslant | a _ { k - 1 } |$ ，因为那将意味着 $| a _ { k - 1 } |$ 介于 $| a _ { k - 2 } |$ 和 $\left| a _ { k } \right|$ 之间。因此，我们必须有 $| a _ { k - 1 } | < | a _ { k - 2 } | < | a _ { k } |$ 。由于 $\left| a _ { k } \right|$ 是最大的，我们不能有 $a _ { k } < 0$ ，那么 $a _ { k } = 0$ 。如果 $a _ { k } > 0$ 且 $a _ { k } - a _ { k + 2 } = a _ { k } ^ { 2 } - a _ { k + 1 } ^ { 2 } > 0$ ，那么我们有 $a _ { k } - a _ { k - 2 } = a _ { k - 1 } ^ { 2 } - a _ { k - 2 } ^ { 2 } < 0$ ，

# A6.

设 $a _ { 0 }$ ， $a _ { 1 }$ ， $a _ { 2 } , \ldots .$ 为一个无限严格递增的正整数序列，使得对于每个 $n \geqslant 1$ 我们有

$$
a _ { n } \in \left\{ { \frac { a _ { n - 1 } + a _ { n + 1 } } { 2 } } , { \sqrt { a _ { n - 1 } \cdot a _ { n + 1 } } } \right\} .
$$

设 $b _ { 1 }$ ， $b _ { 2 }$ ，... 是一个由字母组成的无限序列，定义为

$$
b _ { n } = { \left\{ \begin{array} { l l } { A , } & { { \mathrm { i f ~ } } a _ { n } = { \frac { 1 } { 2 } } ( a _ { n - 1 } + a _ { n + 1 } ) ; } \\ { G , } & { { \mathrm { o t h e r w i s e } } . } \end{array} \right. }
$$

证明存在正整数 $n _ { 0 }$ 和 $d$，使得对于所有 $n \geqslant n _ { 0 }$，我们有 $b _ { n + d } = b _ { n }$：（捷克共和国）

常用备注. 事实上，所有已知的证明都通过表明，序列（ $b _ { n }$ ）的最终周期总是由若干个$G$（可能为零）后跟一个$A$组成：

对于任意周期 $p \geqslant 1$ 的此类序列是存在的。事实上，考虑这个序列

$$
\begin{array} { r } { \ldots , k ^ { p } , k ^ { p - 1 } ( k + 1 ) , \ldots , k ( k + 1 ) ^ { p - 1 } , ( k + 1 ) ^ { p } , ( k + 1 ) ^ { p - 1 } ( k + 2 ) , \ldots . } \end{array}
$$

2009年春季的城市联赛（初级A级试卷，第4题）考虑了满足这个相当自然的准则的序列。然而，它提出了一个关于它们的简单得多的问题：用本题的语言来说，它询问是否每个这样的序列都有 $\left( b _ { n } \right)$ 最终为常数。那个问题的答案是“不”，正如本题的陈述所强烈暗示的那样。因此，至少就命题委员会所知，这是一个关于一个序列族的新颖问题，而这个序列族之前已经被考虑过。

解法 1. 我们将证明序列 ( $b _ { n _ { . } }$ ）的最终周期由任意固定数量的$G$（可能为零）后跟一个$A$组成：

我们考察序列 $\left( a _ { n } \right)$ 的相邻项的比值。设 $C$ 和 $D$ 为互质的正整数，使得 $a _ { 1 } / a _ { 0 } = ( C + D ) / C$ 。如果 $b _ { n } = G$，那么 $a _ { n } / a _ { n - 1 } = a _ { n + 1 } / a _ { n }$ 。如果 $b _ { n } = A$ 且对于某个正整数 $k$，有 $a _ { n } / a _ { n - 1 } = ( C + k D ) / ( C + ( k - 1 ) D )$，那么

$$
{ \frac { a _ { n + 1 } } { a _ { n } } } = { \frac { 2 a _ { n } - a _ { n - 1 } } { a _ { n } } } = { \frac { C + ( k + 1 ) D } { C + k D } } .
$$

因此，根据归纳法，存在一个正整数序列 $\left( k _ { n } \right)$ 对于 $n \geqslant 1$ 满足 $a _ { n } / a _ { n - 1 } = ( C + k _ { n } D ) / ( C + ( k _ { n } - 1 ) D )$ 对所有正整数 $n$ 成立。此外，我们有 $k _ { 1 } = 1$ 且

$$
k _ { n + 1 } = { \left\{ \begin{array} { l l } { k _ { n } , } & { { \mathrm { i f ~ } } b _ { n } = G ; } \\ { k _ { n } + 1 , } & { { \mathrm { i f ~ } } b _ { n } = A . } \end{array} \right. }
$$

如果只有有限个 $n$ 的值使得 $b _ { n } ~ = ~ A$，那么问题陈述显然成立（我们可以选择 $d = 1$ ）。因此，我们可以假设对于无限多个 $n$，有 $b _ { n } = A$。这意味着序列 ( $k _ { n }$ ) 取到所有正整数值。给定一个值 $q \geqslant 1$ ，用 $m _ { q }$ 表示值 $q$ 最后出现的那个索引，即满足 $k _ { m _ { q } } = q$ 且 $k _ { m _ { q } + 1 } = q + 1$ 的那个索引：

我们的目标是证明差分序列 $( m _ { q + 1 } - m _ { q } )$ 最终为常数.我们首先证明它是有上界的.为此，固定 $t \geqslant 1$（我们稍后会选择一个足够大的 $t$），并考虑一个序列 $s ( t ) _ { 0 } , s ( t ) _ { 1 } , . . .$ . 该序列对 $q \geqslant 1$ 由下式定义：$s ( t ) _ { q } = a _ { m _ { q } } / ( C + q D ) ^ { t }$

我们注意到$s ( t ) _ { q }$的两个性质。首先，通过简单的代数运算可得

$$
\begin{array} { l } { \displaystyle { + 1 = \frac { a _ { m _ { q + 1 } } } { ( C + ( q + 1 ) D ) ^ { t } } = \frac { a _ { m _ { q } } } { ( C + ( q + 1 ) D ) ^ { t } } \left( \frac { C + ( q + 1 ) D } { C + q D } \right) ^ { m _ { q + 1 } - m _ { q } } } } \\ { \displaystyle { \qquad = \frac { a _ { m _ { q } } } { ( C + q D ) ^ { t } } \left( \frac { C + ( q + 1 ) D } { C + q D } \right) ^ { m _ { q + 1 } - m _ { q } - t } = s ( t ) _ { q } \left( \frac { C + ( q + 1 ) D } { C + q D } \right) ^ { m _ { q + 1 } - m _ { q } - t } } } \end{array}
$$

由此可见

$$
\begin{array} { r } { s ( t ) _ { q } > s ( t ) _ { q + 1 } } \\ { s ( t ) _ { q } = s ( t ) _ { q + 1 } } \\ { s ( t ) _ { q } < s ( t ) _ { q + 1 } } \end{array} \qquad \mathrm { i f ~ a n d ~ o n l y ~ i f } \qquad \left\{ \begin{array} { l l } { m _ { q + 1 } - m _ { q } < t , } \\ { m _ { q + 1 } - m _ { q } = t , } \\ { m _ { q + 1 } - m _ { q } > t . } \end{array} \right.
$$

其次，假设存在某个正整数$q$使得$m_{q+1} - m_{q} \geqslant t$。我们断言在这种情况下$s(t)_{q}$是一个正整数。事实上，我们有

$$
a _ { m _ { q } + t } = a _ { m _ { q } } \left( \frac { C + ( q + 1 ) D } { C + q D } \right) ^ { t } ,
$$

因为 $k _ { m _ { q } + 1 } = k _ { m _ { q } + 2 } = \cdot \cdot \cdot = k _ { m _ { q } + t } = q + 1$ 。由于 $C + ( q + 1 ) D$ 和 $C + q D$ 互质，我们有

$$
s ( t ) _ { q } = \frac { a _ { m _ { q } } } { ( C + q D ) ^ { t } }
$$

是一个整数

我们选择 $T \geqslant 1$ 使得 $s ( T ) _ { 1 } < 1$ (这样的 $T$ 存在是因为 $C + D > 1$ )。然后，通过归纳法我们可以证明对所有 $q$ 都有 $s ( T ) _ { q } < 1$。事实上，因为 $s ( T ) _ { q } < 1$，它不是一个正整数；这意味着根据上述第二个性质，有 $m _ { q + 1 } - m _ { q } < T$。因此，根据上述第一个性质，我们有 $s ( T ) _ { q + 1 } < s ( T ) _ { q } < 1$，如所需。

这意味着对于所有的 $q$，都有 $m _ { q + 1 } - m _ { q } < T$。因此，存在一个最大的整数 $T ^ { \prime } \leqslant T$，其性质是：等式 $m _ { q + 1 } - m _ { q } = T ^ { \prime }$ 对于无穷多个 $q$ 成立：

因此，对于所有足够大的 $q$ 值，我们都有不等式 $m _ { q + 1 } - m _ { q } \leqslant T ^ { \prime }$，根据第一个性质，这意味着序列 $s ( T ^ { \prime } )$ 从某一点开始是递减的。此外，我们知道该序列取得无限多个整数值，因为存在无限多个 $q$ 值使得等式 $m _ { q + 1 } - m _ { q } = T ^ { \prime }$ 成立。因此，序列 $s ( T ^ { \prime } )$ 从某个足够大的索引 $Q$ 开始是常数。

这反过来意味着，对于所有 $q \geqslant Q$，等式 $m _ { q + 1 } - m _ { q } = T ^ { \prime }$ 都成立。请注意，$b _ { n } = A$ 等价于对于某个整数 $q$，有 $n = m _ { q }$。因此，序列 $\left( b _ { n } \right)$ 在 $n \geqslant Q$ 时是周期的，其周期为 $T ^ { \prime }$，证明完毕。

解法 2. 首先，观察到如果对于所有 $n$ 都有 $b _ { n } = G$，则该命题立即成立；否则，必然存在某个 $n$ 使得 $b _ { n } = A$。不失一般性，我们可以假设 $n = 1$，因为我们可以平移序列而不影响该命题。

我们定义一个等差数列 $\left( p _ { n } \right)$，令 $p _ { 0 } = a _ { 0 } / \operatorname* { g c d } ( a _ { 0 } , a _ { 1 } )$ 且 $p _ { 1 } = a _ { 1 } / \operatorname* { g c d } ( a _ { 0 } , a _ { 1 } )$ ：注意 $p _ { 0 } < p _ { 1}$，因此 $\left( p _ { n } \right)$ 是一个正整数递增序列，并且 $p _ { 2 } = a _ { 2 } / \operatorname* { g c d } ( a _ { 0 } , a _ { 1 } )$ ：

我们还定义了一个正整数序列 $d _ { n } = a _ { n } - a _ { n - 1 }$ 和一个正有理数序列 $q _ { n } = a _ { n } / a _ { n - 1 }$ ：

于是，下列事实是定义的直接推论。

• 如果 $b_n = G$，那么 $q_{n+1} = q_n$ 并且 $d_{n+1} = d_n q_n$ ·如果 $b_n = A$，那么 $d_{n+1} = d_n$：，

· $q _ { 1 } = p _ { 1 } / p _ { 0 }$
·如果 $b _ { n } = A$ 且 $q _ { n } = p _ { i } / p _ { i - 1 }$ ，那么 $q _ { n + 1 } = p _ { i + 1 } / p _ { i }$

现在，令 $k _ { i }$ 为满足 $b _ { n } = G$ 且 $q _ { n } = p _ { i } / p _ { i - 1 }$ 的整数 $n$ 的数量。如果某个 $k _ { i }$ 是无限的，那么 $b _ { n }$ 最终恒为 $G$；否则，所有 $k _ { i }$ 的值都是非负整数。

$d_n$的值序列可以写成

$$
d _ { 0 } , d _ { 0 } { \frac { p _ { 1 } } { p _ { 0 } } } , \ldots , d _ { 0 } \left( { \frac { p _ { 1 } } { p _ { 0 } } } \right) ^ { k _ { 1 } } , d _ { 0 } \left( { \frac { p _ { 1 } } { p _ { 0 } } } \right) ^ { k _ { 1 } } { \frac { p _ { 2 } } { p _ { 1 } } } , \ldots , d _ { 0 } \left( { \frac { p _ { 1 } } { p _ { 0 } } } \right) ^ { k _ { 1 } } \left( { \frac { p _ { 2 } } { p _ { 1 } } } \right) ^ { k _ { 2 } } , \ldots
$$

并且，特别地，这个序列中的所有项都是正整数。此外，对于所有的 $i$，$p _ { i }$ 和 $p _ { i + 1 }$ 都是互质的，因此，下面的序列完全由正整数组成：

$$
\begin{array} { r c l } { { } } & { { } } & { { u _ { 0 } = d _ { 0 } p _ { 0 } ^ { - k _ { 1 } } , } } \\ { { } } & { { } } & { { } } \\ { { } } & { { } } & { { u _ { 1 } = d _ { 0 } p _ { 0 } ^ { - k _ { 1 } } p _ { 1 } ^ { k _ { 1 } - k _ { 2 } } , } } \\ { { } } & { { } } & { { } } \\ { { } } & { { } } & { { u _ { 2 } = d _ { 0 } p _ { 0 } ^ { - k _ { 1 } } p _ { 1 } ^ { k _ { 1 } - k _ { 2 } } p _ { 2 } ^ { k _ { 2 } - k _ { 3 } } , } } \\ { { } } & { { } } & { { } } \\ { { } } & { { } } & { { \vdots ~ . } } \end{array}
$$

我们将证明$k _ { i }$最终为常数，这意味着$b _ { n }$序列最终呈现周期性，其周期由$k$个$G$后接一个$A$构成（其中$k$即为该常数值）。

观察到，$k _ { i }$ 要么是无界的，要么是有界的，并最终达到某个常数 $k$ 的最大值。在第二种情况下，令 $r _ { 0 }$ 是满足 $k _ { r _ { 0 } } = k$ 的最小整数；在第一种情况下，令 $r _ { 0 } = 0$：我们将构造一个无限整数序列如下：

·如果 $k _ { r _ { i } + 1 } \geqslant k _ { r _ { i } }$ ，那么 $r _ { i + 1 } = r _ { i } + 1$
· 如果 $k _ { r _ { i } + 1 } < k _ { r _ { i } }$ ，那么 $r _ { i + 1 }$ 是大于 $r _ { i }$ 的最小正整数，使得 $k _ { r _ { i + 1 } } \geqslant k _ { r _ { i } }$ ：

观察到在第二种情况下，根据我们对$r _ { 0 }$的构造，这样的$r _ { i + 1 }$必然存在：

我们断言 $u _ { r _ { i + 1 } } \leqslant u _ { r _ { i } }$ 当且仅当 $k _ { r _ { i } + 1 } = k _ { r _ { i } }$ 时等号成立（因此 $r _ { i + 1 } = r _ { i } + 1$）。事实上，如果 $k _ { r _ { i } + 1 } \geqslant k _ { r _ { i } }$ 那么

$$
u _ { r _ { i + 1 } } = u _ { r _ { i } + 1 } = u _ { r _ { i } } p _ { r _ { i } } ^ { k _ { r _ { i } } - k _ { r _ { i } + 1 } } \leqslant u _ { r _ { i } } ,
$$

等号成立当且仅当 $k _ { r _ { i } } = k _ { r _ { i } + 1 }$

否则，我们

$$
\frac { u _ { r _ { i + 1 } } } { u _ { r _ { i } } } = p _ { r _ { i } } ^ { k _ { r _ { i } } - k _ { r _ { i } + 1 } } p _ { r _ { i } + 1 } ^ { k _ { r _ { i } + 1 } - k _ { r _ { i } + 2 } } \cdot \cdot \cdot p _ { r _ { i + 1 } - 1 } ^ { k _ { r _ { i + 1 } - 1 } - k _ { r _ { i + 1 } } } ,
$$

因此我们只需证明右侧严格小于1。这是因为

$$
\begin{array} { r l } & { p _ { r _ { i } } ^ { k _ { r _ { i } } - k _ { r _ { i } + 1 } } p _ { r _ { i } + 1 } ^ { k _ { r _ { i } + 1 } - k _ { r _ { i } + 2 } } \cdot \cdot \cdot p _ { r _ { i + 1 } - 1 } ^ { k _ { r _ { i + 1 } - 1 } - k _ { r _ { i + 1 } } } < p _ { r _ { i } } ^ { k _ { r _ { i } } - k _ { r _ { i } + 2 } } p _ { r _ { i } + 2 } ^ { k _ { r _ { i } + 2 } - k _ { r _ { i } + 3 } } \cdot \cdot \cdot p _ { r _ { i + 1 } - 1 } ^ { k _ { r _ { i + 1 } - 1 } - k _ { r _ { i + 1 } } } } \\ & { \phantom { p _ { r _ { i } } ^ { k _ { r _ { i } } - k _ { r _ { i } + 1 } } } < p _ { r _ { i } + 2 } ^ { k _ { r _ { i } } - k _ { r _ { i } + 3 } } p _ { r _ { i } + 3 } ^ { k _ { r _ { i } + 3 } - k _ { r _ { i } + 4 } } \cdot \cdot \cdot p _ { r _ { i + 1 } - 1 } ^ { k _ { r _ { i + 1 } - 1 } - k _ { r _ { i + 1 } } } } \\ & { \phantom { p _ { r _ { i } } ^ { k _ { r _ { i } } - k _ { r _ { i } + 1 } } } \vdots } \\ & { \phantom { p _ { r _ { i } } ^ { k _ { r _ { i } } - k _ { r _ { i + 1 } } } } < p _ { r _ { i + 1 } - 1 } ^ { k _ { r _ { i } } - k _ { r _ { i + 1 } } } } \\ & { \phantom { p _ { r _ { i } + 1 } ^ { k _ { r _ { i } + 1 } - k _ { r _ { i } + 1 } } } \leqslant p _ { r _ { i } + 1 } ^ { k _ { r _ { i } } - k _ { r _ { i } + 1 } } } \end{array}
$$

其中，除最后一个不等式外，其余每个不等式均由 $p _ { j } < p _ { j + 1 }$ 以及对于 $j < r _ { i + 1 }$ 有 $k _ { r _ { i } } ~ > ~ k _ { j }$ 得出，而最后一个不等式则由 $k _ { r _ { i } } \leqslant k _ { r _ { i + 1 } }$ 得出：

最后，序列 ${ { u } _ { { { r } _ { i } } } }$ 是一个由正整数构成的无穷非递增序列，因此它最终必须为常数，从而证明了该命题。

注.上述两种解法在方法上有所不同，但在它们揭示的结构上存在一些重叠。事实上，解法1中的 $C + n D$ 就是解法2中的 $p _ { n }$，而解法1中的 $m _ { r + 1 } - m _ { r }$ 结果等于解法2中的 $k _ { r }$。

# A7.

令 $\mathbb { Q }$ 为有理数的集合。令 $f \colon \mathbb { Q } \to \mathbb { Q }$ 为一函数，满足以下性质：对于所有 $x$ ， $y \in \mathbb { Q }$ ，

$$
f ( x + f ( y ) ) = f ( x ) + y \qquad { \mathrm { o r } } \qquad f ( f ( x ) + y ) = x + f ( y ) .
$$

求集合 $\{ f ( x ) + f ( - x ) \mid x \in \mathbb { Q } \}$ 的最大可能元素个数

(日本)

答案：2是元素的最大数量。

通用说明。假设 $f$ 是一个满足问题条件的函数。   
在所有解法中，我们将使用以下内容。   
· $a \sim b$ 如果 $f ( a ) = b$ 或 $f ( b ) = a$ ，   
· $a \to b$ 如果 $f ( a ) = b$ ，   
· $P ( x , y )$ 表示命题：$f ( x + f ( y ) ) = f ( x ) + y$ 或 $f ( f ( x ) + y ) =$ $x + f ( y )$ ，   
· $g ( x ) = f ( x ) + f ( - x )$

由此，条件 $P ( x , y )$ 可以被重新表述为 $x + f ( y ) \sim f ( x ) + y$，并且我们需要确定集合 $\{ g ( x ) \mid x \in \mathbb { Q } \}$ 的最大可能元素数量：

解法 1. 我们首先提供一个函数 $f$ 的例子，对于这个函数，$g(x)$ 有两个取值。我们取函数 $f ( x ) = \left\lfloor x \right\rfloor - \left\{ x \right\}$ ，其中 $\lfloor x \rfloor$ 表示 $x$ 的向下取整（即小于或等于 $x$ 的最大整数），而 $\{ x \} = x - \lfloor x \rfloor$ 表示 $x$ 的小数部分：

首先，我们证明 $f$ 满足 $P ( x , y )$ 。给定 $x , y \in \mathbb { Q }$ ，我们有

$$
\begin{array} { r l } & { f ( x ) + y = \lfloor x \rfloor - \{ x \} + \lfloor y \rfloor + \{ y \} = ( \lfloor x \rfloor + \lfloor y \rfloor ) + ( \{ y \} - \{ x \} ) ; } \\ & { x + f ( y ) = \lfloor x \rfloor + \{ x \} + \lfloor y \rfloor - \{ y \} = ( \lfloor x \rfloor + \lfloor y \rfloor ) + ( \{ x \} - \{ y \} ) . } \end{array}
$$

如果 $\{ x \} < \{ y \}$ ，那么 $f ( x ) + y$ 的小数部分是 $\{ y \} - \{ x \}$ 且整数部分是 $\lfloor x \rfloor + \lfloor y \rfloor$ ，所以 $f ( x ) + y < x + f ( y )$ 。同理，如果 $\{ x \} > \{ y \}$ ，那么 $x + f ( y ) < f ( x ) + y$ 。最后，如果 $\{ x \} = \{ y \}$ ，那么 $f ( x ) + y = x + f ( y ) = \lfloor x \rfloor + \lfloor y \rfloor$ 是一个整数。在所有情况下，关系 $P$ 都成立。

最后，我们观察到如果 $x$ 是一个整数那么 $g ( x ) = 0$ ，并且如果 $x$ 不是一个整数那么 $g ( x ) = - 2$ ，因此 $g ( x )$ 有两个值，符合要求。

现在，我们证明 $g ( x )$ 的值不可能多于两个： $P ( x , x )$ 告诉我们 $x + f ( x ) \sim x + f ( x )$ ，换句话说，对于所有的 $x$ ，

$$
f ( x + f ( x ) ) = x + f ( x ) .
$$

我们从以下引理开始。

引理 $\mathit { 1 }$ ： $f$ 是一个双射，并且满足

$$
f ( - f ( - x ) ) = x .
$$

证明。我们首先证明 $f$ 是单射的。假设 $f ( x _ { 1 } ) = f ( x _ { 2 } )$ ；那么 $P ( x _ { 1 } , x _ { 2 } )$ 告诉我们 $f ( x _ { 1 } ) + x _ { 2 } \sim f ( x _ { 2 } ) + x _ { 1 }$ 。不失一般性，假设 $f ( x _ { 1 } ) + x _ { 2 }  f ( x _ { 2 } ) + x _ { 1 }$ ：但是 $f ( x _ { 1 } ) ~ = ~ f ( x _ { 2 } )$ ，所以 $f ( f ( x _ { 1 } ) + x _ { 2 } ) = f ( f ( x _ { 2 } ) + x _ { 2 } ) = f ( x _ { 2 } ) + x _ { 2 }$ 根据 (1)。因此，$f ( x _ { 2 } ) + x _ { 1 } = f ( x _ { 2 } ) + x _ { 2 }$ ，如所求。

现在，(1) 式中令 $x = 0$ 告诉我们 $f ( f ( 0 ) ) = f ( 0 )$，因此根据单射性 $f ( 0 ) = 0$ ：

应用 $P ( x , - f ( x ) )$ 告诉我们 $0 \sim x + f ( - f ( x ) )$ ，所以要么 $0 = f ( 0 ) = x + f ( - f ( x ) )$ 或者 $f ( x + f ( - f ( x ) ) ) = 0$，这意味着根据单射性 $x + f ( - f ( x ) ) = 0$。无论如何，我们推断出 $x = - f ( - f ( x ) )$ ，或者 $x = f ( - f ( - x ) )$ 通过将 $x$ 替换为 $-x$ ：

最后，注意到双射性直接由(2)得出。

因为 $f$ 是双射的，所以它有一个逆函数，我们将其记为 $f ^ { - 1 }$ 。重排 (2) 式（在将 $x$ 替换为 $-x$ 之后）得到 $f ( - x ) = - f ^ { - 1 } ( x )$ 。我们有 $g ( x ) = f ( x ) + f ( - x ) = f ( x ) - f ^ { - 1 } ( x )$ ：

假设 $g ( x ) = u$ 且 $g ( y ) = v$ ，其中 $u \ne v$ 且均非零。定义 $x ^ { \prime } = f ^ { - 1 } ( x )$ 和 $y ^ { \prime } = f ^ { - 1 } ( y )$ ；根据定义，我们有

$$
\begin{array} { l l } { { x ^ { \prime }  x  x ^ { \prime } + u } } \\ { { y ^ { \prime }  y  y ^ { \prime } + v . } } \end{array}
$$

代入 $P ( x ^ { \prime } , y )$ 得到 $x + y \sim x ^ { \prime } + y ^ { \prime } + v$ ，而代入 $P ( x , y ^ { \prime } )$ 得到 $x + y \sim x ^ { \prime } + y ^ { \prime } + u$ ：这两者不相等，因为 $u \ne v$ ，并且由于 $f$ 是一个双射，$x + y$ 可能只有一条入射箭头和一条出射箭头，因此我们必须有 $x ^ { \prime } + y ^ { \prime } + u \to x + y \to x ^ { \prime } + y ^ { \prime } + v$ 或者是箭头方向与之相反的相同情况。如果必要，我们可以交换 $( x , u )$ 和 $( y , v )$，从而在不失一般性的情况下假设这就是箭头的正确方向。

此外，根据引理1，我们有 $- x ^ { \prime } - u - x - x ^ { \prime }$。将 $P ( x + y , - x ^ { \prime } - u )$ 代入可得 $y \sim y ^ { \prime } + v - u$ ，因此 $y ^ { \prime } + v - u$ 必须为 $y ^ { \prime } + v$ 或 $y ^ { \prime }$ 。这意味着 $u$ 必须为 $0$ 或 $\boldsymbol { v }$ ，而这与我们关于 $u$ 和 $\boldsymbol { v }$ 的假设相矛盾：

注释.引理1也可以按如下方式证明。我们首先证明 $f$ 必须是满射的。假设不然；那么，必然存在某个 $t$ 不在 $f$ 的输出中出现。$P ( x , t - f ( x ) )$ 告诉我们 $t \sim x + f ( t - f ( x ) )$，因此根据假设，对于所有 $x$，有 $f ( t ) = x + f ( t - f ( x ) )$。但是令 $x = f ( t ) - t$ 可得 $t = f ( t - f ( f ( t ) - t ) )$，这与我们关于 $t$ 的假设相矛盾：

现在，选择某个 $t$ 使得 $f ( t ) = 0$；根据满射性，这样的 $t$ 必定存在。$P ( t , t )$ 告诉我们 $f ( t ) = t$，换句话说，$t = 0$ 且 $f ( 0 ) = 0$。证明的其余部分与解答1中给出的证明相同。

解法 2. 我们再次从引理 1 开始，并注意到 $f ( 0 ) = 0$，正如在该引理的证明中一样。$P ( x , - f ( y ) )$ 给出 $x + f ( - f ( y ) ) \sim f ( x ) - f ( y )$，并利用 (2)，这变为 $x { - } y \sim f ( x ) { - } f ( y )$。换句话说，要么 $f ( x - y ) = f ( x ) - f ( y )$，要么 $x - y = f ( f ( x ) - f ( y ) )$。在后一种情况下，我们推断出

$$
\begin{array} { c } { { f ( - ( x - y ) ) = f ( - f ( f ( x ) - f ( y ) ) ) } } \\ { { f ( y - x ) = f ( - f ( f ( x ) - f ( y ) ) ) } } \\ { { = f ( y ) - f ( x ) . } } \end{array}
$$

因此，$f ( y ) - f ( x )$ 等于 $f ( y - x )$ 或 $- f ( x - y )$ 。将 $y$ 替换为 $x + d$，我们推导出 $f ( x + d ) - f ( x ) \in \{ f ( d ) , - f ( - d ) \}$

现在，我们证明如下命题。

断言. 对于任意 $n \in \mathbb { Z } _ { > 0 }$ 且 $d \in \mathbb { Q }$ ，我们有要么 $g ( d ) = 0$，要么 $g ( d ) = \pm g ( d / n )$

特别地，若 $g ( d / n ) = 0$ 则 $g ( d ) = 0$ ：

证明. 我们首先证明，如果 $g ( d / n ) ~ = ~ 0$，那么 $g ( d ) ~ = ~ 0$。假设 $g ( d / n ) ~ = ~ 0$。那么 $f ( d / n ) = - f ( - d / n )$，因此对于任意的 $x$，有 $f ( x + d / n ) - f ( x ) = f ( d / n )$。反复应用此式，我们推断出对于任意的 $x$，有 $f ( x + d ) - f ( x ) = n f ( d / n )$。将此式应用于 $x = 0$ 和 $x = - d$，并将两式相加得到 $f ( d ) + f ( - d ) = 0$，所以 $g ( d ) = 0$，并且特别地，当 $g ( d ) = 0$ 时，该命题成立：

现在，选取 $n \in \mathbb { Z } _ { > 0 }$ 和 $d \in \mathbb { Q }$ 使得 $g ( d ) \neq 0$，并观察到我们必然有 $g ( d / n ) \neq$ 0。观察到，对于任意 $k \in \mathbb { Z }$，我们有 $f ( k d / n ) - f ( ( k - 1 ) d / n ) \in \{ f ( d / n ) , - f ( - d / n ) \}$，令 $A _ { i }$ 为满足 $i - n < k \leqslant i$ 且使得这个差等于 $f ( d / n )$ 的 $k \in \mathbb { Z }$ 的数量：

我们推得对于任意 $i \in \mathbb Z$ ，

$$
\begin{array} { l } { { f ( i d / n ) - f ( i d / n - d ) = \displaystyle \sum _ { i - n < k \leqslant i } f ( k d / n ) - f ( ( k - 1 ) d / n ) } } \\ { { \displaystyle = A _ { i } f ( d / n ) - ( n - A _ { i } ) f ( - d / n ) } } \\ { { \displaystyle = - n f ( - d / n ) + A _ { i } g ( d / n ) . } } \end{array}
$$

由于 $g ( d / n )$ 非零，这是关于 $A _ { i }$ 的一个非常数线性函数。然而，$f ( i d / n ) - f ( i d / n - d )$ 只有两个可能的值，所以当 $i$ 变化时，$A _ { i }$ 最多只能有两个可能的值。并且由于 $A _ { i + 1 } - A _ { i } \in \{ - 1 , 0 , 1 \}$ ，这两个值必须相差1（如果存在两个值）。

现在，我们有

$$
\begin{array} { r } { f ( d ) - f ( 0 ) = - n f ( - d / n ) + A _ { n } g ( d / n ) , \qquad \mathrm { a n d } } \\ { f ( 0 ) - f ( - d ) = - n f ( - d / n ) + A _ { 0 } g ( d / n ) . \qquad } \end{array}
$$

相减这些（利用 $f ( 0 ) = 0$ 这一事实）我们得到

$$
\begin{array} { c } { { f ( d ) + f ( - d ) = ( A _ { n } - A _ { 0 } ) g ( d / n ) } } \\ { { = \pm g ( d / n ) , } } \end{array}
$$

最后一行根据$g(d)$非零这一事实得出。

由此立即得出，形如 $g ( x )$ 的非零数在至多相差一个正负号的意义上是唯一的；要了解为什么，如果 $g ( d )$ 和 $g ( d ^ { \prime } )$ 都非零，那么存在某些 $n , n ^ { \prime } \in \mathbb { Z } _ { > 0 }$ 使得 $d / n = d ^ { \prime } / n ^ { \prime }$。但是

$$
g ( d ) = \pm g ( d / n ) = \pm g ( d ^ { \prime } ) .
$$

最后，假设对于某些$d , d ^ { \prime }$，存在某个非零$c$使得$g ( d ) = c$且$g ( d ^ { \prime } ) = - c$：因此我们有

$$
\begin{array} { r } { f ( d ) + f ( - d ) - f ( d ^ { \prime } ) - f ( - d ^ { \prime } ) = 2 c } \end{array}
$$

整理后得到 $( f ( d ) - f ( d ^ { \prime } ) ) - ( f ( - d ^ { \prime } ) - f ( - d ) ) = 2 c$

每个括号内的项必须等于 $f ( d - d ^ { \prime } )$ 或 $- f ( d ^ { \prime } - d )$ 。然而，由于 $c$ 非零，它们不能相等，因此 $g ( d - d ^ { \prime } ) = f ( d - d ^ { \prime } ) + f ( d ^ { \prime } - d ) = \pm 2 c$ 。这与对于所有 $x$ 都有 $g ( - x ) = \pm c$ 的断言相矛盾：

解法三. 如解法一，我们首先如上建立引理1，并写出 $f ^ { - 1 } ( x ) =$ $- f ( - x )$ 作为 $f$ 的反函数，并且 $g ( x ) = f ( x ) - f ^ { - 1 } ( x )$

我们现在证明如下。

引理 $\mathcal { Z }$ 若 $g ( x ) \neq g ( y )$ , 则 $g ( x + y ) = \pm ( g ( x ) - g ( y ) )$ （号

证明。假设 $x$ 和 $y$ 满足 $g ( x ) \ \ne \ g ( y )$，应用 $P ( x , f ^ { - 1 } ( y ) )$ 可得 $x + y \sim$ $f ( x ) + f ^ { - 1 } ( y )$ ，并且应用 $P ( f ^ { - 1 } ( x ) , y )$ 可得 $x + y \sim f ^ { - 1 } ( x ) + f ( y )$ ：

注意到

$$
\begin{array} { c l c r } { { ( f ( x ) + f ^ { - 1 } ( y ) ) - ( f ^ { - 1 } ( x ) + f ( y ) ) = ( f ( x ) - f ^ { - 1 } ( x ) ) - ( f ( y ) - f ^ { - 1 } ( y ) ) } } \\ { { } } & { { } } \\ { { } } & { { = g ( x ) - g ( y ) . } } \end{array}
$$

根据假设，$g ( x ) \neq g ( y )$，因此 $f ( x ) + f ^ { - 1 } ( y ) \neq f ^ { - 1 } ( x ) + f ( y )$。由于 $f$ 是双射的，这意味着这两个值必定是 $f ( x + y )$ 和 $f ^ { - 1 } ( x + y )$，顺序不定。因此，$g ( x + y ) = f ( x + y ) - f ^ { - 1 } ( x + y )$ 必定是它们差值的正负形式，也就是 $g ( x ) - g ( y )$ 或 $g ( y ) - g ( x )$： □

命题. 如果 $x$ 和 $q$ 是有理数，使得 $g ( q ) = 0$，且 $n$ 是一个整数，那么 $g ( x + n q ) =$ $g ( x )$ ．

证明。如果 $g ( b ) = 0$ 且 $g ( a ) \neq g ( a + b )$ ，那么引理告诉我们 $g ( b ) = \pm ( g ( a + b ) - g ( a ) )$ ，这与我们的假设相矛盾。因此，每当 $g ( b ) = 0$ 时，都有 $g ( a ) = g ( a + b )$ ：

于是，通过简单的归纳法可得，对于任意正整数 $n$，有 $g ( n b ) = 0$；对于负整数 $n$，也有 $g ( n b ) = 0$，因为 $g ( x ) = g ( - x )$。该命题得证。□

引理3. 在$g$的值域中不能同时存在正元素和负元素。

证明。假设 $g ( x ) > 0$ 且 $g ( y ) < 0$。令 $\boldsymbol { S }$ 为所有形如 $m x + n y$ 的数构成的集合，其中 $m , n$ 为整数。我们首先证明 $g ( S )$ 有无限多个元素。事实上，假设 $g ( S )$ 是有限的，并设 $a \in S$ 使 $g$ 达到最大，$b \in S$ 使 $-g$ 达到最大。那么 $a + b \in S$，并且 $g ( a + b ) = g ( a ) - g ( b )$ 或 $g ( b ) - g ( a )$。在第一种情况下，$g ( a + b ) > g ( a )$；在第二种情况下，$g ( a + b ) < g ( b )$；无论哪种情况，我们都会得到矛盾。

现在，我们证明必定存在某个非零有理数 $q$ 使得 $g ( q ) = 0$ 。事实上，首先假设对于所有 $a$ 都有 $a + f ( a ) = 0$ 。那么对于所有 $a$ 都有 $g ( a ) = f ( a ) + f ( - a ) = 0$ ，因此 $g$ 不取任何非零值。否则，存在某个 $a$ 使得 $a + f ( a ) \neq 0$ ，因此由 (1) 可得 $f ( q ) = 0$，其中 $q = a + f ( a ) \neq 0$ 。注意到根据引理 1 有 $f ( - q ) = 0$，这告诉我们 $g ( q ) = 0$，正如所要求的。

现在，必然存在整数 $s$ 和 $s ^ { \prime }$ 使得 $x s = q s ^ { \prime }$ 和整数 $t$ 和 $t ^ { \prime }$ 使得 $y t = q t ^ { \prime }$ 。上述论断表明，$g ( m x + n y )$ 的值仅取决于 $m$ 模 $s$ 和 $n$ 模 $t$ 的值，所以 $g ( m x + n y )$ 只能取有限多个值。□

最后，假设 $g(x) = u$ 且 $g(y) = v$，其中 $u \ne v$ 且符号相同。假设 $u, v > 0$（另一种情况类似），并且不失一般性地假设 $u > v$。

$P ( f ^ { - 1 } ( x ) , f ^ { - 1 } ( y ) )$ 给出 $x - y \sim f ^ { - 1 } ( x ) - f ^ { - 1 } ( y ) = f ( x ) - f ( y ) - ( u - v )$，并且 $P ( x , y )$ 给出 $x - y \sim f ( x ) - f ( y )$： $u - v$ 是非零的，所以 $f ( x - y )$ 和 $f ^ { - 1 } ( x - y )$ 必须是 $f ( x ) - f ( y ) - ( u - v )$ 和 $f ( x ) - f ( y )$ 以某种顺序，并且由于 $g ( x - y )$ 必须是非负的，我们有

$$
f ( x ) - f ( y ) - ( u - v ) \to x - y \to f ( x ) - f ( y ) .
$$

那么，$P ( x - y , f ^ { - 1 } ( y ) )$ 告诉我们 $( x - y ) + y \sim ( f ( x ) - f ( y ) ) + ( f ( y ) - v )$ ，所以 $x \sim f ( x ) - v$ ，这与要么 $v \neq u$ 要么 $v > 0$ 相矛盾：

注.引理 2 也由 $f ( x + d ) - f ( x ) \in \{ f ( d ) , - f ( - d ) \}$ 得出，正如在解答 2 中所证明的。事实上，我们也有 $f ( - x ) - f ( - x - d ) \in \{ f ( d ) , - f ( - d ) \}$，然后用第一个减去第二个，我们得到 $g ( x + d ) - g ( x ) \in \{ g ( d ) , - g ( d ) , 0 \}$。将 $x + d$ 和 $x$ 替换为 $x$ 和 $-y$ 便得到了引理 2 的结论。

注释。利用引理2可以证明，若$g$的像的大小大于2，则其像必为$\{ 0 , c , 2 c \}$的形式。事实上，若$g ( x ) = c$且$g ( y ) = d$，其中$0 < c < d$，则$g ( x + y ) = d - c$，因为它必须是非负的，并且$g ( y ) = g ( ( x + y ) + ( - x ) ) = | d - 2 c |$，前提是$d \neq 2 c$：

然而，完全基于引理2的结论无法排除 $\{ 0 , c , 2 c \}$；事实上. 由以下函数给出：

$$
\displaystyle g ( x ) = { \left\{ \begin{array} { l l } { 0 , } & { { \mathrm { i f ~ } } x = 2 n { \mathrm { ~ f o r ~ } } n \in \mathbb { Z } ; } \\ { 2 , } & { { \mathrm { i f ~ } } x = 2 n + 1 { \mathrm { ~ f o r ~ } } n \in \mathbb { Z } ; } \\ { 1 , } & { { \mathrm { i f ~ } } x \not \in \mathbb { Z } . } \end{array} \right. }
$$

满足引理2的结论（尽管不存在给出此g选择的函数$f$）

注。解法1实际上意味着该结果在 $\mathbb{R}$ 上也成立。该提案最初是按此处呈现的形式在 $\mathbb{Q}$ 上提交并评审的，并且选题委员会认为这种形式更适合比赛，因为在引理1被证明之后，这种形式允许更多样化和有趣的解法。即使是这里定义在 $\mathbb{Q}$ 上的变式，也被发现是相当具有挑战性的。

# A8.

设 $p \neq q$ 为互质的正整数。确定所有由正整数组成的无限序列 $a _ { 1 }$ ， $a _ { 2 } , \ldots .$，使得对于所有 $n \geqslant 1$，以下条件成立：

$$
\begin{array} { r l } & { \operatorname* { m a x } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + p } ) - \operatorname* { m i n } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + p } ) = p \qquad \mathrm { a n d } } \\ & { \operatorname* { m a x } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + q } ) - \operatorname* { m i n } ( a _ { n } , a _ { n + 1 } , \ldots , a _ { n + q } ) = q . } \end{array}
$$

(日本)

答案：唯一的此类序列是 $a _ { n } = n + C$，其中 $C$ 是一个非负整数。

通用说明。
· 用 $a _ { [ i , j ] }$ 表示子序列 $a _ { i }$ ， $a _ { i + 1 } , \ldots ,$ $a _ { j }$
· 不失一般性，在每个解中我们假设 $p \ < \ q$ 。方便起见，可以单独处理 $p = 1$ 的情况。
· 该问题也可以针对任意整数序列（而非正整数）提出。证明请参见解法1之后的评论。

解法 1. 令 $k = \mid { \frac { q } { p } } \mid$。注意 $k \geqslant 2$：

引理 $\mathit { 1 }$ 如果 $i$，$j$ 和 $m$ 是正整数，使得 $| i - j | \leqslant m p$，那么 $| a _ { i } - a _ { j } | \leqslant m p$： 证明. 根据给定条件，如果 $| i - j | \leqslant p$，那么 $| a _ { i } - a _ { j } | \leqslant p$。因此，该引理可以通过对 $m$ 进行归纳并利用三角不等式得出。 □

引理 $\boldsymbol { \mathcal { Z } }$。对于固定的 $n$，假设 $a_i$ 在 $i \geqslant n$ 上是最小的。则 $i \leqslant n + p - 1$：

证明。为导出矛盾，假设 $i \geqslant n + p$ 。那么 $\operatorname* { m i n } ( a _ { [ i - p , i + q - p ] } ) = a _ { i }$ 。由于 $q - p \leqslant$ $( k - 1 ) p$ ，根据引理1可得 $\operatorname* { m a x } ( a _ { [ i - p , i + q - p ] } ) \leqslant a _ { i } + ( k - 1 ) p < a _ { i } + q$ ，这就产生了矛盾。□

引理 3. 对于一个固定的 $n > q$，假设 $a _ { i }$ 在 $i \leqslant n$ 上是最大的，那么 $i \geqslant n - p + 1$

证明. 假设 $a _ { j }$ 在 $j \geqslant n - q$ 上取最小值. 那么根据引理2，$j \leqslant n - q + p - 1$ 因此 $\operatorname* { m i n } ( a _ { [ n - q , n ] } ) = a _ { j }$ 且 $a _ { i } \geqslant \operatorname* { m a x } ( a _ { [ n - q , n ] } )$ ，这意味着 $a _ { i } \geqslant a _ { j } + q$ ：

引理2也意味着如果 $j \geqslant n$ 那么 $a _ { j } \geqslant \operatorname* { m i n } ( a _ { [ n , n + p ] } )$ 所以如果 $i < j$ ，那么我们有 $a _ { j } \geqslant a _ { i } - p$ ，这与 $a _ { i } \geqslant a _ { j } + q$ 矛盾。因此，我们必须有 $i > j$ ：

上面的不等式也给出 $| a _ { i } - a _ { j } | \geqslant q > ( k - 1 ) p$ ，因此根据引理1可得 $| i - j | > ( k - 1 ) p$ 。因此 $i > j + ( k - 1 ) p \geqslant n - q + ( k - 1 ) p \geqslant n - p + 1$ □

令 $b _ { n }$ 为 $a _ { i }$ 在 $i \geqslant n$ 时的最小值。根据引理2，对所有 $n$，有 $b _ { n + p } > b _ { n }$。因此 $b _ { n } = \operatorname* { m i n } ( a _ { [ n , n + p ] } ) = \operatorname* { m i n } ( a _ { [ n , n + q ] } )$ 令 $c _ { n }$ 为 $a _ { i }$ 在 $i \leqslant n$ 时的最大值。根据引理3，对所有 $n > q$，有 $c _ { n - p } > c _ { n }$。因此，对于 $n > q$，有 $c _ { n } = \operatorname* { m a x } ( a _ { [ n - p , n ] } ) = \operatorname* { m a x } ( a _ { [ n - q , n ] } )$：

所以如果 $n > q$ 那么 $b _ { n } = c _ { n + p } - p = c _ { n + q } - q$ 。所以对于 $n > q$ 我们得到 $b _ { n + q - p } + p = c _ { n + q } = b _ { n } + q$ ，因此 $b _ { n + q - p } = b _ { n } + q - p$ ：

接下来注意到 $b _ { n + p } \leqslant a _ { n + p } \leqslant b _ { n } + p$ 。所以对于所有 $n > q$，有 $b _ { n + p } - b _ { n } \leqslant p$，并且将此迭代 $( q - p )$ 次可得 $b _ { n + p ( q - p ) } - b _ { n } \leqslant p ( q - p )$ 。但利用 $b _ { n + q - p } = b _ { n } + q - p$ 可得 $b _ { n + p ( q - p ) } - b _ { n } = p ( q - p )$ ：由于等号成立，我们必有 $b _ { n + p } = b _ { n } + p$ ：

因此，对于 $n \ > \ q$ ， $b _ { n + p } = b _ { n } + p$ 且 $b _ { n + q - p } = b _ { n } + q - p$ 。由于 $p$ 和 $q - p$ 互质，所以对于所有 $n > q$ ， $b _ { n + 1 } = b _ { n } + 1$ 。 $b _ { n }$ 和 $b _ { n + 1 }$ 不同的唯一可能是 $b _ { n } = a _ { n }$ ，因此我们推断出 $\boldsymbol a _ { n + 1 } = \boldsymbol a _ { n } + 1$ ，并且存在一个常数 $C$ 使得对于所有 $n > q$ 都有 $a _ { n } = n + C$ ：

最后，假设对于所有 $n \geqslant N$，有 $a _ { n } ~ = ~ n + C$。那么 $p \ = \ \operatorname* { m a x } ( a _ { N - 1 } , N + C + p - 1 ) -$ $\operatorname* { m i n } ( a _ { N - 1 } , N + C )$。所以 $a _ { N - 1 } = N + C + p $ 或 $N + C - 1$。类似地，$a _ { N - 1 } = N + C + q$ 或 $N + C - 1$。因此 $a _ { N - 1 } = N + C - 1$。因此，通过归纳法，对于所有正整数 $n$，都有 $a _ { n } = n + C$。由于 $a _ { 1 } \geqslant 1$，$C$ 是一个非负整数。

很容易验证 $a _ { n } = n + C$ 满足给定的条件。

注。这是解法1的一个变体。进行到证明 $b _ { n } - n$ 最终以 $q - p$ 为周期这一步。那么 $b _ { n } - n$ 存在一个最小值。假设 $n$ 取得这个最小值。由于 $b _ { n + p } - n - p \leqslant b _ { n } - n$，所以 $n + p$ 也取得这个最小值。并且由于 $p$ 和 $q - p$ 互质，所有 $n \geqslant q$ 都必须取得这个最小值。因此，对于所有 $n \geqslant q$，都有 $b _ { n + 1 } = b _ { n } + 1$。如上完成证明。

注.也可以使用引理2的一个更弱版本，并且不使用引理3来解决这个问题。例如，下面的引理起到类似的作用。

引理 $\mathcal{Q}$ 令 $b _ { n } ^ { \prime } = \operatorname* { m i n } ( a _ { [ n , n + p ] } )$ 。则 $b _ { n } ^ { \prime } < b _ { n + p } ^ { \prime }$

注释.为解决任意整数序列 $a _ { n }$ 的问题，我们将使用下面的引理。

引理4. 数列$a _ { n }$要么有上界，要么有下界。

证明。
假设 $a _ { n }$ 既无上界也无下界。那么存在某个 $i$ 使得 $a _ { i } < a _ { 1 } - p$。同时也存在某个 $j$ 使得 $a _ { j } > \operatorname* { m a x } ( a _ { [ 1 , i ] } ) + q$ 。
现在令 $a _ { l }$ 为 $a _ { [ 1 , j ] }$ 中的最小值。由于 $a _ { l } \leqslant a _ { i }$ ，所以 $a _ { l } < a _ { 1 } - p$ 且 $a _ { l } < a _ { j } - k p$ 。
根据引理1，$1 + p < l < j - k p$ 。
因此 $\operatorname* { m i n } ( a _ { [ l - p , l + q - p ] } ) = a _ { l }$ 。
再次根据引理1，$\operatorname* { m a x } ( a _ { [ l - p , l + q - p ] } ) \leqslant a _ { l } + ( k - 1 ) p < a _ { l } + q$ ，这就产生了矛盾。□

由此，上述解法可以稍作修改来证明：对于所有 $n$，$a _ { n } = n + C$ 或 $a _ { n } = - n + C$，其中 $C$ 为任意常数整数。

解法 2. 对于 $n, x \geqslant 1$，令 $n$ 的 $x$-宽度为 $\operatorname* { m a x } ( a _ { [ n , n + x ] } ) - \operatorname* { m i n } ( a _ { [ n , n + x ] } )$。我们称一个正整数 $x$ 是好的，如果对于所有足够大的 $n$，$n$ 的 $x$-宽度都小于或等于 $x$，并且我们称 $x$ 是非常好的，如果对于所有足够大的 $n$，$n$ 的 $x$-宽度都等于 $x$：

引理 $\mathit { 1 }$ 如果 $p ^ { \prime }$ 是好的且 $q ^ { \prime }$ 是非常好的，并满足 $p ^ { \prime } < q ^ { \prime } < 2 p ^ { \prime }$，那么 $2 p ^ { \prime } - q ^ { \prime }$ 也是好的。

证明. 注意到 $0 < q ^ { \prime } - p ^ { \prime } < p ^ { \prime } < q ^ { \prime }$ 。设 $n$ 为一个足够大的正整数。那么对于 $k \in \left[ n + q ^ { \prime } - p ^ { \prime } , n + p ^ { \prime } \right]$ ，我们有 $a _ { k } \geqslant \operatorname* { m a x } ( a _ { [ n , n + p ^ { \prime } ] } ) - p ^ { \prime }$ 和 $a _ { k } \geqslant \operatorname* { m a x } \bigl ( a _ { [ n + q ^ { \prime } - p ^ { \prime } , n + q ^ { \prime } ] } \bigr ) - p ^ { \prime }$ ，因为 $p ^ { \prime }$ 是好的，这表明 $a _ { k } \geqslant \operatorname* { m a x } ( a _ { [ n , n + q ^ { \prime } ] } ) - p ^ { \prime }$ 。类似地，我们得到 $a _ { k } \leqslant \operatorname* { m i n } ( a _ { [ n , n + q ^ { \prime } ] } ) + p ^ { \prime }$ ：

因此，对于所有 $k \in \left[ n + q ^ { \prime } - p ^ { \prime } , n + p ^ { \prime } \right]$，我们有 ( $\iota _ { k } \in \lfloor \operatorname* { m a x } ( a _ { [ n , n + q ^ { \prime } ] } ) - p ^ { \prime } , \operatorname* { m i n } ( a _ { [ n , n + q ^ { \prime } ] } ) + p ^ { \prime } \rfloor$ 因此，$n + q ^ { \prime } - p ^ { \prime }$ 的 $( 2 p ^ { \prime } - q ^ { \prime } )$-宽度至多为 $( \operatorname* { m i n } ( a _ { [ n , n + q ^ { \prime } ] } ) + p ^ { \prime } ) - ( \operatorname* { m a x } ( a _ { [ n , n + q ^ { \prime } ] } ) - p ^ { \prime } ) =$ $2 p ^ { \prime } - q ^ { \prime }$ 。引理得证。 □

引理 $\boldsymbol { \mathcal { Z } }$ 令 $p ^ { \prime }$ 为一个“好数”，$q ^ { \prime }$ 为一个“非常好数”，且满足 $p ^ { \prime } < q ^ { \prime }$。对于足够大的 $n$，取 $s , t \in \lfloor n , n + q ^ { \prime } \rfloor$ 使得 $\operatorname* { m i n } ( a _ { [ n , n + q ^ { \prime } ] } ) = a _ { s }$ 且 $\operatorname* { m a x } ( a _ { [ n , n + q ^ { \prime } ] } ) = a _ { t }$。那么 $s \in \left\lfloor n , n + p ^ { \prime } \right\rfloor$ 且 $t \in \lfloor n + q ^ { \prime } - p ^ { \prime } , n + q ^ { \prime } \rfloor$：

证明.
通过类似的论证，解法1中的引理2和引理3在用 $p ^ { \prime }$ 和 $q ^ { \prime }$ 分别替换 $p$ 和 $q$ 后仍然成立.我们可以从解法1的引理2中推导出关于 $s$ 的论断.我们可以从解法1的引理3中推导出关于 $t$ 的论断.□

引理 $\mathcal { J }$ 如果 $p ^ { \prime }$ 是好的，$q ^ { \prime }$ 是很好的，且 $2 p ^ { \prime } < q ^ { \prime }$，那么存在一个正整数 $r$，使得对于所有充分大的 $n$，都有 $a _ { n + r } - a _ { n } \geqslant r$：

证明. 令 $r = q ^ { \prime } - 2 p ^ { \prime }$ ,并令 $s$ 和 $t$ 如引理 2 中所定义. 于是考虑恒等式

$$
\left( a _ { t } - a _ { n + q ^ { \prime } - p ^ { \prime } } \right) + \left( a _ { n + p ^ { \prime } + r } - a _ { n + p ^ { \prime } } \right) + \left( a _ { n + p ^ { \prime } } - a _ { s } \right) = a _ { t } - a _ { s } = q ^ { \prime } .
$$

根据引理2，我们有 $s \in \ \lfloor n , n + p ^ { \prime } \rfloor$ 和 $t \in \lfloor n + q ^ { \prime } - p ^ { \prime } , n + q ^ { \prime } \rfloor$ ，所以 $a _ { n + p ^ { \prime } } - s \leqslant p ^ { \prime }$ 和 $a _ { t } - a _ { n + q ^ { \prime } - p ^ { \prime } } \leqslant p ^ { \prime }$ 。结合这些，我们得到 $a _ { n + p ^ { \prime } + r } - a _ { n + p ^ { \prime } } \geqslant q ^ { \prime } - 2 p ^ { \prime } = r$ 。这证明了对于足够大的 $n$，有 $a _ { n + r } - a _ { n } \geqslant r$ ： □

引理 4. 假设 $( p , q ) \neq ( 1 , 2 )$ 。
那么存在一个好数 $p ^ { \prime }$ 使得 $2 p ^ { \prime } < q$ 。

证明. 令 $p ^ { \prime }$ 为最小的好的正整数。注意到 $p$ 是好的，因此 $p ^ { \prime }$ 存在且小于 $q$

假设，为了引出矛盾，$2 p ^ { \prime } \geqslant q$
如果 $2 p ^ { \prime } > q$ ，那么根据引理1，$2 p ^ { \prime } - q$ 是一个严格小于 $p ^ { \prime }$ 的好数，这与 $p ^ { \prime }$ 的最小性相矛盾。
如果 $2 p ^ { \prime } = q$ ，那么 $p ^ { \prime } < p < 2 p ^ { \prime }$ ：
因此我们可以将引理1应用于 $q _ { 0 } = p$ ，从而得到 $2 p ^ { \prime } - p$ 是一个严格小于 $p ^ { \prime }$ 的好数，这再次与最小性相矛盾。 □

如果 $(p, q) = (1, 2)$，那么该问题便易于求解。否则，结合引理3和引理4，可以得出存在某个 $r > 0$，使得对于所有足够大的 $n$，有 $a _ { n + r } - a _ { n } \geqslant r$。

通过迭代，我们得到对于所有足够大的 $n$，有 $a _ { n + p r } - a _ { n } \geqslant p r$，因此可得 $a _ { n + p } - a _ { n } = p$。类似地，我们得到 $a _ { n + q } - a _ { n } = q$。由于 $p$ 和 $q$ 互质，我们推出对于足够大的 $n$，有 $a _ { n + 1 } - a _ { n } = 1$。因此，我们得到对于足够大的 $n$，有 $a _ { n } = n + C$，并且我们可以通过与解法1相同的论证得出结论。

# 组合数学

# C1.

设 $n$ 为一个正整数。一个有 $n$ 名学生的班级进行 $n$ 场比赛，每场比赛都有排名且没有平局。对于正整数 $a$ 和 $b$，如果一名学生在至少 $a$ 场比赛中都进入了前 $b$ 名，则该学生有资格获得一个评级 $( a , b )$。他们的最终得分是其所有有资格获得的评级中，$a - b$ 的最大值。

求n名学生所有分数的最大可能和。

(澳大利亚)

答案：最大可能的和是 n(n-1)。

解法 1. 答案可以通过学生在每场比赛中以相同的顺序完成比赛来获得。为了证明这是最大值，我们将对比赛结果进行一系列修改，其中每次修改都不会使总分减少，使得在进行 $k$ 次这样的修改后，每场比赛的前 $k$ 个名次都相同。如果一名学生的得分是 $a - b$，这是因为他们在这 $a$ 场比赛中都进入了前 $b$ 名，并且对于该学生而言，$b$ 是满足此性质的最小值，那么我们就称该学生被记为第 $b ^ { \mathrm { t h } }$ 名。

假设在每一场比赛中，前 $k - 1$ 个名次都是相同的，观察获得第 $k$ 名的学生。如果没有这样的学生，则令 $\ell > k$ 为最小的整数，使得某个学生 $S$ 获得了第 $\ell$ 名。那么，在 $S$ 名次介于第 $k$ 名到第 $\ell$ 名（含）之间的每一场比赛中（这样的比赛至少要有 $\ell$ 场，否则 $S$ 将会获得一个 $0$ 分，这个分数高于第 $n$ 名的评分），将第 $k$ 名到第 $\ell$ 名的学生重新排序，使得 $S$ 最终获得第 $k$ 名（并且这些学生的其余排序是任意的）。现在，$S$ 获得了第 $k$ 名，他们的分数增加了 $\ell - k$，并且没有其他学生的分数下降（有些学生的分数可能也上升了）。

现在我们知道，在每场比赛中，前 $k - 1$ 个名次都是相同的，并且至少有一名学生位列第 $k$ 名。选取这样的一名学生 $S$。在 $S$ 排名低于第 $k$ 名的每场比赛中，将 $S$ 与排名第 $k$ 的学生 $T$ 交换位置，而其他所有学生的名次保持不变。每一次这样的交换都会使 $S$ 的分数增加 1，并使 $T$ 的分数最多减少 1，因此这些交换不会降低总分。在此过程结束时，每场比赛的前 $k$ 个名次都相同，且总分并未降低。

重复此过程$n$次得到所需结果。

评论。下面这种用于修改比赛成绩的更简单的方法很诱人：找到学生 $S$ 和 $T$ 的配对，他们分别被记为 $k$ 分和 $\ell$ 分（其中 $k < \ell$），但在某场比赛中，$S$ 的名次却落后于 $T$，然后在那场比赛中交换这两个学生的位置，使得他们的最终名次与他们被评定的名次顺序相同。然而，这样的交换可能会降低总分；例如，假设 $k = 1$ 且 $\ell = 4$，并且在某场比赛中 $S$ 获得第 $6$ 名而 $T$ 获得第 $3$ 名；那么交换这两个学生会减少计入 $T$ 的分数的比赛场次，而不会增加计入 $S$ 的分数的比赛场次。

解法 2. 答案可以通过让所有 $n$ 场比赛的排名都相同来获得。注意，取 $a = b = n$ 表明每个学生的得分都是非负的。考虑一个比赛排名为 $r _ { 1 }$ ， $r _ { 2 }$ ，..， $r _ { n }$ 且最终得分为 $s$ 的学生。我们首先证明

$$
\sum _ { i } r _ { i } \leqslant n ( n - s ) .
$$

不失一般性，假设 $r _ { 1 } \leqslant r _ { 2 } \leqslant \cdots \leqslant r _ { n }$ 。必然存在某个 $k$ 使得 $s + 1 \leqslant k \leqslant n$ 且 $k - r _ { k } = s$ 。为了在保持分数为 $s$ 的同时最大化 $\textstyle \sum _ { i } r _ { i }$ ，我们可以

将 $r _ { 1 }$ 到 $r _ { k - 1 }$ 中的每一个替换为 $r _ { k }$ ，并将 $r _ { k + 1 }$ 到 $r _ { n }$ 中的每一个替换为 $n$ 。那么，总和为

$$
\sum _ { i } r _ { i } \leqslant k r _ { k } + ( n - k ) n = n ^ { 2 } - k ( n - r _ { k } ) = n ^ { 2 } - k ( n + s - k ) \leqslant n ^ { 2 } - s _ { n } .
$$

最后一个不等式由以下事实得出：给定 $s + 1 \leqslant k \leqslant n$ ，表达式 $k ( n + s - k )$ 在 $k = n$ 时取最小值：

所有组别中所有学生的秩和为n²(n+1)。若所有学生分数的总和为t，则（1）式表明

$$
{ \frac { n ^ { 2 } ( n + 1 ) } { 2 } } \leqslant n ^ { 3 } - t n .
$$

这整理得到 t ≤ n(n-1)， ，得证。

解决方案 3. 在每场比赛中，给获得第 $k$ 名的学生分配一个权重 $\textstyle 1 - { \frac { k } { n } }$。如果一个学生在至少 $a$ 场比赛中进入前 $b$ 名，那么他们的权重总和至少为 $\begin{array} { r } { a \left( 1 - \frac { b } { n } \right) = a - b \left( \frac { a } { n } \right) \geqslant a - b } \end{array}$。因此，一个学生在所有比赛中的权重总和至少等于他们的分数，所以所有学生在所有比赛中的所有权重总和至少等于所有学生的所有分数的总和。每场比赛中的权重总和是 $\textstyle { \frac { n - 1 } { 2 } }$，因此所有比赛中的权重总和是 $\frac { n ( n - 1 ) } { 2 }$。等式成立当且仅当，对于每个学生，决定其分数的 $b$ 和 $a$ 的值满足 $a = n$，并且他们在所有 $n$ 场比赛中都恰好获得第 $b$ 名；也就是说，如果学生在每场比赛中的排名都相同。

解决方案4。为每个学生$S$给定一个正整数$b ( S )$，定义$a _ { b } ( S )$为$S$获得前$b ( S )$名的比赛次数，并定义$\mathrm { s c o r e } _ { b } ( S ) = a _ { b } ( S ) - b ( S )$；对于比赛$r$，若$S$在比赛$r$中获得前$b ( S )$名则令$I _ { b } ( S , r )$为$1$，否则为$0$，因此

$$
a _ { b } ( S ) = \sum _ { r } I _ { b } ( S , r ) .
$$

然后题目要求在比赛的所有可能结果中求最大值

$$
\operatorname* { m a x } _ { b } \sum _ { S } \mathrm { s c o r e } _ { b } ( S ) = \operatorname* { m a x } _ { b } \left( \sum _ { r } \sum _ { S } I _ { b } ( S , r ) - \sum _ { S } b ( S ) \right) .
$$

给定 $b$ ，总和 $\Sigma _ { S } ^ { \prime } I _ { b } ( S , r )$ 在比赛 $r$ 中排名的某种选择下取得最大值（不一定是唯一的），并且这个选择对于每一场比赛都是相同的。因此，所有学生分数的可能的最大总和出现在所有比赛中所有学生的排名都相同的情况下，这就得到了给定的答案。

# C2.

令 $n$ 为一个正整数。将整数 1, 2, ..., $n^2$ 写入一个 $n \times n$ 棋盘的格子中，使得每个整数恰好写入一个格子，且每个格子恰好包含一个整数。对于任意满足 $d \mid n$ 的整数 $d$，棋盘的 $d$-划分是指将棋盘划分为 $(n/d)^2$ 个不重叠的 $d \times d$ 子棋盘，使得每个格子恰好包含在一个 $d \times d$ 子棋盘中。

我们称 $n$ 为一个“酷数”，如果可以将整数写在 $n \times n$ 的棋盘上，使得对于每个满足 $d \mid n$ 且 $1 < d < n$ 的整数 $d$，在棋盘的 $d$-划分中，每个 $d \times d$ 子棋盘中所写整数的和都不是 $d$ 的倍数：

请找出所有偶冷数。

(土耳其)

答案：偶酷数是 $n = 2 ^ { k }$，其中 $k$ 是一个正整数。

解.我们首先用归纳法证明 $n = 2 ^ { k }$ 是一个酷数。当 $n = 2$ 时，基本情况是平凡的，因为不存在这样的 $d$：

对于归纳法，假设 $2 ^ { k }$ 是一个酷数。我们构造一个满足条件的 $2 ^ { k + 1 } \times 2 ^ { k + 1 }$ 棋盘的编号。

取一个 $2 ^ { k + 1 } \times 2 ^ { k + 1 }$ 的棋盘，并将其划分为四个 $2 ^ { k } \times 2 ^ { k }$ 的子棋盘。根据假设，对于一个 $2 ^ { k } \times 2 ^ { k }$ 的棋盘，存在一种满足所需条件的编号 $P$；我们在每个子棋盘中都写下编号 $P$。接下来，将第二个子棋盘中的每个数字都加上 $2 ^ { 2 k }$，将第三个子棋盘中的每个数字都加上 $2 \times 2 ^ { 2 k }$，并将第四个子棋盘中的每个数字都加上 $3 \times 2 ^ { 2 k }$。那么，$2 ^ { k + 1 } \times 2 ^ { k + 1 }$ 棋盘上单元格中的数字就是从 1 到 $2 ^ { 2 ( k + 1 ) }$ 的数字：

现在从第一个子板中找到 $2 ^ { 2 k }$，并将其与第二个子板中的 $2 ^ { 2 k } + 2 ^ { k - 1 }$ 交换。从第三个子板中找到 $3 \times 2 ^ { 2 k }$，并将其与第四个子板中的 $3 \times 2 ^ { 2 k } + 2 ^ { k - 1 }$ 交换。

我们声称，这种对 $2 ^ { k + 1 } \times 2 ^ { k + 1 }$ 棋盘的编号满足了所需条件。对于任意 $d = 2 ^ { i }$（其中 $i < k$），考虑任意一个 $2 ^ { i } \times 2 ^ { i }$ 的子棋盘。其单元格的总和模 $2 ^ { i }$ 的值在加法步骤和交换步骤中均不改变，因此，该总和与 $P$ 中对应的 $2 ^ { i } \times 2 ^ { i }$ 子棋盘的总和模 $2 ^ { i }$ 同余，而后者不为零，这满足了要求。

在 $d \ : = \ : 2 ^ { k }$ 的情况下，我们可以直接计算 $b \in \{ 0 , 1 , 2 , 3 \}$ 时第 $( b + 1 ) ^ { \mathrm { t h } }$ 个子棋盘的和。该和由下式给出

$$
2 ^ { 2 k - 1 } ( 1 + 2 ^ { 2 k } ) + b 2 ^ { 4 k } + ( - 1 ) ^ { b } 2 ^ { k - 1 } \equiv 2 ^ { k - 1 } { \pmod { 2 ^ { k } } } .
$$

因此所有子棋盘都满足所需条件，故 $2 ^ { k + 1 }$ 是一个酷数，归纳证毕。

尚需证明没有其他偶数是酷数。令 $n = 2 ^ { s } m$，其中 $s$ 是一个正整数，且 $m$ 是一个大于 1 的奇数。为了引出矛盾，假设存在一种对 $n \times n$ 棋盘的编号方式，满足所需条件。

断言。在棋盘的 $2^i$-划分中，其中 $1 \leqslant i \leqslant s$，每个 $2^i \times 2^i$ 子棋盘中的数的和同余于 $2^{i-1}$ 模 $2^i$：

证明。我们通过对 $i$ 进行归纳来证明该命题。当 $i ~ = ~ 1$ 时，基础情况成立，因为每个 $2 \times 2$ 子棋盘中的数字之和必须是奇数。接下来，假设该命题对于 $2 ^ { i }$ 成立。在 $2 ^ { i + 1 }$ 划分中，每个 $2 ^ { \imath + 1 } \times 2 ^ { \imath + 1 }$ 子棋盘由四个 $2 ^ { \ i } \times 2 ^ { \ i }$ 子棋盘组成，每个子棋盘的和模 $2 ^ { i }$ 同余于 $2 ^ { i - 1 }$。因此，每个 $2 ^ { \imath + 1 } \times 2 ^ { \imath + 1 }$ 子棋盘的和是 $2 ^ { i }$ 的倍数：根据条件，它不可能是 $2 ^ { i + 1 }$ 的倍数，这意味着它模 $2 ^ { i + 1 }$ 必须同余于 $2 ^ { \ i }$。这证明了该命题。□

回到问题，由于 $m$ 是奇数，将 $m ^ { 2 }$ 个 $2 ^ { s } \times 2 ^ { s }$ 子棋盘的和相加得到

$$
2 ^ { s - 1 } m ^ { 2 } \equiv 2 ^ { s - 1 } { \pmod { 2 ^ { s } } } .
$$

然而，从1到$n ^ { 2 }$的数的和是

$$
\frac { n ^ { 2 } ( n ^ { 2 } + 1 ) } { 2 } = 2 ^ { 2 s - 1 } m ^ { 2 } ( 2 ^ { 2 s } m ^ { 2 } + 1 ) \equiv 0 { \pmod { 2 ^ { s } } } .
$$

这是一个矛盾。因此，$n$ 不是一个酷数。

注释。当 $n$ 为奇数时，类似的论证表明素数幂是酷数。如果酷数的定义还要求在 $d$-划分中的所有 $d \times d$ 子棋盘都具有相同的非零模 $d$ 剩余，那么酷数就恰好是素数幂。

# C3.

设 $n$ 为一个正整数。有 $2n$ 位骑士围坐在一张圆桌旁。他们由 $n$ 对伙伴组成，每一对都希望握手。一对伙伴只有在彼此相邻时才能握手。每分钟，有一对相邻的骑士交换位置。

找出相邻骑士交换的最小次数，使得无论初始的排列如何，每个骑士都能在某个时刻与她的搭档相遇并握手。

(白俄罗斯)

答案：最小交换次数是 n(n-1)。

通用说明。该解决方案分为三个引理。我们为每个引理提供多种证明。

解：用一条横跨桌子的弦将每一对骑士连接起来。我们把这些弦称为“链”。

首先我们证明，对于某些排列，需要 $n ( n - 1 ) / 2$ 次交换。

引理 1. 如果每个骑士最初都直接坐在她的搭档对面，那么至少需要 $n ( n { - } 1 ) / 2$ 次交换才能让所有骑士与他们的搭档见面并握手。

证明 1. 在这种排列中，任意两条链最初都是相交的。为了使两个骑士彼此相邻，必须使他们的链不与任何其他链相交，因此，每一对链都必须在某个时刻被解开。每次交换相邻的骑士只能解开一对相交的链，因此，所需的交换次数至少是链的对数，即 $n ( n - 1 ) / 2$ ： □

证明 2. 在这种安排下，每对中的两个骑士最初在桌子周围的任一方向上都被 $n - 1$ 个座位隔开，因此每对骑士总共必须移动至少 $n - 1$ 步以便相邻。共有 $n$ 对，并且每次交换会使两个骑士各移动一步。因此，至少需要 $n ( n - 1 ) / 2$ 次移动。

我们现在来证明，在所有情况下，$n ( n - 1 ) / 2$ 次交换都是充分的。我们将证明一个比所需更强的界限，即在所有交换结束后，每一位骑士都能与她的伙伴握手。

首先，在桌子的中心添加一个柱子。对于每条穿过桌子中心的链，我们任意选择链的一侧，并称柱子位于链的那一侧。虽然柱子可能位于一条链上，但如果移动骑士会导致柱子穿过链的另一侧，我们绝不会移动该骑士。如果一条链穿过某个骑士和柱子之间，我们就说该链经过该骑士的前方，并将一条链的长度定义为其经过前方的骑士的数量。那么，每条链的长度都在0到$n-1$之间（包括0和$n-1$）。

定义链 $C$ 包围另一个链 $C ^ { \prime }$ 的条件是：$C$ 和 $C ^ { \prime }$ 不相交，且 $C$ 从 $C ^ { \prime }$ 和柱子之间穿过。定义两个链为相交的，如果它们在桌面上交叉；为包围的，如果一个链包围另一个链；否则为不相交的。令 $k$，$l$ 和 $m$ 分别表示包围的、相交的和不相交的链对的数量。那么我们有

$$
k + l + m = { \frac { n ( n - 1 ) } { 2 } } .
$$

引理 2. $2 k + l$ 次交换足以达到一个所有骑士对都彼此相邻的局面。

证明 1. 我们对 $2 k + l$ 进行归纳：

如果每个链的长度都是O，那么每一对骑士都是相邻的，并且该命题是平凡的。

否则，设$A$和$B$为一对骑士，其链条$C _ { 0 }$的长度为$q \geqslant 1$。令$S _ { 0 } = A$，并令$S _ { 1 }$，..，$S _ { q }$为$C _ { 0 }$经过其前面的骑士，他们按从$A$到$B$的顺序就座：我们知道$C _ { 0 }$经过$S _ { 1 }$的前面，并且对于骑士$S _ { 1 }$的链条$C _ { 1 }$有三种情况：

如果 $C _ { 1 }$ 经过 $S _ { 0 }$ 的前方，则 $C _ { 0 }$ 和 $C _ { 1 }$ 相交，并且我们可以通过交换 $S _ { 0 }$ 和 $S _ { 1 }$ 的位置来使它们不相交。这会将总和 $2 k + l$ 减少 1。

如果 $C _ { 1 }$ 既不经过 $S _ { 0 }$ 的前方，也不经过 $B$ 的前方，那么 $C _ { 1 }$ 被 $C _ { 0 }$ 包围，并且我们可以交换 $S _ { 0 }$ 和 $S _ { 1 }$，从而使 $C _ { 0 }$ 和 $C _ { 1 }$ 成为一个相交对。这会使 $l$ 增加 $1$，$k$ 减少 $1$，从而将和 $2 k + l$ 减少 $1$。

如果这个$C _ { 1 }$经过B的前方，则我们无法立即找到有利交换。

在第三种情况下，我们转而依次考察骑士 $S _ { i }$ 和 $S _ { i + 1 }$。每次，我们要么会发现一次有利的交换，要么会发现骑士 $S _ { i + 1 }$ 的链 $C _ { i + 1 }$ 从 $B$ 的前方经过。最终，我们要么会在上述前两种情况之一中发现一次有利的交换，要么会发现 $S _ { q }$ 的链 $C _ { q }$ 从 $B$ 的前方经过，在后一种情况下，$C _ { q }$ 和 $C _ { 0 }$ 相交，我们可以通过交换 $S _ { q }$ 和 $B$ 来使 $C _ { q }$ 和 $C _ { 0 }$ 不相交：

另请注意，链条长度增加的唯一情况是当它被另一个链条包围时。但对于包含支柱的链条，这种情况不可能发生，所以没有任何链条会穿过支柱。 □

证明 2. 我们首先忽略座位，并让每位骑士自由地走到一个预定的目的地。每一对骑士将绕着桌子走到其初始位置正中间的圆周上的两个点之一，使得他们之间的链条穿过柱子与目的地之间。如果有多于一组的骑士会有相同的目的地，那么我们就对目的地点进行微调，以便每一对骑士都有一个不同的目的地点。

然后我们设想每个骑士都以恒定的速度行走（每个骑士的速度可能不同）。他们都在同一时间开始和停止行走。我们想要计算两个骑士相遇多少次（要么是朝相反方向，要么是朝同一方向但速度不同）。对于任何一对骑士，相遇的次数取决于他们两条链之间的关系。

当两条链条相交时，将发生一次移动，该移动涉及两位骑士，其另一条链条会从他们之间穿过柱子。

如果他们的两条链条形成包围关系，则将出现两次通过，其中拥有包围链条的骑士会同时通过拥有较短被包围链条的两名骑士。

如果它们的两个链条不相交，那么将不会有任何传递。

因此，交错次数为 $2 k + l$。如果有多对骑士同时交错，我们可以略微调整其行走速度，从而使这些交错发生在不同的时间点。然后，我们可以将这一系列的交错转换为原始问题中的一系列座位交换，这表明 $2 k + l$ 次交换是足够的。□

引理 3. $k \leqslant m$

证明 1. 我们对 $n$ 使用归纳法。基本情况 $n = 2$ 是显然的。

设 $C$ 是一条最长的链，并假设它连接骑士 $A$ 和 $B$ 。令 $x$ 为与 $C$ 相交的链的数量，并令 $y$ 为被 $C$ 包围的链的数量。注意，没有链能够包围 $C$ 。于是，$C$ 会经过其链与 $C$ 相交的每一对骑士中的一个，并经过其链被 $C$ 包围的每一对骑士中的两个。因此，$C$ 的长度为 $x + 2 y \leqslant n - 1$ 。与 $C$ 形成不相交对的链的数量则为

$$
n - 1 - x - y \geqslant ( x + 2 y ) - x - y = y .
$$

现在我们可以移除 $A$ 和 $B$ 并使用归纳假设。我们需要证明每个剩余链的长度至多为 $n - 2$，这样这些链仍然有效。在移除 $A$ 和 $B$ 之后，没有链的长度会增加。如果任何链 $C$ 的长度为 $n - 1$，那么 $A$ 和 $B$ 之间的链其长度也为 $n - 1$。那么 $C$ 必定恰好经过 $A$ 或 $B$ 之一，因此在移除 $A$ 和 $B$ 之后其长度为 $n - 2$： □

证明 $\mathcal { Z }$ 令 $k _ { C }$ 表示链 $C ^ { \prime }$ 的数量，使得 $C$ 包围 $C ^ { \prime }$：

注意：若$C$包围$C ^ { \prime }$，则$k _ { C ^ { \prime } } < k _ { C }$

首先，我们将证明存在至少 $k _ { C }$ 条与 $C$ 不相交的链。令 $x$ 为 $C$ 的长度，令 $\boldsymbol { S }$ 为 $C$ 从其前面经过的 $x$ 个骑士的集合，并令 $\tau$ 为与他们正对而坐的 $x$ 个骑士的集合。$\tau$ 中的任何骑士都不能拥有一个包围 $C$ 或被 $C$ 包围的链，并且如果 $\tau$ 中的任何骑士拥有一个与 $C$ 相交的链，那么她的伙伴必须是 $\boldsymbol { S }$ 中的一个骑士。因此我们有

$$
\begin{array} { r l } & { 2 k _ { C } = \mathrm { n u m b e r ~ o f ~ k n i g h t s ~ i n ~ } \mathcal { S } \mathrm { ~ w h o s e ~ c h a i n ~ i s ~ e n c l o s e d ~ b y ~ } C } \\ & { ~ = x - \mathrm { n u m b e r ~ o f ~ k n i g h t s ~ i n ~ } \mathcal { S } \mathrm { ~ w h o s e ~ c h a i n ~ i n t e r s e c t s ~ } C } \\ & { ~ \leqslant x - \mathrm { n u m b e r ~ o f ~ k n i g h t s ~ i n ~ } \mathcal { T } \mathrm { ~ w h o s e ~ c h a i n ~ i n t e r s e c t s ~ } C } \\ & { ~ \leqslant \mathrm { n u m b e r ~ o f ~ k n i g h t s ~ i n ~ } \mathcal { T } \mathrm { ~ w h o s e ~ c h a i n ~ i s ~ d i s j o i n t ~ f r o m ~ } C } \\ & { ~ \leqslant 2 \times \mathrm { n u m b e r ~ o f ~ c h a i n s ~ t h a t ~ a r e ~ d i s j o i n t ~ f r o m ~ } C . } \end{array}
$$

现在令 $m _ { C }$ 表示与 $C$ 不相交且满足 $k _ { C ^ { \prime } } < k _ { C }$ 的链 $C ^ { \prime }$ 的数量。我们将证明 $m _ { C } \geqslant k _ { C }$。

令 $\mathcal { R }$ 为一个由 $k _ { C }$ 条与 $C$ 不相交的链构成的集合，且满足 $\scriptstyle \sum _ { C ^ { \prime } \in { \mathcal { R } } } k _ { C ^ { \prime } }$ 最小。若 $\mathcal { R }$ 中的每条链 $C ^ { \prime }$ 都满足 $k _ { C ^ { \prime } } < k _ { C }$ ，则证明完毕。否则，我们考虑一条满足 $k _ { C ^ { \prime } } \geqslant k _ { C }$ 的链 $C ^ { \prime }$ 。那么，至少存在 $k _ { C }$ 条链 $C ^ { \prime \prime }$，使得链 $C ^ { \prime }$ 从 $C ^ { \prime \prime }$ 和支柱之间穿过。这些链中的每一条都必须满足 $k _ { C ^ { \prime \prime } } < k _ { C ^ { \prime } }$ ，并且其中至少有一条不在 $\mathcal { R }$ 中（否则 $\mathcal { R }$ 将包含 $C ^ { \prime }$ 以及至少 $k _ { C }$ 条其他链），因此我们可以将这条链与 $C ^ { \prime }$ 交换，从而得到一个集合 $\mathcal { R } ^ { \prime }$ ，该集合满足 $\begin{array} { r } { \sum _ { C ^ { \prime } \in \mathcal { R ^ { \prime } } } k _ { C ^ { \prime } } < \sum _ { C ^ { \prime } \in \mathcal { R } } k _ { C ^ { \prime } } } \end{array}$ 。但这与 $\mathcal { R }$ 的最小性相矛盾：

我们通过对所有链$C$求和来结束

$$
k = \sum _ { C } k _ { C } \leqslant \sum _ { C } m _ { C } \leqslant m .
$$

根据引理3，我们有 $2 k + l \leqslant k + l + m = n ( n - 1 ) / 2$ 。结合引理2，我们有 $n ( n - 1 ) / 2$ 次交换足以达到一种排列，其中每位骑士都坐在她的伴侣旁边，如所愿。

注：引理3的任一证明均可经调整后证明，引理1中的构型是唯一达到该界的构型。

# C4.

在一个有2024行和2023列的棋盘上，蜗牛特博试图从第一行移动到最后一行。在每次尝试中，他选择从第一行的任意一个单元格开始，然后一次移动一步到一个有公共边的相邻单元格。如果他到达最后一行的任意一个单元格，他就赢了。然而，棋盘上有2022个预先设定的隐藏怪物，分别位于2022个单元格中。除了第一行和最后一行，每一行都有一个怪物，并且任意两个怪物都不在同一列。如果特博不幸到达一个有怪物的单元格，他的尝试就结束了，并且他被传送回第一行开始一次新的尝试。怪物不会移动。

假设Turbo被允许尝试$n$次。确定$n$的最小值，使得他存在一个策略，无论怪物的位置如何，该策略都能保证他到达最后一行。

(香港)

注.解决此问题的主要困难之一在于确定 $n$ 的正确表达式。学生们可能会花费很长时间，试图为 $n$ 的错误值证明其界，之后才找到更好的策略。

学生可能会错误地认为，Turbo在单次尝试中不允许回溯到已访问过的方格。幸运的是，做出这种假设并不会改变问题的答案，尽管它可能会略微增加寻找获胜策略的难度。

答案：答案是 $n = 3$

解. 首先，我们证明如果Turbo有2次尝试机会，则不存在必胜策略。

假设 $( 2 , i )$ 是 Turbo 在第一次尝试中到达的第二行的第一个格子。这个格子里可能会有一个怪物，在这种情况下，Turbo 必须立即返回第一行，并且他不可能到达过第一行之外的任何其他格子。

接下来，假设 $( 3 , j )$ 是 Turbo 在第二次尝试中到达的第三行的第一个单元格。Turbo 一定是从 $( 2 , j )$ 移动到这个单元格的，所以我们知道 $j \neq i$ 。因此，有可能在 $( 3 , j )$ 上有一个怪物，在这种情况下，Turbo 的第二次尝试也会失败。因此，Turbo 无法保证在 2 次尝试内到达最后一行。

接下来，我们提出一种$n = 3$的策略。在首次尝试时，Turbo沿路径行进

$$
1 , 1 )  ( 2 , 1 )  ( 2 , 2 )  \cdot \cdot \cdot  ( 2 , 2 0 2 3 ) .
$$

这条路径覆盖第二行的所有格子，因此Turbo会在第2行找到怪物，他的尝试将结束。

如果第二行的怪物不在棋盘边缘（即位于单元格$(2,i)$中，其中$2 \leqslant i \leqslant 2022$），那么Turbo在第二次和第三次尝试中会采取以下两条路径：

$$
\begin{array} { r l } & { ( 1 , i - 1 )  ( 2 , i - 1 )  ( 3 , i - 1 )  ( 3 , i )  ( 4 , i )  \cdots  ( 2 0 2 4 , i ) . } \\ & { ( 1 , i + 1 )  ( 2 , i + 1 )  ( 3 , i + 1 )  ( 3 , i )  ( 4 , i )  \cdots  ( 2 0 2 4 , i ) . } \end{array}
$$

在这两条路径中，唯一可能存在怪物的单元格是 $( 3 , i - 1 )$ 和 $( 3 , i + 1 )$。这两个单元格中至多有一个会存在怪物，因此，这两条路径中至少有一条会成功。

![](images/995317cad8d101d96ada7f25dec20af46f39d8657ebac03c31142362bf4e4863.jpg)  
Figure 1: Turbo's frst attempt,and his second and third attempts in the case where the monster on the second row is not on the edge. The cross indicates the location of a monster, and the shaded cells are cells guaranteed to not contain a monster.

如果第二行的怪兽在棋盘的边缘上，不失一般性，我们可以假设它在 $( 2 , 1 )$ 。然后，在第二次尝试时，Turbo 走以下路径：

$$
( 1 , 2 )  ( 2 , 2 )  ( 2 , 3 )  ( 3 , 3 )  \cdots  ( 2 0 2 2 , 2 0 2 3 )  ( 2 0 2 3 , 2 0 2 3 )  ( 2 0 2 4 , 2 0 2 3 )  ( 6 , 2 , 2 0 2 4 , 2 0 2 3 )
$$

![](images/1717322b70ca1409e25b787d2b7be4d6db9fc73691864eb305f8f41ba951e29a.jpg)  
Figure 2: Turbo's second and third attempts in the case where the monster on the second row is on the edge. The light gray cels on the right diagram indicate cels that were visited on the previous attempt. Note that not all safe cells have been shaded.

如果这条路上没有怪物，那么 Turbo 就赢了。否则，令 $( i , j )$ 为 Turbo 遇到怪物的第一个格子。我们有 $j = i$ 或 $j = i + 1$。然后，在第三次尝试时，Turbo 走下面的路径：

$$
\begin{array} { r l } & { ( 1 , 2 ) \to ( 2 , 2 ) \to ( 2 , 3 ) \to ( 3 , 3 ) \to \cdots \to ( i - 2 , i - 1 ) \to ( i - 1 , i - 1 ) } \\ & { \qquad \to ( i , i - 1 ) \to ( i , i - 2 ) \to \cdots \to ( i , 2 ) \to ( i , 1 ) } \\ & { \qquad \to ( i + 1 , 1 ) \to \cdots \to ( 2 0 2 3 , 1 ) \to ( 2 0 2 4 , 1 ) . } \end{array}
$$

现在注意。

· 从单元格 $(1, 2)$ 到 $(i-1, i-1)$ 的单元格不包含怪物，因为在之前的尝试中，它们比 $(i, j)$ 更早被到达。
· 对于 $1 \leqslant k \leqslant i - 1$，单元格 $(i, k)$ 不包含怪物，因为在第 $i$ 行只有一个怪物，并且它位于 $(i, i)$ 或 $(i, i+1)$。
· 对于 $i \leqslant k \leqslant 2024$，单元格 $(k, 1)$ 不包含怪物，因为在第 1 列至多有一个怪物，并且它位于 $(2, 1)$：

因此Turbo将在第三次尝试时获胜。

注释。当第二行的怪物位于边缘时，可以对Turbo的策略进行小变化。在第二次尝试时，Turbo可以改为走这条路

$$
{ \begin{array} { r l } & { ( 1 , 2 0 2 3 )  ( 2 , 2 0 2 3 )  ( 2 , 2 0 2 2 )  \dots  ( 2 , 3 )  ( 2 , 2 )  ( 2 , 3 )  \dots  ( 2 , 2 0 2 3 ) } \\ & {  ( 3 , 2 0 2 3 )  ( 3 , 2 0 2 2 )  \dots  ( 3 , 4 )  ( 3 , 3 )  ( 3 , 4 )  \dots  ( 3 , 2 0 2 3 ) } \\ & {  \dots } \\ & {  ( 2 0 2 2 , 2 0 2 3 )  ( 2 0 2 2 , 2 0 2 2 )  ( 2 0 2 2 , 2 0 2 3 ) } \\ & {  ( 2 0 2 3 , 2 0 2 3 ) } \\ & {  ( 2 0 2 4 , 2 0 2 3 ) . } \end{array} }
$$

如果这条路径上存在怪物，比如在单元格 $( i , j )$ 处，那么在第三次尝试时，Turbo 可以直接向下移动到怪物正左方的单元格，而不是沿着第二次尝试的轨迹行进。

$$
\begin{array} { r l } & { ( 1 , j - 1 )  ( 2 , j - 1 )  \cdots  ( i - 1 , j - 1 )  ( i , j - 1 ) } \\ & { ~  ( i , j - 2 )  \cdots  ( i , 2 )  ( i , 1 ) } \\ & { ~  ( i + 1 , 1 )  \cdots  ( 2 0 2 3 , 1 )  ( 2 0 2 4 , 1 ) . } \end{array}
$$

![](images/38ddbb5b34294f1cb1c6664eb14f98e20dbcaf861db137246545021f7b7490eb.jpg)  
Figure 3: Alternative strategy for Turbo's second and third attempts.

# C5.

设 $N$ 为一个正整数。在黑板上写下数字 1, 2, ..., $N$。然后他们轮流进行操作，由 Geoff 先开始。每一步操作包括选择一对整数 $( k , n )$，其中 $k \geqslant 0$ 且 $n$ 是黑板上的一个整数，然后擦除黑板上所有满足 $2 ^ { k } \mid n - s$ 的整数 $s$。游戏持续进行，直到黑板变空。擦除黑板上最后一个整数的玩家输掉游戏。

确定所有$N$的值，使得无论Ceri如何行动，Geoff都能确保自己获胜。

(印度尼西亚)

答案：答案是当 $N$ 的形式为 $2 ^ { n }$（$n$ 为奇数）或形式为 $t 2 ^ { n }$（$n$ 为偶数且 $t > 1$ 为奇数）时，Geoff 获胜。

通用说明。我们称一个集合 $\boldsymbol { S }$ 是赢的，如果当前玩家在棋盘上的当前整数集合为 $\boldsymbol { S }$ 时获胜。否则，我们称 $\boldsymbol { S }$ 是输的。

我们将用 $\lfloor n \rfloor$ 表示集合 $\{ 1 , 2 , \ldots , n \}$ ：

解决方案.
引理 $\mathit { 1 }$ .对于任意集合 $\boldsymbol { S }$ ， $\boldsymbol { S }$ 获胜当且仅当 $J ( S , \emptyset )$ 获胜.类似地， $\boldsymbol { S }$ 获胜当且仅当 $J ( \emptyset , S )$ 获胜.
证明. 令 $( k , m )$ 为 $\boldsymbol { S }$ 上的一个移动，并令 $\tau$ 为执行该移动后的结果.那么我们可以通过应用移动 $\left( k + 1 , 2 m - 1 \right)$ 将 $J ( S , \emptyset )$ 化简为 $J ( T , \emptyset )$

反过来，令 $( k , m )$ 是 $J ( S , \emptyset )$ 上的一个移动。我们可以将此移动的结果表示为 $J ( \tau , \emptyset )$，其中 $\tau$ 是某个集合。那么我们可以通过应用移动 $( \operatorname* { m a x } ( k - 1 , 0 ) , ( k + 1 ) / 2 )$ 将 $\boldsymbol { S }$ 归约为 $\tau$。这就在以 $\boldsymbol { S }$ 开局的游戏和以 $J ( S , \emptyset )$ 开局的游戏之间建立了一个自然双射，从而证明了该引理的第一部分。第二部分可通过类似的论证得出。□

引理 $\mathcal { Z }$ 如果 $\boldsymbol { S }$ 和 $\tau$ 是非空的，且它们中至少有一个输，那么 $J ( S , { \mathcal { T } } )$ 获胜。

证明. 如果 $\boldsymbol { S }$ 是必输的，那么我们可以通过走法 $( 1 , t )$ 来删除 $J ( \emptyset , \tau )$，其中 $t \in J ( \mathcal { O } , \mathcal { T } )$，从而留下必输集 $J ( S , \emptyset )$ . 类似地，如果 $\tau$ 是必输的，那么我们可以通过走法 $( 1 , s )$ 来删除 $J ( S , \emptyset )$，其中 $s \in J ( S , \emptyset )$，留下必输集 $J ( \emptyset , \tau )$ □

引理 3. 如果 $\boldsymbol { S }$ 非空且获胜，则 $J ( S , S )$ 失败。

证明. 从这个局面出发，通过将 $( k , 2 n - 1 )$ 替换为 $( k , 2 n )$ 或反之，我们可以将任何走法序列转换为另一个有效的走法序列。因此，我们可以假设初始走法 $( k , m )$ 中的 $m$ 是奇数。我们想要证明，任何这样的走法都会使另一方玩家处于获胜的局面。

走法 $( 0 , m )$ 会立即输掉。否则，该走法的结果是集合 $J ( \mathcal { T } , S )$，其中 $\tau$ 是某个集合。有三种情况。

如果 $\tau$ 为空，则另一位玩家获得获胜集 $J ( \emptyset , S )$

如果 $\tau$ 是必输的，那么对手可以选择走法 $( 1 , s )$，其中 $s \in J ( \mathcal { O } , S )$，这会留下必输集合 $J ( T , \emptyset )$：

如果 $\tau$ 是非空获胜集，则对手可以选择走法 $( k , m + 1 )$，从而得到局面 $J ( { \mathcal { T } } , { \mathcal { T } } )$。然后我们可以对 $| { \cal S } |$ 使用归纳法来证明这是一个输集。□

引理 4. $\lfloor 2 n \rfloor$ 胜当且仅当 $\lfloor n \rfloor$ 负。

证明. 注意到 $\lfloor 2 n \rfloor = J ( \lfloor n \rfloor , \lfloor n \rfloor )$ 。于是，该结果直接由前两个引理得出。 □

引理 5. 对于任意整数 $n \geqslant 1$ ， $\lfloor 2 n + 1 \rfloor$ 获胜。

证明. 根据引理4，$\lfloor n \rfloor$ 或 $\lfloor 2 n \rfloor$ 会输。如果 $\lfloor n \rfloor$ 输，那么根据引理2，$[ 2 n + 1 ] = J ( [ n + 1 ] , [ n ] )$ 会赢。否则，$\lfloor 2 n \rfloor$ 输，因此 $\lfloor 2 n + 1 \rfloor$ 可以通过选择走法 $( k , 2 n + 1 )$ 来赢，其中 $k$ 足够大，使得只有 $2 n + 1$ 被消除。□ 剩下要验证原始答案。我们有两种情况需要考虑：

· 假设 $N = 2 ^ { n }$ 对于某个 $n$。当 $N = 1$ 时，Geoff 的每一步操作都是立即失败的。然后根据引理 4，Geoff 在 $N = 2 ^ { n }$ 时获胜当且仅当他在 $N = 2 ^ { n - 1 }$ 时失败，因此通过归纳法，我们得出 Geoff 在 $N = 2 ^ { n }$ 时获胜当且仅当 $n$ 是奇数。
· 否则，$N = t 2 ^ { n }$，其中 $n$ 为某个数，$t > 1$ 且 $t$ 为奇数。根据引理 5，当 $n = 0$ 时，Geoff 获胜。然后根据引理 4，Geoff 在 $N = t 2 ^ { n }$ 时获胜当且仅当他在 $N = t 2 ^ { n - 1 }$ 时失败，因此通过对 $n$ 的归纳法，我们得出 Geoff 在 $N = t 2 ^ { n }$ 时获胜当且仅当 $n$ 是偶数。

注. 我们可以将此游戏表示为部分二叉树上的游戏。这种表示法在初步演算中可能很常见，因为它有助于对小规模情况的探究。如果两个集合所生成的树是拓扑等价的，那么这种等价性便在以这两个集合为起点的游戏之间建立了一个自然的双射关系。在为小的 $N$ 值探索该游戏时，这类等价性会显著减少需要考虑的不同情况的数量：

构造如下。首先，我们从一个无限二叉树开始考虑。对于每个正整数 $n$，我们考虑 $n - 1$ 的二进制表示，从最低有效位开始，并以无限的前导零序列结束。我们将这个比特序列映射到二叉树上的一条路径，从根节点开始，然后如果比特是 $0$ 则重复选择左子节点，如果比特是 $1$ 则选择右子节点。然后，在达到足够深度以将该路径与树中的所有其他路径区分开来之后，我们可以截断每条路径。

![](images/28a8d3d0e6023aeaf16e8897cd17cf970d1d611e73f28edc1b898f92f0df3e93.jpg)

在此游戏表示中，有效的走法包括选择一个有两个子节点的节点，并移除其左子节点或右子节点（及其后代节点）。选择并移除整个图也是一种允许的走法（这会立即输掉）。

如果两棵树在拓扑上是相同的，那么它们就具有等价的博弈。这种等价性包括交换任意单个节点的左右子节点，或者通过合并其上方和下方的边来移除只有一个子节点的节点（并将其子节点的深度减一）。

注释.我们也可以使用Grundy值（也称为nim值或nimbers）来分析这个游戏。这需要对规则进行轻微修改，即任何会擦除棋盘上所有整数的走法都是被禁止的，并且第一个无法移动的玩家输掉游戏。这显然等同于原始游戏。

令$g(S)$表示以集合$s$开始的游戏的Grundy值。注意引理1中的双射表明

$$
g ( S ) = g ( J ( S , \emptyset ) ) = g ( J ( \emptyset , S ) ) .
$$

对于任意集合 $V$ ，令 ${ \mathrm { m e x } } ( V )$ 表示不属于 $V$ 的最小非负元素。对于非负整数 $x$ 和 $y$ ，将 $j ( x , y )$ 递归地定义为

$$
j ( x , y ) = \mathrm { m e x } ( \{ x , y \} \cup \{ j ( w , y ) \mid w < x \} \cup \{ j ( x , z ) \mid z < y \} ) .
$$

对于小的 $x$ 和 $y$，$j ( x , y )$ 的值为：

$$
\begin{array} { r } { \begin{array} { c } { \mathrm { ~ 5 ~ } } \\ { \mathrm { ~ 4 ~ } } \\ { \mathrm { ~ 5 ~ } } \\ { \mathrm { ~ 3 ~ } } \\ { \mathrm { ~ 2 ~ } } \\ { \mathrm { ~ 1 ~ } } \\ { \mathrm { ~ 0 ~ } } \end{array} \left| \begin{array} { c c c c c c } { \mathrm { ~ 7 ~ } } & { 8 } & { 9 } & { 1 } & { 0 } \\ { \mathrm { ~ 3 ~ } } & { 3 } & { 6 } & { 2 } & { 0 } & { 1 } \\ { \mathrm { ~ 4 ~ } } & { 5 } & { 1 } & { 0 } & { 2 } & { 9 } \\ { \mathrm { ~ 3 ~ } } & { 4 } & { 0 } & { 1 } & { 6 } & { 8 } \\ { \mathrm { ~ 2 ~ } } & { 0 } & { 4 } & { 5 } & { 3 } & { 7 } \\ { \mathrm { ~ 1 ~ } } & { 2 } & { 3 } & { 4 } & { 5 } & { 6 } \\ { \mathrm { ~ 0 ~ } } & { 1 } & { 2 } & { 3 } & { 4 } & { 5 } \end{array} \right. } \end{array}
$$

我们可以证明，对于任意非空集合 $\boldsymbol{S}$ 和 $\tau$，有 $g ( J ( \mathcal { S } , \mathcal { T } ) ) = j ( g ( \mathcal { S } ) , g ( \mathcal { T } ) )$。 证明的其余部分遵循与给定解法类似的结构。

# C6.

设 $n$ 和 $T$ 为正整数。James 有 $4n$ 个弹珠，其重量分别为 1, 2,..., 4n。他将这些弹珠放在一个天平上，使得天平两边的重量相等。Andrew 可以将一个弹珠从天平的一边移动到另一边，使得移动后天平两边的重量绝对差值不超过 $T$：

求用 $n$ 表示的最小正整数 $T$，使得 Andrew 可以进行一系列移动，从而无论 James 最初如何放置弹珠，每个弹珠最终都位于天平的另一侧。

(加纳)

答案：$T$ 的最小值是 $4 n$ ：

解法 1. 我们必须有 $T ' \geqslant 4 n$，否则我们永远无法移动重量为 $4 n$ 的弹珠：我们将证明 $T = 4 n$，方法是证明：对于任何初始构型，都存在一个移动序列，该序列永远不会使差值的绝对值超过 $4 n$，并最终能使每个弹珠都移动到天平的另一侧。由于移动是可逆的，因此只需做到以下两点即可：给出至少一个可以实现此目标的构型 $C$，并证明任何初始构型都可以通过一系列移动到达这样一个构型 $C$。

考虑将砝码划分为对 $( t , 4 n + 1 - t )$ 。假设天平的每一侧都包含 $n$ 个这样的对。如果天平的一侧包含对 $( t , 4 n + 1 - t )$（其中 $1 \leqslant t < 2 n$），而另一侧包含 $( 2 n , 2 n + 1 )$ ，那么下面的移动序列可以在两侧之间交换这些对，同时，差的绝对值不会超过 $4 n$ ：

$$
\begin{array} { c } { t , 4 n + 1 - t \mid 2 n , 2 n + 1 } \\ { \qquad \quad t , 2 n , 4 n + 1 - t \mid 2 n + 1 } \\ { \qquad \quad t , 2 n \mid 2 n + 1 , 4 n + 1 - t } \\ { \qquad \quad t , 2 n , 2 n + 1 \mid 4 n + 1 - t } \\ { \qquad 2 n , 2 n + 1 \mid t , 4 n + 1 - t } \end{array}
$$

应用此序列两次，可将任意两对 $( t , 4 n + 1 - t )$ 和 $( t ^ { \prime } , 4 n + 1 - t ^ { \prime } )$ 在两侧之间进行交换。因此，我们可以实现配对在两侧之间的任意交换，并且 $C$ 可以是任意构型，其中天平的每一侧都包含 $n$ 个这样的配对。

我们现在证明，任何初始构型都可以达到一个每边都有 $n$ 对的构型。考虑一个构型，其中一边的总重量为 $A - s$，另一边的总重量为 $A + s$（对于某个 $0 \leqslant s \leqslant 2 n$），并且有一对被分在两边。（如果没有一对被分在两边，那么两边重量必然相等，我们就完成了。）有效的移动包括：将任何满足 $1 \leqslant w \leqslant 2 n + s$ 的重量 $w$ 从 $A + s$ 的一边移动到 $A - s$ 的一边，以及将任何满足 $1 \leqslant w \leqslant 2 n - s$ 的重量 $w$ 从 $A - s$ 的一边移动到 $A + s$ 的一边。假设对 $( t , 4 n + 1 - t )$（其中 $t \leqslant 2 n$）被分在两边。如果 $t$ 在 $A + s$ 的一边，或者在 $A - s$ 的一边且 $t \leqslant 2 n - s$，那么它可以被移动到另一边。否则，$t$ 在 $A - s$ 的一边且 $t \geqslant 2 n - s + 1$，那么 $4 n + 1 - t \leqslant 2 n + s$ 在 $A + s$ 的一边并且可以被移动到另一边。因此，我们可以将那一对中的两个重量合并而不拆分任何其他对，重复这个过程，我们就能达到一个没有对被分在两边的构型。

解法 2. 与解法1中一样，$T \geqslant 4 n$。令 $\delta$ 为左侧的重量减去右侧的重量。如果 $| \delta | \leqslant 4 n$，则称该构型为合法的；如果一个移动的结果是一个合法构型，则称该移动为合法的。我们将证明，若 $\delta = 0$，则存在一系列合法移动，使得每个弹珠最终都移到另一侧。

我们单独处理 $n = 1$ 的情况。初始构型是一边为弹珠1, 4，另一边为2,3。因此，按此顺序移动弹珠2,4,3,1是合法的，并且每个弹珠都最终移到了对边。现在假设 $n \geqslant 2$ ：

重量至多为 $2 n$ 的弹珠被称为小的。我们将使用以下引理：
引理 1. 如果一对合法构型仅在小弹珠的位置上不同，那么就存在一系列合法移动，可以从一个构型转变为另一个。

证明. 起初，我们只移动那些处于错误位置且不在较轻一侧的弹珠。（在平局的情况下，两侧都不是较轻的。）这样的移动总是合法的。由于这减少了处于错误位置的弹珠的数量，最终将不再可能执行这样的移动。

那么，唯一位置错误的弹珠都在较轻的一侧。所以，每次移动一个位置错误的弹珠总会使 $| \delta |$ 增加，并且最终 $| \delta | \leqslant 4 n$。因此，每一步移动都是合法的。□

引理 $\boldsymbol { \mathcal { Z } }$ 令 $k \in \mathbb N$ 。一个正整数可以表示为不超过 $k$ 的不同正整数之和，当且仅当它至多为 $k ( k + 1 ) / 2$ ： 证明。不超过 $k$ 的不同正整数的最大可能和是 $k ( k + 1 ) / 2$ 。对于另一个方向，我们对 $k$ 使用归纳法。$k = 1$ 的情况是平凡的。假设该命题对于 $k - 1$ 成立。对于不超过 $k$ 的正整数，我们只需要一项。对于更大的整数，在表达式中包含 $k$ 意味着我们可以根据归纳假设完成证明。 □

另请注意，当 $n \geqslant 2$ 时，$n ( 2 n + 1 ) \geqslant 4 n$。

设 $2 n < m \leqslant 4 n$ 。重量大于 $m$ 的弹珠被称为大的，重量从 $2 n + 1$ 到 $m$ 的弹珠被称为中等的。

假设所有的大弹珠都在正确的一侧（即，与它们起始位置相反的一侧），$m$ 在错误的一侧，并且该布局是合法的。那么，以下步骤给出了一系列合法的移动，在这些移动之后，$m$ 就在正确的一侧了，并且大弹珠从未被移动过。

假设 $m$ 在左边。在步骤 2 中，我们重新排列小弹珠，以便我们可以移动 $m$。但这只有在右边的大弹珠和中弹珠的重量不太大时才可能。因此，我们可能需要先从右边移走一些中弹珠，而这正是我们在步骤 1 中所做的。

步骤 1 如果右侧中等和大理石的总重量至多为 $n ( 4 n + 1 ) + 2 n - m$ ，则跳至步骤 2。由于大理石在正确的位置上且 $m$ 在不正确的位置上，右侧的大理石重量至多为 $n ( 4 n + 1 ) - m$ 。因此，右侧必定存在一个中等大理石 $m ^ { \prime } < m$ 。根据第一个假设，将所有小理石移到左侧是合法的。然后根据引理 2，我们可以将一些小理石移到右侧，从而使右侧的重量恰好为 $n ( 4 n + 1 ) + 2 n$ 。那么，移动 $m ^ { \prime }$ 是合法的。重复此步骤。由于右侧中等大理石的总重量在减少，此步骤只会发生有限次。
步骤 2 设右侧的总重量为 $n ( 4 n + 1 ) + 2 n - m + x$ ，右侧小理石的重量为 $y$ 。注意 $y \geqslant x$ 。如果 $x \leqslant 0$ ，那么移动 $m$ 是合法的。否则，根据引理 2，存在一组重量为 $y - x$ 的小理石。根据引理 1，存在一系列合法的小理石移动，使得右侧的重量恰好为 $n ( 4 n + 1 ) + 2 n - m$ 。现在，移动 $m$ 是合法的。

对 $m = 4 n$ ， $4 n - 1$ ，...， $2 n + 1$ 应用上述过程，将会把所有非小弹珠移动到对面。然后引理1完成了证明。

# C7.

设 $N$ 为一个正整数，并设 $a _ { 1 }$ ， $a _ { 2 }$ ，...为一个正整数的无限序列。假设，对于每个 $n > N$，$a _ { n }$ 等于 $a _ { n - 1 }$ 在列表 $a_1, a_2, ..., a_{n-1}$ 中出现的次数。

证明序列 $a _ { 1 }$ ， $a _ { 3 }$ ， $a _ { 5 }$ ，... 和 $a _ { 2 }$ ， $a _ { 4 }$ ， $a _ { 6 }$ ，... 中至少有一个是最终周期的。

(澳大利亚)

解法1.
令 $M > \operatorname* { m a x } ( a _ { 1 } , \ldots , a _ { N } )$ 。
我们首先证明某个整数会出现无限多次。
如果不是这样，那么该序列包含任意大的整数。
每个大于$M$的整数第一次出现时，其后都会跟着一个1。
因此，1会出现无限多次，这是一个矛盾。

现在我们证明，每个整数 $x \geqslant M$ 最多出现 $M - 1$ 次。若不然，考虑任意一个 $x \geqslant M$ 首次出现第 $M$ 次的时刻。在此之前，$x$ 的每一次出现，其前面都有一个已经出现过至少 $x$ 次的整数。因此，在 $x$ 之前，必定已经存在至少 $M$ 个出现过至少 $M$ 次的数，这就产生了矛盾。

因此，只有有限多个数会无限次地出现。设这些数中最大的为 $k$。因为 $k$ 出现了无限多次，所以必然存在无限多个大于 $M$ 的整数，它们在序列中至少出现 $k$ 次，因此，每个整数 1, 2, ..., $k - 1$ 也都无限次地出现。因为 $k + 1$ 不是无限次地出现，所以必然只有有限多个数出现超过 $k$ 次。设这些数中最大的为 $l \geqslant k$。从现在起，我们称一个整数 $x$ 为“大数”如果 $x > l$，为“中数”如果 $l \geqslant x > k$，为“小数”如果 $x \leqslant k$：总结一下，每个小数在序列中都无限次地出现，而每个大数在序列中最多出现 $k$ 次。

选择一个足够大的 $N ^ { \prime } > N$ 使得 $a _ { N ^ { \prime } }$ 很小，并且在 $a _ { 1 }$ ，， $a _ { N ^ { \prime } }$ 中

· 每个中等数已经完成了其所有出现次数；  
· 每个小数出现次数已超过 max(k, N)。

由于每个小数都出现了超过$k$次，越过这一点，每个小数后面必须跟一个大数。另外，根据定义，每个大数最多出现$k$次，所以它后面必须跟一个小数。因此，该序列在$a _ { N ^ { \prime } }$之后在大数和小数之间交替：

引理 $\mathit { 1 }$ 。令 $g$ 为一个出现在 $a _ { N ^ { \prime } }$ 之后的大数。如果 $g$ 后面跟着小数 $h$ ，那么 $h$ 等于在此之前至少出现 $g$ 次的小数的数量。

证明. 根据 $N ^ { \prime }$ 的定义，紧邻 $g$ 之前的小数出现的次数超过了 $\operatorname* { m a x } ( k , N )$，因此 $g > \operatorname* { m a x } ( k , N )$。并且由于 $g > N$，每个小数的第 $g$ 次出现必定发生在 $a _ { N }$ 之后，因此其后紧跟着 $g$。因为有 $k$ 个小数，并且 $g$ 最多出现 $k$ 次，所以 $g$ 必须恰好出现 $k$ 次，且每次都是在 $a _ { N }$ 之后紧跟着一个小数。因此，在 $g$ 第 $h$ 次出现时，恰好有 $h$ 个小数在该点之前已经至少出现了 $g$ 次。□

用 $a _ { [ i , j ] }$ 表示子序列 $a _ { i }$ ， $a _ { i + 1 } , \dotsc , a _ { j }$

引理 $\mathcal { Z }$.假设 $i$ 和 $j$ 满足以下条件：

(a) $j > i > N ^ { \prime } + 2$，
(b) $a _ { i }$ 较小且 $a _ { i } = a _ { j }$，
(c）在 $a _ { [ i , j - 1 ] }$ 中，没有小值出现超过一次

然后 $u _ { i - 2 }$ 等于 $a _ { [ i , j - 1 ] }$ 中的某个较小的数。

证明. 令 $\mathcal { L }$ 为在 $a _ { [ 1 , i - 1 ] }$ 中出现至少 $u _ { i - 1 }$ 次的小数的集合.根据引理1，$a _ { i } = | \mathcal { T } |$ .类似地，令 $\mathcal { I }$ 为在 $a_{[1, j-1]}$ 中出现至少 $a _ { j - 1 }$ 次的小数的集合.于是根据引理 $1$，$a _ { j } = | { \mathcal { I } } |$，因此根据 (b)，$| \mathcal { T } | = | \mathcal { I } |$ .另外，根据定义，$a _ { i - 2 } \in \mathcal { I }$ 且 $a _ { j - 2 } \in \mathcal { I }$ .

假设小数字 $a _ { j - 2 }$ 不在 $\mathcal { L }$ 中。这意味着 $a _ { j - 2 }$ 在 $\boldsymbol { a } _ { [ 1 , i - 1 ] }$ 中出现的次数少于 $u _ { i - 1 }$ 次。根据 (c)，$a _ { j - 2 }$ 在 $a _ { [ 1 , j - 1 ] }$ 中最多出现 $u _ { i - 1 }$ 次，因此 $a _ { j - 1 } \leqslant a _ { i - 1 }$。结合 $a _ { [ 1 , i - 1 ] } \subset a _ { [ 1 , j - 1 ] }$ ，这蕴含了 $\mathcal { T } \subseteq \mathcal { T }$。但由于 $a _ { j - 2 } \in \mathcal { I } \setminus \mathcal { I }$ ，这与 $| \mathcal { T } | = | \mathcal { I } |$ 相矛盾。所以 $a _ { j - 2 } \in \mathcal { I }$ ，这意味着它在 $a _ { [ 1 , i - 1 ] }$ 中至少出现了 $u _ { i - 1 }$ 次，并且在 $a _ { [ i , j - 1 ] }$ 中又多出现了一次。因此 $a _ { j - 1 } > a _ { i - 1 }$ ：

根据 (c)，任何在 $a _ { [ 1 , j - 1 ] }$ 中出现至少 $a _ { j - 1 }$ 次的小数字，在 $^ { a } [ 1 , i - 1 ]$ 中也已经出现了 $a _ { j - 1 } - 1 \geqslant$ $a _ { i - 1 }$ 次。所以 $\mathcal { I } \subseteq \mathcal { I }$ ，因此 $\mathcal { T } = \mathcal { T }$ 。因此，$a _ { i - 2 } \in \mathcal { I }$ ，所以它必须在 $a _ { [ i , j - 1 ] }$ 中至少再出现 $a _ { j - 1 } - a _ { i - 1 } = 1$ 次 □

对于每个满足 $n > N ^ { \prime } + 2$ 的小数 $a _ { n }$，令 $p _ { n }$ 为最小的数，使得对于某个满足 $n \leqslant i < n + p _ { n }$ 的 $i$，有 $a _ { n + p _ { n } } = a _ { i }$ 也是小数。换句话说，$a _ { n + p _ { n } } = a _ { i }$ 是在 $a _ { n - 1 }$ 之后第一个出现两次的小数。如果 $i > n$，那么根据引理2（令 $j = n + p _ { n }$），$u _ { i - 2 }$ 会在 $a _ { n + p _ { n } }$ 之前再次出现，这与 $p _ { n }$ 的最小性相矛盾。因此 $i = n$。引理2也意味着 $p _ { n } \geqslant p _ { n - 2 }$。所以 $p _ { n }$，$p _ { n + 2 }$，$p _ { n + 4 }$，... 是一个非递减序列，其上界为 $2 k$（因为只有 $k$ 个小数）。因此，$p _ { n }$，$p _ { n + 2 }$，$p _ { n + 4 }$，.. 最终会变为常数，并且小数的子序列最终是周期的，其周期至多为 $k$：

注。由于每个小数都出现无限次，解法1额外证明了小数序列具有周期$k$。小数序列的重复部分因此是从1到$k$的整数的一个排列。可以证明，从$1$到$k$的整数的每一个排列都可以通过这种方式实现。

解法 2. 我们遵循解法1，直到引理1之后。对于每个 $n > N ^ { \prime }$，我们追踪 1, 2,..., $k$ 中的每一个在 $a _ { 1 }$ ，….， $a _ { n }$ 中出现的次数。我们将把这一信息记录在一个不断更新的 $( k + 1 )$ -元组中

$$
( b _ { 1 } , b _ { 2 } , \ldots , b _ { k } ; j )
$$

其中每个 $b _ { i }$ 记录了 $i$ 出现的次数。$( k + 1 )$ 元组的最后一个元素 $j$，也称为活动元素，代表了在 $a _ { 1 }$ ，， $a _ { n }$ 中出现的最新小数字：

随着 $n$ 的增加，每当 $a _ { n }$ 是小数时，$( b _ { 1 } , b _ { 2 } , \ldots , b _ { k } ; j )$ 的值就会被更新。$( k + 1 )$ ，元组会基于其先前的值进行确定性更新。具体而言，当 $a _ { n } = j$ 是小数时，活跃元素被更新为 $j$，并且我们将 $b _ { j }$ 的值增加 $1$。下一个大数是 $a _ { n + 1 } = b _ { j }$：根据引理1，活跃元素的下一个值，即下一个小数 $a _ { n + 2 }$，由大于或等于新更新的 $b _ { j }$ 的 $b$ 项的数量给出，或

$$
| \{ i \mid 1 \leqslant i \leqslant k , \ b _ { i } \geqslant b _ { j } \} | .
$$

每个出现 $i + 1$ 次的足够大的整数也必须出现 $i$ 次，并且这两种出现都发生在初始的 $N$ 个块之后。因此，存在一个全局常数 $C$，使得 $b _ { i + 1 } - b _ { i } \leqslant C$。假设对于某个 $r$，$b _ { r + 1 } - b _ { r }$ 是无下界的。由于 $b _ { r + 1 } - b _ { r }$ 的值在更新时最多变化 1，因此必然存在一次更新，使得 $b _ { r + 1 } - b _ { r }$ 减小并且 $b _ { r + 1 } - b _ { r } < - ( k - 1 ) C$。结合对于所有的 $i$ 都有 $b _ { i } - b _ { i - 1 } \leqslant C$ 这一事实，我们可知，在这一点上，根据三角不等式

$$
\operatorname* { m i n } ( b _ { 1 } , \dots , b _ { r } ) > \operatorname* { m a x } ( b _ { r + 1 } , \dots , b _ { k } ) .
$$

因为 $b _ { r + 1 } - b _ { r }$ 刚刚减小，所以新的活跃元素是 $r$ 。从此时起，如果新的活跃元素至多为 $r$ ，那么根据(1)和(2)，下一个要增加的元素将再次来自 $b _ { 1 }$ ，…， $b _ { r }$ 。因此，从此时起，只有 $b _ { 1 }$ ，…， $b _ { r }$ 会增加，而 $b _ { k }$ 将不再增加，这与 $k$ 必须在序列中无限次出现的事实相矛盾。因此，$| b _ { r + 1 } - b _ { r } |$ 是有界的。

因为 $\lvert b _ { r + 1 } - b _ { r } \rvert$ 是有界的，所以对于 $i = 1 , \ldots , k$，每个 $| b _ { i } - b _ { 1 } |$ 都是有界的。这意味着对于 $( b _ { 1 } - b _ { 1 } , b _ { 2 } - b _ { 1 } , \dotsc , b _ { k } - b _ { 1 } ; j )$ 只有有限多个不同的状态：因为下一个活跃元素完全由 $b _ { 1 }$ ， $b _ { 2 }$ ，….， $b _ { k }$ 之间的相对大小决定，并且 $b$ 项的更新取决于活跃元素，所以活跃元素必定是最终周期的。因此，小数子序列，它要么是 $a _ { 1 }$ ， $a _ { 3 }$ ， $a _ { 5 } , \ldots .$ 要么是 $a _ { 2 }$ ， $a _ { 4 }$ ， $a _ { 6 } , \ldots ,$ ，必定是最终周期的。

# C8.

设 $n$ 为一个正整数。给定一个 $n \times n$ 的棋盘，左上角的单元格初始为黑色，其他单元格为白色。然后我们对棋盘进行一系列的涂色操作。在每次操作中，我们选择一个恰好有一个单元格为黑色的 $2 \times 2$ 正方形，并将该正方形中其余三个单元格涂成黑色。

确定所有 $n$ 的值，使得整个棋盘可以被涂成黑色。

答案：答案是 $n = 2 ^ { k }$，其中 $k$ 是一个非负整数。

解法 1. 我们首先通过归纳法证明，当 $n = 2 ^ { k }$ 时，可以将整个棋盘涂成黑色。$k = 1$ 的基本情况是平凡的。假设该结果对于 $k = m$ 成立，并考虑 $k = m + 1$ 的情况。将 $2 ^ { m + 1 } \times 2 ^ { m + 1 }$ 的棋盘划分为四个 $2 ^ { m } \times 2 ^ { m }$ 的子棋盘。使用归纳假设将左上角的 $2 ^ { m } \times 2 ^ { m }$ 子棋盘涂色。接下来，通过一次操作将中心的 $2 \times 2$ 方格涂色。最后，其余的每个 $2 ^ { m } \times 2 ^ { m }$ 子棋盘都可以使用归纳假设，从离中心最近的黑色方格开始被完全涂色。这完成了归纳法证明。

现在我们证明，如果对于 $n$ 存在这样的着色，那么 $n$ 必须是2的幂。假设可以对一个 $n \times n$ 的棋盘进行着色，其中 $n > 1$。将棋盘的左上角记为 $( 0 , 0 )$，右下角记为 $( n , n )$。每当在以 $( i , j )$ 为中心的 $2 \times 2$ 方格中进行一次操作时，我们立即画一个‘ $\mathsf { X } ^ { \prime \prime }$，连接四个单元格的中心（见图4）。同时，将这个 $\mathsf X$ 记为 $( i , j )$。第一次操作意味着在 $( 1 , 1 )$ 处有一个 $\mathsf X$：由于整个棋盘最终都会被着色，因此每个单元格的中心必须至少连接到一个 $\mathsf X$。所有 $\mathsf { X }$ 的集合构成了一个图 $G$：

![](images/a7a1c56e35faafd2485449585811a12ae08c44dc26a6e2736a0556089885ef86.jpg)  
Figure 4: $\mathsf { L }$ -trominoes placements corresponding to colouring operations (left） and the corresponding $\mathsf X$ diagram (right).

断言 1. 图 $G$ 是树。

证明. 由于每一次操作都需要一个已有的黑色单元格，除了第一个之外，每一个新画出的 $\mathsf X$ 都必须连接到一个已有的 $\mathsf X$ 上。因此，所有的 $\mathsf X$ 都与第一个 $\mathsf X$ 相连接，并且图 $G$ 必须是连通的。现在，假设 $G$ 包含一个环。考虑该环中最新的那个 $\mathsf X$，它必须在至少两个点上与之前的 $\mathsf X$ 相连接。但这意味着对应的操作最多只会为两个单元格着色，这是一个矛盾。 □

请注意，在接下来的论证中，声明2到4仅要求满足$G$是一棵树且每个单元都与$G$相连这一条件：

断言 2. 如果在 $( i , j )$ 处有一个 $\mathsf X$，那么 $1 \leqslant i , j \leqslant n - 1$ 且 $i \equiv j$ (mod 2)。

证明. 不等式 $1 \leqslant i , j \leqslant n - 1$ 是显然的.称位于 $( i , j )$ 的 $\mathsf X$ 为好的，如果 $i \equiv j \pmod{2}$，为坏的，如果 $i \not \equiv j \pmod{2}$.第一个位于 $( i , j ) = ( 1 , 1 )$ 的 $\mathsf X$ 是好的.假设某些 $\mathsf X$ 是坏的.由于 $G$ 是连通的，必然存在一个好的 $\mathsf X$ 与一个坏的 $\mathsf X$ 相连.但这只有在它们于两点相连，从而形成一个环时才可能发生.这是一个矛盾，因此所有的 $\mathsf { X s }$ 都是好的. □

称位于 $(i, j)$ 的 $\mathsf X$ 为奇，如果 $i \equiv j \equiv 1 \pmod{2}$；为偶，如果 $i \equiv j \equiv 0 \pmod{2}$：

声明 3. 整数 $n$ 必须为偶数。此外，必须有 $4 ( n / 2 - 1 )$ 个奇数 X 连接棋盘周边上的格子，如图 5 所示。

证明。如果 $n$ 是奇数，左下角单元格的四个角分别是 $( n , 0 ) , ( n - 1 , 0 ) , ( n - 1 , 1 )$ 和 $( n , 1 )$，这些点都不满足引理2的条件。所以左下角单元格不能连接到任何 $\mathsf X$。如果 $n$ 是偶数，棋盘边缘的每个单元格恰好有一个角满足引理2的条件，因此连接它的 $\mathsf X$ 是唯一确定的。因此，棋盘周边的单元格与 $\mathsf X$ 的连接方式如图5所示。□

![](images/2e7ee69389a4fec5af5511671d06de4754492a478284c289bbfe46a74a3bf304.jpg)  
Figure 5: Highlighting the permited points for Xs (left)and Xs on the perimeter (right).

将 $n \times n$ 的棋盘划分为 $n ^ { 2 } / 4$ 个 $2 \times 2$ 的方格区块。将每个这样的区块称为一个大方格。如果一个大方格内部包含奇数个 $\mathsf X$，我们称其为“已填充的”，否则称其为“空的”。根据声明3，位于边缘的每个大方格都必须是已填充的。

声明4. 每个大单元格均被填充。

证明. 回顾，X 只能位于满足 i ≡ j (mod 2) 的位置 (i, j) 上。假设一个以 (i, j) 为中心的大单元是空的。那么，为了使其四个单元被着色，就必须在 (i-1, j-1)、(i+1, j-1)、(i-1, j+1) 和 (i+1, j+1) 上有四个偶数 X 来“包围”这个大单元（见图 6）。

根据声明3，任何空的大单元都不能位于边界上。因此，如果存在空的大单元，那么空单元与实心单元之间的边界必须由若干个闭合环路组成。每个闭合环路由若干长度为2的线段组成，其中每一条线段都将一个实心单元与一个空单元隔开。

因为每个空的大单元格都被偶数个X包围，并且每个被填充的大单元格都包含奇数个 $\mathsf X$，所以每个此类线段的两个端点必须由X连接。因为这些线段形成了至少一个闭合回路，所以这意味着存在一个由X组成的循环（见图6）。这是一个矛盾，因此没有大单元格可以是空的。□

![](images/d1ede46b603b17c056f148758a398c4b70feee1ba4f708ad1d5eb7c1fa6e31d3.jpg)  
Figure 6: An empty big-cellsurrounded by even Xs (left） and the boundary between empty and filled $\mathsf { X } \mathrm { s }$ creating a cycle (right).

因此，每个大单元格都由一个奇数 $\mathsf X$ 填充，而它们之间的连接则由偶数 Xs 提供。我们现在可以通过以下方式将 $n \times n$ 问题简化为一个 $n / 2 \times n / 2$ 问题。相对于点 $( 0 , 0 )$ ，将棋盘缩放 $1 / 2$ 倍。每个大单元格都被缩小为一个常规单元格。对于 $\mathsf { X s }$ ，将位于 $( i , j )$ 的每个奇数 $\mathsf X$ 替换为点 $( i / 2 , j / 2 )$ ，并将位于 $( i , j )$ 的每个偶数 $\mathsf X$ 替换为位于 $( i / 2 , j / 2 )$ 的一个 $\mathsf X$ ：

我们声称，由 $\mathsf { X s }$ 构成的新图是一棵树，它连接了 $n / 2 \times n / 2$ 棋盘上的所有单元格。首先，在原始 $n \times n$ 棋盘中相连的两个 X，在被替换后仍然相连（注意，一些 X 已被单个点替换）。对于 $n / 2 \times n / 2$ 棋盘中的每个单元格，其中心对应于原始 $n \times n$ 棋盘中一个被填充的大单元格里的奇数 $\mathsf X$，因此它必须连接到该图上。最后，假设新图中存在一个环。该环由 X 组成，这些 X 对应于原始图中连接大单元格的偶数 X，从而形成一个大单元格的环。因为在每个大单元格中，四个单位方格由一个奇数 $\mathsf X$ 连接，这意味着原始图中存在一个环，这是一个矛盾。

因此，X的新图必须是一棵树，它连接一个 $n / 2 \times n / 2$ 棋盘的所有格子，这正是引理2到4所要求的条件。因此，我们可以重复我们的论证，每次将棋盘的尺寸减半，直到我们达到一个 $1 \times 1$ 棋盘的基本情况（此时这棵树是一个单点）。因此，$n$ 必须是2的幂，从而完成了整个解答。

解法 2.与解法 1 类似，当 $n = 2 ^ { k }$ 时，有可能将整个棋盘涂成黑色：
涂色操作等价于 L-三格板的放置。对于我们在棋盘上放置的每一个 L-三格板，我们都画一个箭头和一个节点，如图 7 所示。我们还在棋盘的左上角画一个节点。

![](images/8469c363a641816b46f16a5a04b27cd4af44d75e0ece79ce9999a59c9e95d151.jpg)  
Figure 7: Tromino with corresponding arrow and node drawn.

声明1. 箭头和节点构成一个以左上角为根的有向树。

证明.该证明与解法1中引理1的证明相似，但需额外注意，箭头的方向继承了着色操作的顺序，因此它们必须背离左上角的节点。□

需要注意的是，由于树的所有边都是对角线，因此节点只能位于满足 $i + j \equiv 0 \pmod{2}$ 的点 $(i, j)$ 上。这意味着我们只能放置具有特定奇偶性的 $\mathsf{L}$-三格板：也就是说，L-三格板的中心必须位于一个满足 $i + j \equiv 0 \pmod{2}$ 的点上。在证明的其余部分，当确定 L-三格板的可能位置时，我们将隐式地使用这一奇偶性性质。

接下来，我们将证明树的某些边构型是不可能的。
断言 2. 不能存在两条边处于“平行”构型中（见图 8）。
证明. 在此构型中，这两条边的方向可以相同，也可以相反。
如果它们指向相同的方向（见图 8），那么与这两条边相对应的L型三格板会重叠。

![](images/1929459c9fcba2fb324b888a2d92ca4dfd40c00f8e8408e8ad7cbbafd79e948f.jpg)  
Figure 8: Parallel configuration (left) and two paralel edges,case 1 (right).

如果它们指向相反的方向，那么我们就会得到图9中的图示。标记有 ($\star$) 的格子必须位于 $n \times n$ 棋盘内部，因此它们必须被 L-型三格板覆盖。只有一种可能的方式可以用具有正确奇偶性的 $\mathsf { L }$-型三格板来覆盖这些格子。但这会导致箭头形成一个循环，而这是不可能发生的。因此我们得到了一个矛盾。□

![](images/6608c489535f4ff9c81f76566336b308209a0e119a34c0b2c4d7b1cd6df27634.jpg)  
Figure 9: Two parallel edges, case 2.

声明3. 不可能存在如图10所示的“之字形”配置的三条边。

![](images/f2bffc05f3b923f5ad234af4d137f5703d8e5456a95db2d2fed7e810c9bf87fb.jpg)  
Figure 10: Zigzag configuration.

证明。为导出矛盾，假设存在一个锯齿形路径。然后，取距离树根最远的那个锯齿形路径（此处的距离是指从树根到该锯齿形路径的中间边，沿着图所测得的距离）。

不失一般性，我们可以假设中间的边指向右下方。那么，右边的边必须指向右上方，因为没有两个箭头可以指向同一个节点。接下来，我们画出相应的L型三格板，并考虑标记为 ( $\star$ ) 的单元格。由于L型三格板中心的奇偶性，有两种可能的方式可以用一个L型三格板来覆盖它。

我们可以选择L型三格板的中心为单元格的右上角（见图11）。这立即给出了另一个锯齿形。

![](images/af67fce30e6014018f1534d23e13c6e3f277b5a4219139c3a9458c7343b90c2f.jpg)  
Figure 11: Zigzag configuration, case 1.

另一种可能性是，如果我们选择L型三格板的中心作为单元格的左下角（见图12）。那么，我们需要用一个L型三格板来覆盖标记为 $\big ( { \star \star } \big )$ 的单元格。如果我们将L型三格板的中心放在单元格的左上角，这将会产生两条平行的边，与引理2相矛盾。所以，我们必须将L型三格板的中心放在单元格的右下角，这会形成一个锯齿形。

![](images/9f1c4a831f3ae9ef4632f39a2e99a12c1fa6785e9e08684b14e08fca4ae7e968.jpg)  
Figure 12: Zigzag configuration, case 2.

在每种情况下，我们都会得到另一个离树的根更远的锯齿，这与我们的极大性假设相矛盾。所以，不可能有任何锯齿。□

我们现在给树的节点着色。将根节点着色为黄色。对于所有其他节点，如果从该节点出发的箭头与指向该节点的箭头方向不同，则将其着色为白色；否则，将其着色为黑色。

断言4. 任何黑色节点的子节点都是白色的。

![](images/e6a1b92fe3da411dcb9c350271c370ec9c3596a135f92667e55d69d5715288cc.jpg)  
Figure 13: Black node configuration.

证明。假设我们有一个带有一个子节点的黑色节点。那么，根据我们的着色定义，从该黑色节点出发的箭头必须与进入它的箭头方向相同，从而得到图13的左图。

标记为 ( $\star$ ) 的格子必须被一个L型三格板覆盖。如果这个L型三格板的中心是左下角，那么这会产生一个从黑色节点出发、朝向不同方向的箭头，而这是不可能发生的。因此，这个L型三格板的中心必须是右上角，这会产生一个从上方节点出发、朝向不同方向的箭头。因此，上方的节点必须是白色的。□

![](images/4a7d75a4b9aec58a5a77d69fd5d2275fd90f6112f789378193240c6753ae54ba.jpg)  
Claim 5. Every white node has three children, all of which are black.   
Figure 14: White node configuration.

证明。参见图14。假设我们有一个白色节点，如最左边的图所示。标记为 $( \star )$ 的单元格必须被一个 $\mathsf { L }$ -三格骨牌覆盖。如果这个 $\mathsf { L }$ -三格骨牌的中心是该单元格的右下角，那么这将形成一个之字形，根据引理3，这是不允许的。因此，中心必须是左上角。

接下来，标记为 $\big ( { \star \star } \big )$ 的单元格必须被一个L型三格骨牌覆盖。如果这个L型三格骨牌的中心是右上角，这将会形成一个锯齿形，因此中心必须是左下角。因此，我们已经证明了任何白色节点都有三个子节点。

最后，请注意，如果任何子节点自身有三个子节点，那么这将在图中产生平行边，这与论断2相矛盾。因此，白色节点的子节点必须全部为黑色。□

我们现在知道，沿着树向下，节点的颜色在黑色和白色之间交替，因此所有白色节点都位于坐标为 $( 2 i , 2 j )$ 的点上，所有黑色节点都位于坐标为 $( 2 i + 1 , 2 j + 1 )$ 的点上：

现在（假设 $n > 1$），我们将构建一个新棋盘，其单元格由当前棋盘的 $2 \times 2$ 方块构成。我们将根节点及其子节点替换为一个大的单元格和一个大的根节点，并将每个白色节点及其三个子节点替换为一个大的L型三格板、一个大的箭头和一个大的节点，如图15所示。

![](images/d0f9adb1ba62b4b88fc8e612839773a66ecf0af24e8b6e2c4719f835def9891f.jpg)  
Figure 15: Replacing with larger cells and L-trominoes.

每个黑色节点都是根节点或一个白色节点的子节点，因此每个 L 型三格板都恰好参与一次替换。此外，任何白色节点的父节点都是一个黑色节点，而该黑色节点的父节点反过来又是一个白色节点或根节点。所以每个大箭头的起点都将位于一个大节点上。因此，我们得到了一个形成一棵树的 L 型三格板平铺。

这表明，对于 $n > 1$，如果一个 $n \times n$ 的棋盘可以被形成一棵树的 $\mathsf { L }$ 型三格板铺满，那么 $n$ 是偶数，并且一个 $n / 2 \times n / 2$ 的棋盘也可以被形成一棵树的 $\mathsf { L }$ 型三格板铺满。由于一个 $1 \times 1$ 的棋盘可以被平凡地铺满，我们断定，使得一个 $n \times n$ 的棋盘可以被铺满的 $n$ 的唯一值是 $n = 2 ^ { k }$ ：

# 几何

# G1.

设 $ABCD$ 为一个圆内接四边形，且满足 $AC < BD < AD$ 且 $\angle DBA < 90^{\circ}$：点 $E$ 位于过点 $D$ 且与 $AB$ 平行的直线上，且满足 $E$ 和 $C$ 在直线 $AD$ 的异侧，且 $AC = DE$。点 $F$ 位于过点 $A$ 且与 $CD$ 平行的直线上，且满足 $F$ 和 $C$ 在直线 $AD$ 的异侧，且 $BD = AF$：

证明线段BC和EF的垂直平分线在四边形ABCD的外接圆上相交。

(乌克兰)

解法一. 设 $T$ 为弧 $\widehat{BAC}$ 的中点，且直线 $BA$ 和 $CD$ 分别交 $EF$ 于点 $K$ 和 $L$。注意到 $T$ 位于线段 $BC$ 的垂直平分线上：

![](images/c0488af07fcf4f9da874ba724f2ab05f82810365c1e4896389e1474d6ddf6834.jpg)

因为 $A B C D$ 是圆内接四边形，$\begin{array} { r } { \frac { B D } { \sin \angle B A D } = \frac { A C } { \sin \angle A D C } } \end{array}$ 。由平行线可得 $\angle D A F = \angle A D C$ 和 $\angle B A D = \angle E D A$ 。因此，

$$
A F \cdot \sin \angle D A F = B D \cdot \sin \angle A D C = A C \cdot \sin \angle B A D = D E \cdot \sin \angle E D A .
$$

所以 $F$ 和 $E$ 与直线 $A D$ 等距，即 $E F$ 平行于 $A D$ ：

已知 $K A D E$ 和 $F A D L$ 是平行四边形，因此我们得到 $K A = D E = A C$ 和 ${ \cal D } { \cal L } = { \cal A } { \cal F } = B { \cal D}$，并且 $K E = A D = F L$，所以只需证明 $K L$ 的垂直平分线经过 $T$ ：

三角形 $AKC$ 是等腰的，所以 $\angle BTC = \angle BAC = 2 \angle BKC$。同样地，$\angle BTC = 2 \angle BLC$：因为 $T$、$K$ 和 $L$ 都位于 $BC$ 的同一侧，并且 $T$ 位于 $BC$ 的垂直平分线上，所以 $T$ 是圆 $BKLC$ 的圆心。结论得证。

解法二. 设 $AF$ 和 $DE$ 分别与 $\omega$ 相交于点 $X$ 和 $Y$，且令 $T$ 如解法一中所述。由于 $BD < AD$，$DY \parallel AB$ 且 $\angle BAY = \angle DBA < 90^{\circ}$，我们有 $DY < AB$ 且 $Y$ 位于直线 $AD$ 的与 $C$ 相对的一侧。同样由 $BD < AD$，我们有 $B$、$C$ 和 $D$ 都位于 $AB$ 的垂直平分线的同一侧，这表明 $AC > AB$。结合这些，我们得到 $DY < AB < AC = DE$，并且，由于 $Y$ 和 $E$ 都位于直线 $AD$ 的同一侧，$Y$ 位于线段 $DE$ 的内部。同理，$X$ 位于线段 $DF$ 的内部。

因为 $AB$ 平行于 $DY$，所以 $YA = BD = FA$。同理 $XD = AC = ED$：

![](images/3469c94bef3a0f4c78e26d325b71534615fd7bbe31ef035adba15359896372a1.jpg)

断言 $\mathit{1}$，$T$ 是弧 $\widehat{XY}$ 的中点：证明. 由 $AX \parallel CD$ 和 $AB \parallel DY$ 可得

$$
\angle C A X = \angle A X D = \angle A Y D = \angle Y D B
$$

因为 $T$ 是弧 $\widehat { B A C }$ 的中点，我们有 $\angle B A T = \angle T D C$，所以

$$
\angle T A X = \angle C A X + \angle B A C - \angle B A T = \angle Y D B + \angle B D C - \angle T D C = \angle Y D T .
$$

回顾上文，我们有 $AB < AC$，并且类似地，$DC < DB$，这表明 $X$、$Y$ 和 $T$ 都位于直线 $AD$ 的同一侧。特别地，$T$ 和 $A$ 位于 $XY$ 的两侧，所以 $T$ 位于 $\angle XAY$ 的内角平分线上。因为 $AF = AY$，所以有 $\triangle ATF \cong \triangle ATY$，因此得到 $T'F' = T'Y$：

同理，$T E = T X$ ，所以 $T E = T F$ ，这意味着 $T$ 位于线段 $E F$ 的垂直平分线上，如所要求的。

注.该命题在没有圆内接四边形 $A B C D$ 的长度和角度条件的情况下仍然成立，然而需要格外小心，根据直线 $D E$ 和 $A F$ 上点的顺序来考虑不同的情况。$T$ 也有可能位于 $\angle X A Y$ 的外角平分线上：

解法 3. 由 $A F = D B$ ， $A C = D E$ 且

$$
\angle ( A C , A F ) = \angle ( A C , C D ) = \angle ( A B , B D ) = \angle ( D E , D B ) ,
$$

三角形 ACF 和三角形 DEB 全等，所以 CF = BE：

设 $P = B E \cap C F$ 。因为

$$
\angle ( C P , B P ) = \angle ( C F , B E ) = \angle ( A F , D B ) = \angle ( D C , D B ) ,
$$

有$P$位于圆$ABCD$上：

![](images/9356faa870ecad12c0a2735d53ead2cc3fc1c58e74964d2e4d1673b639f428b0.jpg)

最后，令 $T$ 为四边形 $B C F E$ 的密克尔点，因此 $T$ 位于圆 $E F P$ 和圆 $A B C D$ 上。注意，$T$ 是将线段 $B E$ 映射到 $\boldsymbol { C } \boldsymbol { F }$ 的螺旋相似的中心，并且由于 $B E = C F$，这实际上只是一个旋转，所以 $T B = T C$ 且 $T E = T F$；即 $B C$ 和 $E F$ 的垂直平分线相交于点 $T$，且 $T$ 在圆 $A B C D$ 上：

# G2.

设 $ABC$ 为一个三角形，且满足 $AB < AC < BC$，内心为 $I$，内切圆为 $\omega$。设 $X$ 为边 $BC$ 内部的一点，使得过 $X$ 且平行于 $AC$ 的直线与 $\omega$ 相切：同理，设 $Y$ 为边 $BC$ 内部的一点，使得过 $Y$ 且平行于 $AB$ 的直线与 $\omega$ 相切。设 $AI$ 与三角形 $ABC$ 的外接圆再次相交于点 $P \neq A$。设 $K$ 和 $L$ 分别为 $AB$ 和 $AC$ 的中点。

证明 $\angle K I L + \angle Y P X = 1 8 0 ^ { \circ }$

(波兰)

解法1. 设 $A ^ { \prime }$ 是 $A$ 关于 $I$ 的对称点，则 $A ^ { \prime }$ 位于角平分线 $A P$ 上。直线 $A ^ { \prime } X$ 和 $A ^ { \prime } Y$ 分别是 $A C$ 和 $A B$ 关于 $I$ 的反射线，因此它们分别是过 $X$ 和 $Y$ 的 $\omega$ 的切线。众所周知，$P B = P C = P I$，并且由于 $\angle B A P = \angle P A C > 3 0 ^ { \circ }$，$P B = P C$ 大于外接圆半径。因此 $\begin{array} { r } { P I > \frac { 1 } { 2 } A P > A I } \end{array}$；我们得出结论，$A ^ { \prime }$ 位于线段 $A P$ 的内部：

![](images/1abb18f2f62dfd7b08d1f3cba956635978a0eb49947c30cb2c8361fd6c45e350.jpg)

在外接圆中，我们有 $\angle A P B = \angle A C B$，且因为 $A ^ { \prime } X \parallel A C$，所以 $\angle A C B = \angle A ^ { \prime } X C$。因此，$\angle A P B = \angle A ^ { \prime } X C$，所以四边形 $B P A ^ { \prime } X$ 是圆内接四边形。类似地，同理可得四边形 $C Y A ^ { \prime } P$ 是圆内接四边形。

现在我们准备将 $\angle K I L + \angle Y P X$ 转化为三角形 $A ^ { \prime } C B$ 的内角和。通过一个以A为中心、比例为2的位似变换，我们得到 $\angle K I L = \angle C A ^ { \prime } B$ 。在圆 $B P A ^ { \prime } X$ 和圆 $C Y A ^ { \prime } P$ 中，我们有 $\angle A P X = \angle A ^ { \prime } B C$ 和 $\angle Y P A = \angle B C A ^ { \prime }$ ，因此

$$
\angle K I L + \angle Y P X = \angle C A ^ { \prime } B + \left( \angle Y P A + \angle A P X \right) = \angle C A ^ { \prime } B + \angle B C A ^ { \prime } + \angle A ^ { \prime } B C
$$

注.约束条件 $A B < A C < B C$ 是由命题委员会添加的，旨在减少因点的不同顺序而产生的情况。否则，根据点 $A$、$P$ 和 $A ^ { \prime }$ 的可能顺序，还会有另外两种可能的构型，如下图所示。这些情况的解法大体上相同，但在退化情况下需要格外注意：即当 $A ^ { \prime }$ 与 $P$ 重合，且直线 $A P$ 是圆 $B P X$ 和圆 $C P Y$ 的公切线时：

![](images/87e7fccd720edd1a133198aedb81872e02889bbf64a9fa2cb008e707b6cf0ebe.jpg)

解法二。设 $BC = a$，$AC = b$，$AB = c$ 且 $\textstyle s = { \frac { a + b + c } { 2 } }$，并设内切圆、$B$-旁切圆和$C$-旁切圆的半径分别为 $r$，$r_b$ 和 $r_c$。设内切圆与 $AC$ 和 $AB$ 分别相切于点 $B_0$ 和 $C_0$；设 $B$-旁切圆与 $AC$ 相切于点 $B_1$，并设 $C$-旁切圆与 $AB$ 相切于点 $C_1$。众所周知，$AB_1 = s - c$ 且 $\mathrm{area}(\triangle ABC) = rs = r_c(s - c)$：

设过点X且平行于AC的直线切内切圆于点E ，过点Y且平行于AB的直线切内切圆于点D 。最后 ，设AP与BB₁交于点F 。

![](images/d06e7adfb9016de005214519238c44028ff60cb7c77878f56f6dfacae59dc02a.jpg)

众所周知，由于内切圆与 $B$-旁切圆之间的位似，点 $B$、$E$ 和 $B_{1}$ 共线，并且因为 $IK$ 是三角形 $B_{0}EB_{1}$ 的中位线，所以 $BE \parallel IK$。
同理可得，点 $C$、$D$ 和 $C_{1}$ 共线且 $CD \parallel IL$。
因此，问题可简化为证明 $\angle YPA = \angle CBE$（以及其关于顶点 $C$ 的对称情形 $\angle APX = \angle DCB$），因此只需证明 $FY \parallel B_1C$ 且 $\begin{array}{r} \frac{BF}{FB_1} = \frac{BY}{YC} \end{array}$ $FYPB$ 四点共圆。
由于 $ACPB$ 四点共圆，即

根据角平分线定理得

$$
{ \frac { B F } { F B _ { 1 } } } = { \frac { A B } { A B _ { 1 } } } = { \frac { c } { s - c } } .
$$

以$C$为中心，将内切圆映射到$C$-旁切圆的位似，将点$Y$映射到点$B$。

$$
{ \frac { B C } { Y C } } = { \frac { r _ { c } } { r } } = { \frac { s } { s - c } } .
$$

所以，

$$
{ \frac { B Y } { Y C } } = { \frac { B C } { Y C } } - 1 = { \frac { s } { s - c } } - 1 = { \frac { c } { s - c } } = { \frac { B F } { F B _ { 1 } } } ,
$$

至此解决方案完成。

# G3.

设 $ABCDE$ 是一个凸五边形，且设 $M$ 为 $AB$ 的中点。假设线段 $AB$ 与三角形 $CME$ 的外接圆相切于点 $M$，且 $D$ 位于三角形 $AME$ 和 $BMC$ 的外接圆上。直线 $AD$ 和 $ME$ 相交于点 $K$，且直线 $BD$ 和 $MC$ 相交于点 $L$。点 $P$ 和 $Q$ 位于直线 $EC$ 上，使得 $\angle PDC = \angle EDQ = \angle ADB$：

证明直线$KP$、$LQ$和$MD$共点。

(白俄罗斯)

通用说明。我们提出的每个解决方案均由三个独立部分组成：

(a） 证明 $K P \parallel M C$ 和 $L Q \parallel M E$：
(b） 证明 $K L \parallel A B$ 并且，可选地，证明点 $C$ 、 $E$ 、 $K$ 和 $L$ 共圆；
(c） 使用位似、由直线 $K P$ 、 $M K$ 、 $M L$ 和 $L Q$ 围成的平行四边形，或三个圆的根轴来完成解答。

解决方案 1
(a）注意到条件 $\angle P D C \ = \ \angle A D B$ 等价于 $\angle A D P \ = \ \angle B D C$ ，并且 $\angle E D Q = \angle A D B$ 等价于 $\angle E D A = \angle Q D B$ .由直线 $AB$ 与圆 $CME$ 相切，以及圆 $AMDE$ 和圆 $CDME$，我们可得 $\angle E C M = \angle E M A = \angle E D A = \angle Q D B$ 以及 $\angle M E C = \angle B M C = \angle B D C = \angle A D P$利用 $\angle A D P = \angle M E C$ ，点 $D$ 、 $E$ 、 $K$ 和 $P$ 共圆，这可得 $\angle E P K = \angle E D A = \angle E C M$ .由此，我们可以看出 $K P \parallel M C$ .类似地可以证明点 $C$ 、 $\boldsymbol { D }$ 、 $Q$ 和 $L$ 共圆，$\angle L Q C = \angle M E C$，因此 $L Q \parallel M E$ ：

![](images/ff69550b38f3f56214d4b55fd564955e8233f768aae1ffc7413aa91059833009.jpg)

(b） 设射线 $DA$ 和 $DB$ 分别与圆 $CDE$ 相交于点 $R$ 和 $S$。我们现在观察到 $\angle SEC = \angle SDC = \angle MEC$，因此点 $E$、$M$ 和 $S$ 共线。同理，我们得到点 $C$、$M$ 和 $R$ 共线。由 $\angle SRC = \angle SEC = \angle BMC$ 可知 $RS \parallel AB$。由于 $M$ 是 $AB$ 的中点，因此 $KL \parallel RS$：
(c） 考虑以 $D$ 为中心、将 $RS$ 映射到 $KL$ 的位似变换。因为 $KP \parallel RC$ 且 $LQ \parallel SE$，该位似变换将共点线 $DM$、$RC$ 和 $SE$ 分别映射到 $DM$、$KP$ 和 $LQ$，所以这些直线也共点。

解决方案 2

(a) 与解法1类似，我们证明如下：$\angle E C M \ = \ \angle E M A \ = \ \angle E D A \ = \ \angle E P K$ ， $\angle M E C = \angle B M C = \angle B D C = \angle L Q C$ ；点 $C$ ， $D$ ， $Q$ ，和 $L$ 共圆；点 $\boldsymbol { D }$ ， $E$ ， $K$ ,和 $P$ 共圆； $K P \parallel M C$ ；且 $L Q \parallel M E$   
(b） 注意到三角形 $E K P$ 和 $E M C$ 在点 $E$ 处位似，因此它们的外接圆 $C M E$ 和 $D E K P$ 在点 $E$ 处相切。同理，圆 $C D Q L$ 与圆 $C M E$ 在点 $C$ 处相切：假设圆 $C M E$ 在点 $C$ 和 $E$ 处的切线相交于点 $X$ 。（当 $C E$ 是圆 $C M E$ 的直径时，可视为一种极限情况。）此外，设 $E X$ 和 $C X$ 分别与圆 $D E A M$ 和 $B C D M$ 再次相交于 $A _ { 1 } \neq E$ 和 $B _ { 1 } \neq C$ 。

![](images/7337b50fb2f197c04d2e3e3b92e76f416e1d04149842f5279f1e2f4d3cb89691.jpg)

我们有 $X E = X C$，因为它们是从点 $X$ 到圆 $C M E$ 的切线。此外，在圆 $D E A M$ 中，弦 $A M$ 和 $A _ { 1 } E$ 都与圆 $C M E$ 相切，所以 $A _ { 1 } E = A M$。同理，我们有 $B _ { 1 } C = B M$，因此 $A _ { 1 } E = A M = B M = B _ { 1 } C$。我们得出 $X A _ { 1 } = X B _ { 1 }$，所以点 $X$ 关于圆 $D E A M$ 和圆 $B C D M$ 的幂相等。因此，点 $X$ 位于这两个圆的根轴上，即直线 $D M$：

现在注意到，由 $X C = X E$，点 $X$ 对圆 $C D Q L$ 和圆 $D E K P$ 的幂相等，所以 $D X$ 是这两个圆的根轴。点 $M$ 在 $D X$ 上，所以 $M E \cdot M K = M C \cdot M L$，我们得出结论 $C$ 、$E$ 、$K$ 、$L$ 四点共圆。因此，由 $\angle M K L = \angle E C M = \angle K M A$，我们有 $K L \parallel A B$。

(c) 由于 $\angle E P K = \angle E M A = \angle Q L K$ ，可得 $K L Q P$ 共圆。圆 $D E K P$ 、 $C D Q L$ 和 $K L Q P$ 两两的根轴分别为 $D M$ 、 $K P$ 和 $L Q$ ，因此它们共点于这三个圆的根心。

解决方案 3

(b） 我们给出$K L \parallel A B$的另一个证明：设$A D \cap L Q = I$，$B D \cap K P = H$，$A B \cap L Q = U$且$A B \cap K P = V$。由于

$$
\angle D H P = \angle D L M = 1 8 0 ^ { \circ } - \angle C L D = 1 8 0 ^ { \circ } - \angle C Q D = \angle D Q E ,
$$

点 $H$ 位于圆 $D P Q$ 上。同样地，我们得到点 $I$ 也位于此圆上。因此，$\angle L I H = \angle Q D B = \angle E D A = \angle E M A$，且 $L Q \parallel M E$ 推出 $H I \parallel A B$：

![](images/98cb0789a23af9a40d7b6ccd5944f0579a929439e428a8b78816feb7e5de17ce.jpg)

设 $A M = B M = d$，则我们有

$$
{ \frac { B U } { I H } } = { \frac { B L } { L H } } = { \frac { B M } { M V } } = { \frac { d } { d + A V } } \quad { \mathrm { a n d } } \quad { \frac { A V } { I H } } = { \frac { A K } { K I } } = { \frac { A M } { M U } } = { \frac { d } { d + B U } } .
$$

因此，$B U \cdot ( d + A V ) = A V \cdot ( d + B U )$，所以 $B U = A V$。因此，$\triangle M L U \cong \triangle V K M$，这意味着 $K L \parallel A B \parallel H I$：

(c） 直线 $M K$ 、 $M L$ 、 $K P$ 和 $L Q$ 围成一个平行四边形。直线 $D M$ 穿过 $K L$ 的中点（即平行四边形的中心），并且穿过顶点 $M$：因此，$D M$ 穿过对顶点，即 $K P$ 和 $L Q$ 的交点：

# G4.

设 $ABCD$ 为一个四边形，其中 $AB$ 平行于 $CD$，且 $AB < CD$。直线 $AD$ 和 $BC$ 相交于点 $P$。在三角形 $ABC$ 的外接圆上取点 $X \neq C$，使得 $PC = PX$。在三角形 $ABD$ 的外接圆上取点 $Y \neq D$，使得 $PD = PY$。直线 $AX$ 和 $BY$ 相交于点 $Q$。

证明 $P Q$ 平行于 $A B$

解法1. 设 $M$ 和 $N$ 分别为 $AD$ 和 $BC$ 的中点，并设 $AB$ 的垂直平分线与过点 $P$ 且平行于 $AB$ 的直线相交于点 $R$：

引理. 三角形 $QAB$ 和三角形 $RNM$ 相似。

证明. 设 $O$ 为三角形 $A B C$ 的外心，且设 $S$ 为 $C X$ 的中点.由于 $N$ 、 $S$ 和 $R$ 分别是 $O$ 到 $B C$ 、 $C X$ 和 $P R$ 的垂足，因此四边形 $P R N O$ 和 $C N S O$ 是共圆的.此外，因为 $P C = P X$，所以 $P$ 、 $S$ 和 $O$ 共线.由于 $A B C X$ 也共圆，我们有

$$
\angle Q A B = \angle X C B = \angle P O N = 1 8 0 ^ { \circ } - \angle N R P = \angle M N R .
$$

同理，$\angle ABQ = \angle RMN$，因此三角形$QAB$和$RNM$相似。

![](images/11b357364548edbac5fcc75c140b530a05e6ae20e119a930bcdc5187d51d0d39.jpg)

令 $d ( Z , \ell )$ 表示从点 $Z$ 到直线 $\ell$ 的垂直距离。利用 $P R \parallel A B$ 以及相似三角形 $Q A B \sim R N M$ 和 $P A B \sim P M N$ ，我们有

$$
{ \frac { d ( Q , A B ) } { A B } } = { \frac { d ( R , M N ) } { M N } } = { \frac { d ( P , M N ) } { M N } } = { \frac { d ( P , A B ) } { A B } } ,
$$

这意味着 $PQ \parallel AB$

解法二。设 $BD$ 与 $AC$ 相交于点 $T$，再设过点 $P$ 且平行于 $AB$ 的直线与 $BD$ 相交于点 $V$。接下来，设 $Q^{\prime}$ 为从点 $T$ 到直线 $PV$ 的垂足。最后，设 $Q^{\prime}A$ 与圆 $ABC$ 再交于点 $X^{\prime}$，且 $Q^{\prime}B$ 与圆 $ABD$ 再交于点 $Y^{\prime}$：

![](images/dc33cd78add5c5283b7043f87c6531dbd64b0a3801bec9ac8885ca129cc664fd.jpg)

声明：$P Q ^ { \prime }$外平分$\angle B Q ^ { \prime } D$。

证明.
令 $P I ^ { \prime }$ 与 $\boldsymbol C \boldsymbol D$ 相交于点 $L$ .
令 $\mathcal { ( X ) } _ { C D }$ 为直线 $\boldsymbol C \boldsymbol D$ 上的无穷远点.
根据标准的塞瓦-梅涅劳斯构型，我们有 $( D , C ; L , \infty _ { C D } )$ 是调和的.
因此，通过 $P$ 点投影，我们有

$$
- 1 = ( D , C ; L , \infty _ { C D } ) = ( D , B ; T , V ) .
$$

因为 $( D , B ; T , V )$ 是调和的，并且根据作图，$\angle V Q ^ { \prime } T = 9 0 ^ { \circ }$，所以该命题得证。

现在当

$$
\angle Q ^ { \prime } P D = \angle B A D = 1 8 0 ^ { \circ } - \angle D Y ^ { \prime } B = 1 8 0 ^ { \circ } - \angle D Y ^ { \prime } Q ^ { \prime }
$$

我们有 $Q ^ { \prime } P D Y ^ { \prime }$ 四点共圆。根据该论断，可得 $P$ 是弧 ${ \widehat { D Q ^ { \prime } Y ^ { \prime } } }$ 的中点，因此 $P D = P Y ^ { \prime }$ ：

因为 $Y$ 是圆 $ABD$ 上不等于 $D$ 且满足 $PD = PY$ 的唯一点，所以我们有 $Y ^ { \prime } = Y$ ：

同样 $X ^ { \prime } = X$ s0 $Q ^ { \prime } = Q$ 证毕。

解法三。令AX与圆PCX第二次相交于点Q'。则

$$
\angle A Q ^ { \prime } P = \angle X Q ^ { \prime } P = \angle X C P = \angle X C B = 1 8 0 ^ { \circ } - \angle B A X = \angle Q ^ { \prime } A B
$$

S0 $P Q ^ { \prime }$ 平行于 $A B$ 。因此，只需证明 $Q ^ { \prime }$ 等于 $Q$ 。为此，我们旨在证明圆 $P C X$ 和圆 $P D Y$ 的公共弦平行于 $A B$ ，因为这样一来，根据对称性，$Q ^ { \prime }$ 也是 $B Y$ 和圆 $P D Y$ 的第二个交点：

![](images/04bba207109d7083f907f0877f57550484c45dac34d63da97197411b5fd9fba0.jpg)

设圆 $P C X$ 和 $P D Y$ 的圆心分别为 $O _ { X }$ 和 $O _ { Y }$。设圆 $A B C$ 和 $A B D$ 的圆心分别为 $\mathit { O } _ { C }$ 和 $O _ { D}$。

注意 $P$ ， $O _ { X }$ ，和 $\mathit { O } _ { C }$ 共线，因为它们都位于 $C X$ 的垂直平分线上：同理，$P$ ， $O _ { Y }$ ，和 $O _ { D }$ 在 $D Y$ 的垂直平分线上共线。通过考虑 $O _ { X }$ 和 $O _ { C }$ 在 $B C$ 上的投影，以及 $O _ { Y }$ 和 $O _ { D }$ 在 $A D$ 上的投影，我们有

$$
\frac { P O _ { X } } { P O _ { C } } = \frac { \frac { P C } { 2 } } { \frac { P B + P C } { 2 } } = \frac { \frac { P D } { 2 } } { \frac { P A + P D } { 2 } } = \frac { P O _ { Y } } { P O _ { D } } .
$$

因此 $O _ { X } O _ { Y }$ 平行于 $O _ { C } O _ { D }$，而 $O _ { C } O _ { D }$ 垂直于 $A B$，如所期望的。

# G5.

设 $ABC$ 为一个三角形，其内心为 $I$，并设 $\Omega$ 为三角形 $BIC$ 的外接圆：设 $K$ 为线段 $BC$ 内部的一点，使得 $\angle BAK < \angle KAC$。$\angle BKA$ 的角平分线与 $\Omega$ 相交于点 $W$ 和 $X$，使得 $A$ 和 $W$ 位于 $BC$ 的同一侧，且 $\angle CKA$ 的角平分线与 $\Omega$ 相交于点 $Y$ 和 $Z$，使得 $A$ 和 $Y$ 位于 $BC$ 的同一侧：

证明 $\angle W A Y = \angle Z A X$

(乌兹别克斯坦)

通用说明。每个解法的关键步骤是证明 $\angle Z A K = \angle I A Y$ 和 $\angle W A K = \angle I A X$ 。该问题可由这些等式推出，因为此时我们有

$$
\angle W A Y = \angle W A K + \angle K A I + \angle I A Y = \angle I A X + \angle K A I + \angle Z A K = \angle Z A X .
$$

![](images/c2f7f3fc98da4e8a0f00469c6aeb094c63837c8e52c21c66d90053647582b4ed.jpg)

我们现在给出几个证明，证明 $\angle Z A K = \angle I A Y$，而 $\angle W A K = \angle I A X$ 可通过类似方式随之得出。

解 1． 设 $\Gamma$ 为圆 $A B C$ 且 $\omega$ 为圆 $A Y Z$。设 $O$，$M$，和 $S$ 分别为 $\Gamma$，$\Omega$，和 $\omega$ 的中心。设 $A K$ 与 $\Gamma$ 再次相交于点 $P$，且设 $\angle Z A Y$ 的角平分线与 $\omega$ 再次相交于点 $N$：

![](images/6d89c295522adb6b5a6183d5efc5f64591ec643e8f1b4a36acb6d65ba39294df.jpg)

根据点K关于圆Γ和Ω的幂，我们有 $K A \cdot K P = K B \cdot K C = K Y \cdot K Z$ ，所以 $P$ 也在圆 $\omega$ 上。于是，Γ、Ω和ω两两之间的公共弦分别为 $AP \perp OS$，$BC \perp OM$，以及 $YZ \perp MS$，因此我们有 $\angle O M S = \angle C K Y = \angle Y K A = \angle M S O$。由于 $M$ 在圆 $\Gamma$ 上且 $O M = O S$，所以 $S$ 也在圆 $\Gamma$ 上。注意，由于 $N Y = N Z$，点 $N$ 在直线 $M S$ 上。

$$
\angle P A N = \frac { 1 } { 2 } \angle P S N = \frac { 1 } { 2 } \angle P S M = \frac { 1 } { 2 } \angle P A M .
$$

因此，$A N$ 不仅平分 $\angle Z A Y$，也平分 $\angle P A M$，这意味着 $\angle Z A K = \angle I A Y$，因为 $K$ 在 $A P$ 上，$I$ 在 $A M$ 上：

解法 2. 定义 $M$ 和 $P$ 如解法 1，并回顾 $AYPZ$ 共圆。令 $Q$ 为过点 $P$ 且平行于 $BC$ 的直线与圆 $ABC$ 的第二个交点，并令 $J$ 为三角形 $APQ$ 的内心。

![](images/d12bc7b8559be9fc4a6d2ce34c355a58bdaf919839f1b76744f822f46ef2b730.jpg)

因为 $PQ$ 平行于 $BC$ 并且 $\angle BAP < \angle PAC$，所以 $\angle APQ$ 的角平分线平行于 $\angle AKC$ 的角平分线。因此，$PJ$ 平行于 $YZ$。由于 $M$ 是圆 $APQ$ 上 $\hat{P}\hat{Q}$ 的中点，我们有 $MP = MJ$。然后，因为线段 $YZ$ 和 $PJ$ 平行，并且它们的垂直平分线有一个公共点 $M$，所以 $PJYZ$ 共圆，且 $JY = PZ$。由此可得，$J$ 也在圆 $AYPZ$ 上，并且 $\angle ZAP = \angle JAY = \angle IAY$：

注释。对于 $\angle W A K = \angle I A X$ 的类比情况的证明略有不同。在这种情况下，$J$ 应被定义为 $\triangle APQ$ 的 $A$-旁心，使得 $PJ$ 是 $\angle APQ$ 的外角平分线，且 $PJ \parallel WX$。证明的其余部分完全相同。

解法三。如同前面的解法，设 $M$ 为 $\Omega$ 的中心。设 $L$ 为 $A M$ 与 $B C$ 的交点，并设 $L ^ { \prime }$ 为 $L$ 关于 $Y Z$ 的对称点。设圆 $M Y Z$ 与 $A M$ 再次相交于点 $T$ ：

![](images/42f5fc9c9ca7d360812779e3a03f3611ebe0e4dfa3bb4d47260b7fdbe2184a6b.jpg)

注意到，因为M是圆ABC上弧BC的中点，且L是角BAC的平分线的足，我们有 $M A \cdot M L = M I ^ { 2 } = M Y ^ { 2 }$ . 根据幂的定理，可得MY与圆ALY相切，所以 $\angle L A Y = \angle L Y M$ . 利用有向角，我们于是有

$$
\measuredangle A Y T = \measuredangle M T Y - \measuredangle M A Y = \measuredangle M Z Y - \measuredangle L Y M = \measuredangle Z Y M - \measuredangle L Y M = \measuredangle Z Y L =
$$

在这里我们利用了 $MY = MZ$ 以及 $L$ 和 $L'$ 关于 $YZ$ 对称的事实。因此，在 $\angle AYZ$ 中，$YT$ 和 $YL'$ 是等角的。类似地，在 $\angle YZA$ 中，$ZT'$ 和 $ZL'$ 是等角的：这意味着在三角形 $AYZ$ 中，$T$ 和 $L'$ 是等角共轭点，这使得我们可以得出结论 $\angle ZAK = \angle IAY$，因为 $L'$ 在 $AK$ 上且 $T$ 在 $AI$ 上：

注.由于条件 $\angle B A K < \angle K A C$ ，点 $L ^ { \prime }$ 和 $T$ 位于三角形 $A Y Z$ 内部：然而，如果试图为 $\angle W A K = \angle I A X$ 写下相同的证明，$L ^ { \prime }$ 和 $T$ 的类似点 $L _ { 1 } ^ { \prime }$ 和 $T _ { 1 }$ 将位于三角形 $A W X$ 的外部。因此，该解法是使用有向角来写的，以便它也直接适用于这种情况。也有可能 $L _ { 1 } ^ { \prime }$ 位于圆 $A W X$ 上且 $T _ { 1 }$ 是一个无穷远点。在这种情况下，通过有向角追迹来证明等角性是直接的，并且等角性也可以从该情形是其他构形的极限情形这一事实得出。

注。原始提案指出，该问题是某个更普遍性质的一个特例：

一个凸四边形 $A B C D$ 内接于圆 $\omega$。$AC$ 与 $BD$ 的角平分线与 $\omega$ 相交于四点，构成一个凸四边形 $P Q R S$。则条件

$$
X A \cdot X C = X B \cdot X D \qquad { a n d } \qquad \measuredangle ( X P , X Q ) = \measuredangle ( X S , X R )
$$

在点$X$处等价。

题目选拔委员会认为，该推广性证明已超出竞赛范围，并认为原问题作为竞赛题更为合适。

# G6.

设 $ABC$ 为一个锐角三角形，且 $AB < AC$，设 $\Gamma$ 为 $ABC$ 的外接圆：点 $X$ 和 $Y$ 位于 $\Gamma$ 上，使得 $XY$ 与 $BC$ 相交于 $\angle BAC$ 的外角平分线上：假设 $\Gamma$ 在点 $X$ 和 $Y$ 处的切线相交于点 $T$，且 $T$ 与 $A$ 在 $BC$ 的同侧，且 $TX$ 和 $TY$ 分别与 $BC$ 相交于点 $U$ 和 $V$。设 $J$ 为三角形 $TUV$ 中与顶点 $T$ 相对的旁切圆的圆心。

求证 $A J$ 平分 $\angle B A C$

(波兰)

解法 1. 设 $N$ 为 $\Gamma$ 上 $\widehat { B A C }$ 的中点，且设 $NX$ 和 $NY$ 分别与 $BC$ 相交于点 $W$ 和 $Z$。
断言。四边形 $WXYZ$ 是圆内接四边形，且其外心为 $J$。
证明。由于 $N$ 是 $\widehat { B A C }$ 的中点，$W$ 和 $Z$ 位于 $BC$ 上，且 $X$ 和 $Y$ 分别是 $NW$ 和 $NZ$ 与 $\Gamma$ 的第二个交点，可得 $WXYZ$ 是圆内接四边形。

令过N的BC的平行线分别交XU和TV于U'和V'.则U'是Γ在点N和X处的切线的交点，所以U'N = U'X.由于NU' ∥ BC，三角形U'NX与三角形UWX相似，所以也有UW = UX.因此，WX的垂直平分线是∠XUW的内角平分线，即∠VUT的外角平分线.同理，YZ的垂直平分线是∠TVU的外角平分线.这意味着四边形WXYZ的外心是∠VUT和∠TVU的外角平分线的交点，即点J：□

![](images/bac8b7aaa7ce407a2791ea410f345ea3f3e68d255e00809c3d926af0f5d7467f.jpg)

设 $AN$ 与 $BC$ 相交于点 $L$，因此 $XY$ 也经过点 $L$。根据点 $L$ 关于 $\Gamma$ 和圆 $WXYZ$ 的幂，我们有 $LA \cdot LN = LX \cdot LY = LW \cdot LZ$，因此 $WANZ$ 也是圆内接四边形。因此，$A$ 是四边形 $WXYZ$ 的密克点。由于 $WXYZ$ 是一个以 $J$ 为外心的圆内接四边形，且其对边 $WX$ 和 $YZ$ 相交于点 $N$，我们有 $AN \perp AJ$。由于 $AN$ 是 $\angle BAC$ 的外角平分线，这意味着 $AJ$ 是 $\angle BAC$ 的内角平分线：

解二. 设$\angle B A C$的内角平分线和外角平分线分别与$B C$相交于点$K$和$L$. 设$A K$与圆$A B C$再次相交于点$M$，并设$D$为$\Gamma$在点$B$和$C$处的切线的交点. 设$\Omega$为三角形$T U V$的$T$-旁切圆，并设$\omega$为三角形$D B C$的内切圆： 断言. 点$T$、$K$和$\boldsymbol { D }$共线。

证明.
注意到 $BC$ 和 $XY$ 分别是点 $T$ 和点 $D$ 关于圆 $\Gamma$ 的极线.根据拉伊尔定理，$TD$ 是点 $L$ 关于圆 $\Gamma$ 的极线.由于 $(B, C; K, L) = -1$，点 $K$ 也位于 $L$ 的极线上，从而证明了共线性. □

断言. $DBC$的内心是$M$

证明. $\angle M B C = \angle M A C = \textstyle { \frac { 1 } { 2 } } \angle B A C = \textstyle { \frac { 1 } { 2 } } \angle D B C$ ，因此 $B M$ 平分 $\angle D B C$ ： 同理，$C M$ 平分 $\angle B C D$ ， 因此 $M$ 是 $D B C$ 的内心 ： □

![](images/02fa6f334d9894eef0e481161162fda0b2e38302fcf2235f2000776812d25a63.jpg)

命题. $\Omega$ 和 $\omega$ 的公共外切线的交点是 $K$ ：

证明. 设 $K ^ { \prime }$ 为 $\Omega$ 和 $\omega$ 的公外切线的交点。由于 $\Omega$ 和 $\omega$ 都与 $BC$ 相切，且位于 $BC$ 的与 $A$ 相对的一侧，因此 $K ^ { \prime }$ 位于 $BC$ 上。由于 $T$ 是 $\Gamma$ 和 $\Omega$ 的公外切线的交点，$D$ 是 $\Gamma$ 和 $\omega$ 的公外切线的交点，根据蒙日定理，$K ^ { \prime }$ 位于 $TD$ 上。由于 $K ^ { \prime }$ 同时位于 $BC$ 和 $TD$ 上，因此它与 $K$ 是同一点：□

因此，$K$与$\Omega$和$\omega$的中心共线，这两个中心分别是$M$和$J$。由于$K$和$M$都位于$\angle BAC$的角平分线上，所以$J$也位于其上：

注。可以证明圆 $A U V$ 和圆 $A B C$ 相切，并且从 $U$ 和 $V$ 到圆 $A B C$ 的不同于 $TU$ 和 $TV$ 的切线相交于直线 $^ { \prime } i \kappa$ 上的一点 $W$。利用这些性质，将问题重新表述为关于四边形 $T U W V$ 的问题，我们得到以下问题：

设 ABCD 为一个具有内切圆 $\omega$ 的凸四边形，且令 $AC$ 和 $BD$ 相交于点 $P$。点 $E$ 位于 $\omega$ 上，使得 $ACE$ 的外接圆与 $\omega$ 相切。证明：如果 $B$ 和 $E$ 位于直线 $AC$ 的同侧，那么三角形 $ABC$ 在顶点 $B$ 处的旁心位于直线 $EP$ 上。

虽然这个说法很有吸引力，但选题委员会对其难度以及是否存在不通过化归到原问题的解法尚不确定。因此，委员会认为原命题更适合这次竞赛。

# G7.

设 $ABC$ 为一个三角形，其内心为 $I$，且满足 $AB < AC < BC$。直线 $AI$、$BI$ 和 $CI$ 与三角形 $ABC$ 的外接圆的第二个交点分别为 $M_A$、$M_B$ 和 $M_C$。直线 $AI$ 与 $BC$ 相交于点 $D$，直线 $BM_C$ 与 $CM_B$ 相交于点 $X$。设三角形 $XM_BM_C$ 和 $XBC$ 的外接圆再次相交于点 $S$（$S \neq X$）。直线 $BX$ 和 $CX$ 分别与三角形 $SXM_A$ 的外接圆再次相交于点 $P$（$P \neq X$）和 $Q$（$Q \neq X$）。

证明三角形 $S I D$ 的外心位于 $P Q$ 上。

解决方案 1.

![](images/d1920bb27ade8bb31b4f56458ddfd415d0aecd1d19f3d7e2c89f69cade0dd9a5.jpg)

设 $O$ 为 $\triangle ABC$ 的外心。 首先，根据Miquel点 $S$ 的标准性质，我们有：

： $\triangle S M _ { C } M _ { B } \sim \triangle S B C \sim \triangle S P Q ; ~ ( *$ ）· 点 $I$ 和点 $S$ 关于圆 $A B C$ 互为反演点 ：，： $\angle O S X = 9 0 ^ { \circ }$ ：

命题 1. $\angle M_{A}PB = \angle CDA$

证明。由上我们有 $\triangle O M _ { A } I \sim \triangle O S M _ { A }$ 且

$$
\angle M _ { A } P B = \angle M _ { A } P X = \angle M _ { A } S X = 9 0 ^ { \circ } + \angle M _ { A } S O = 9 0 ^ { \circ } + \angle O M _ { A } I = \angle M _ { A } B A = 9 0 ^ { \circ }
$$

断言 2. $\begin{array} { r } { { \frac { M _ { C } B } { B P } } = { \frac { M _ { B } C } { C Q } } = { \frac { A I } { I D } } } \end{array}$

证明.观察到 $\angle P M _ { C } M _ { A } = \angle B M _ { C } M _ { A } = \angle D A C$ 并且 $\angle M _ { C } M _ { A } B = \angle I C D$ .将这些与引理1结合可得 $M _ { C } P M _ { A } B \sim A D C I$ .因此， $\begin{array} { r } { \frac { M _ { C } B } { B P } = \frac { A I } { I D } } \end{array}$ .同理， $\begin{array} { r } { { \frac { M _ { B } C } { C Q } } = { \frac { A I } { I D } } } \end{array}$ ： □

声明 3.
$\begin{array} { r } { { \frac { D P } { D Q } } = { \frac { I B } { I C } } } \end{array}$

证明.首先，观察到$\angle I C B = \angle A M _ { B } M _ { C }$且$\angle C B I = \angle M _ { B } M _ { C } A$，这表明$\triangle I B C \sim \triangle A M _ { C } M _ { B }$。这一点，结合引理2，足以证明$\triangle D P Q \sim \triangle I B C$，通过线性性，从而证明了该引理。□

断言 4. $\begin{array} { r } { { \frac { I P } { I Q } } = { \frac { I B } { I C } } } \end{array}$

证明. 结合 $\triangle I B M _ { C } \sim \triangle I C M _ { B }$ 与引理2，表明 $I B M _ { C } P \sim I C M _ { B } Q$，从而得到结论. □

最后，我们有

$$
{ \frac { S P } { S Q } } = { \frac { S B } { S C } } = { \frac { B M _ { C } } { C M _ { B } } } = { \frac { I B } { I C } }
$$

根据$( * )$和$\triangle I B M _ { C } \sim \triangle I C M _ { B }$。将此与论断3和论断4结合，我们得到

$$
{ \frac { I B } { I C } } = { \frac { D P } { D Q } } = { \frac { I P } { I Q } } = { \frac { S P } { S Q } } ,
$$

这表明圆 $SID$ 是关于点 $P$ 和 $Q$ 的阿波罗尼斯圆，从而得出所期望的结论。

注释.
条件 $A B < A C$ 确保 $S \ne X$ 。
我们还需要避免 $\angle B A C = 6 0 ^ { \circ }$ 的情况，因为此时 $B M _ { C } \parallel C M _ { B }$ ：

解法二。我们使用解法一中的引理1。我们将证明 $P$ 和 $Q$ 是关于圆 $SID$ 的反演点，由此可得结论。对圆 $BIC$ 做反演变换，并将点 $\bullet$ 的反演点记为 $\bullet ^ { \prime }$ ：

![](images/16e666732363c77460a4d14563f22c7cecb7b035b6df406bebc1d3872e84b03c.jpg)  
Claim 1. $S ^ { \prime } = J$ where $J$ is the reflection of $I$ across $B C$ ：

证明. 我们有 $S$ 和 $I$ 关于圆 $ABC$ 互为反演. 将此断言关于圆 $BIC$ 进行反演，表明 $S^{\prime}$ 和 $I$ 关于直线 $BC$ 互为反演，即关于直线 $BC$ 的反射.

令 $Y = M _ { B } M _ { C } \cap B C$ 。由 $\angle I M _ { C } M _ { B } = \angle M _ { B } M _ { C } A$ 和 $\angle A M _ { B } M _ { C } = \angle M _ { C } M _ { B } I$ ， 可知点 $A$ 和点 $I$ 关于直线 $M _ { B } M _ { C }$ 对称， 所以 $Y A = Y I$ 。我们有圆 $S I D$ 映射到圆 $A I J$， 根据前述评论，该圆的圆心为 $Y$。在圆 $B I C$ 中反演“$P$ 和 $Q$ 是关于圆 $S I D$ 的反演点”这一结论，只需证明 $P ^ { \prime }$ 和 $Q ^ { \prime }$ 是关于圆 $A I J$ 的反演点，或等价地，证明 $Y P ^ { \prime } \cdot Y Q ^ { \prime } = Y A ^ { 2}$：

断言 $\mathcal{Z}$：圆 $XSM_A$ 在关于圆 $BIC$ 的反演下映射到直线 $YJ$。

证明. 因为圆 $B I C$ 以 $M _ { A }$ 为圆心，所以这个圆的反演是一条直线.根据引理1，这条直线经过点 $J$，因此只需证明圆 $X S M _ { A }$ 经过点 $Y ^ { \prime }$ 即可.将直线 $B C$ 关于圆 $B I C$ 进行反演，可得 $B C M _ { A } Y ^ { \prime }$ 四点共圆，所以

$$
Y S \cdot Y X = Y B \cdot Y C = Y Y ^ { \prime } \cdot Y M _ { A } .
$$

这里我们利用了 Miquel 点的一个标准性质，即 Y、S 和 X 三点共线。 因此，Y' 点位于圆 XSM_A 上，得证。 □

令 $A _ { 1 }$ 为 A 关于 BC 的垂直平分线的反射。利用解法1中的命题1，

$$
\angle P ^ { \prime } B M _ { A } = \angle M _ { A } P B = \angle C D A = 1 8 0 ^ { \circ } - \angle A C M _ { A } = 1 8 0 ^ { \circ } - \angle M _ { A } B A _ { 1 } .
$$

因此，$P ^ { \prime }$、$B$ 和 $A _ { 1 }$ 共线。同样地，$Q ^ { \prime }$、$C$ 和 $A _ { 1 }$ 共线。设 $P _ { 1 }$ 和 $Q _ { 1 }$ 分别是 $P ^ { \prime }$ 和 $Q ^ { \prime }$ 关于直线 $B C$ 的反射点。由于 $P ^ { \prime }$ 和 $Q ^ { \prime }$ 位于直线 $Y J$ 上，因此 $P _ { 1 }$ 和 $Q _ { 1 }$ 位于直线 $Y I$ 上。此外，根据之前的共线性，我们得到 $B P _ { 1 } \parallel A C$ 和 $C Q _ { 1 } \parallel A B$：

我们现在已将问题简化如下：

命题 $\mathcal { J }$（倒置问题）。设 $A B C$ 为一个三角形，其内心为 $I$。设 $Y$ 为 $B C$ 上的一点，使得 $Y A = Y I$。设 $P _ { 1 }$ 和 $Q _ { 1 }$ 为 $Y I$ 上的点，使得 $B P _ { 1 }$ 平行于 $A C$ 且 $C Q _ { 1 }$ 平行于 $A B$：则 $Y A ^ { 2 } = Y P _ { 1 } \cdot Y Q _ { 1 }$：

![](images/23c0a7e6b42d7071ede63cd6a533833ed06d48ecf0ba6097030360027d1aaf80.jpg)

证明. 令 $YI$ 分别与 $AB$ 和 $AC$ 相交于点 $E$ 和 $F$。由平行线可得，$\triangle BEP_1$ 和 $\triangle CQ_1F$ 关于中心 $Y$ 位似。因此，

$$
\frac { Y E } { Y P _ { 1 } } = \frac { Y Q _ { 1 } } { Y F } \implies Y P _ { 1 } \cdot Y Q _ { 1 } = Y E \cdot Y F .
$$

此外，$AI$ 平分 $\angle EAF$ 且 $YA = YI$，所以以 $Y$ 为圆心、$YA$ 为半径的圆是 $\triangle AEF$ 关于顶点 $A$ 的内外角平分线足的阿波罗尼奥斯圆。这意味着 $YE \cdot YF = YA^2$。结合这些结果，命题得证。□

解法3.与解法1相同，设 $O$ 为 $\triangle ABC$ 的外心。设 $XI$ 与圆 $XSM_A$ 再次相交于点 $Z \neq X$，并设 $Y = BC \cap M_B M_C$。设 $X^*$ 为 $X$ 关于圆 $ABC$ 的反演点。我们将使用解法1开头提到的Miquel点 $S$ 的性质，此外，$S$ 位于直线 $XY$ 上：

![](images/859f770e96b56aae7200d7829edd7acf990684544d4f4f54c8dce6058ad62b68.jpg)

断言 1. $Y S A D$ 是共圆的.

证明.
由 $O M _ { A } \bot B C$ 和 $Y S \bot O S$，我们有 $\angle D Y S = 1 8 0 ^ { \circ } - \angle S O M _ { A }$。
由在圆 $A B C$ 中反演共线点 $A$、$I$ 和 $M _ { A }$，我们得到 $A S M _ { A } O$ 四点共圆，由此可得

$$
\angle S O M _ { A } = \angle S A M _ { A } = \angle S A D \implies \angle S A M _ { B }
$$

证明该主张

断言 2. $X ^ { * }$ 位于圆 $BIC$ 上，其圆心为 $M _ { A }$ ： 证明. 这可由在圆 $ABC$ 中对圆 $SBCX$ 进行反演立即得出。

断言3. $Z$ 位于圆 $S I D$ 上： 证明。 我们有

$$
I Z S = \angle X M _ { A } S = \angle O M _ { A } S - \angle O M _ { A } X = \angle M _ { A } I O - \angle M _ { A } X ^ { * } O = \angle D I O - \angle M _ { A } R
$$

其中在倒数第二步中，我们在圆ABC上作反演以得到角度相等。

根据布洛卡定理应用于圆内接四边形 $B M _ { C } M _ { B } C$，可得 $Y$ ， $I$ ，和 $X ^ { * }$ 共线，且 $\angle Y X ^ { * } O = 9 0 ^ { \circ }$。由此可得

$$
\angle M _ { A } X ^ { * } { \cal O } = 9 0 ^ { \circ } - \angle I X ^ { * } M _ { A } = 9 0 ^ { \circ } - \angle M _ { A } I X ^ { * } = 9 0 ^ { \circ } - \angle A I Y ,
$$

其中第二个等式是根据引理2。 我们有，点A和点I关于直线 $M_B M_C$ 对称： 因此，

$$
9 0 ^ { \circ } - \angle A I Y = 9 0 ^ { \circ } - \angle Y A D = 9 0 ^ { \circ } - \angle Y S D = \angle D S O
$$

其中第二步由《Claim 1》得出，最后一步我们使用了OS⊥YS。综上，

$$
\angle I Z S = \angle D I O - \angle D S O = \angle I D S ,
$$

证明该主张

设从点S和点Z到圆 $X S M _ { A }$ 的切线相交于点K。根据标准的Ceva-Menelaus构型，

$$
\begin{array} { r } { - 1 = \left( X Y , X I ; X B , X C \right) \stackrel { X } { = } \left( S , Z ; P , Q \right) . } \end{array}
$$

这表明点$K$位于直线$P Q$上。于是我们得到

$$
\angle Z K S = 1 8 0 ^ { \circ } - 2 \angle S X Z = 2 \left( 9 0 ^ { \circ } - \angle S X I \right) = 2 \left( 1 8 0 ^ { \circ } - \angle S I Z \right) ,
$$

这里我们使用 $\angle I S X = 9 0 ^ { \circ }$ 。由于 $K$ 位于 $S Z$ 的垂直平分线上，这足以证明 $K$ 是圆 $S I D Z$ 的圆心，这就完成了证明。

解决方案 4.解决方案 1 通过建立 $\begin{array} { r } { { \frac { S P } { S Q } } = { \frac { I P } { I Q } } = { \frac { D P } { D Q } } } \end{array}$ 来解决问题，这意味着圆 $S I D$ 是关于点 $P$ 和 $Q$ 的阿波罗尼奥斯圆。我们展示一种替代方法，该方法只需要我们证明三个比例 $\frac { S P } { S Q }$ 、$\textstyle { \frac { I P } { I Q } }$ 和 $\frac { D P } { D Q }$ 中的两个相等即可。这种情况可能是由于遗漏了解决方案 1 中的一些观察结果，例如没有证明引理 3。

断言. 鉴于我们已经证明了上面列出的两个比例相等，只需证明圆 $SID$ 与圆 $SXM_A$ 正交，即圆 $SPQ$.

证明. 假设我们已经证明了正交性，如果 $\begin{array} { r } { { \frac { S P } { S Q } } = { \frac { I P } { I Q } } } \end{array}$ 或 $\begin{array} { r } { { \frac { S P } { S Q } } = { \frac { D P } { D Q } } } \end{array}$ ，那么我们立刻可以得到圆 $S I D$ 是关于点 $P$ 和 $Q$ 的阿波罗尼奥斯圆。如果 $\begin{array} { r } { { \frac { I P } { I Q } } = { \frac { D P } { D Q } } } \end{array}$ 且点 $S$ 不在由这个公共比定义的阿波罗尼奥斯圆 $c$ 上，那么 $I$ 和 $D$ 位于两个与圆 $S P Q$ 正交的不同圆上，即圆 $S I D$ 和圆 $c$ 。这意味着 $I$ 和 $\boldsymbol { D }$ 关于圆 $S P Q$ 互为反演点，这是一个矛盾，因为 $I$ 和 $D$ 都位于圆 $S P Q$ 内部 □

在本解答中，我们将使用解答一开头部分$S$的性质。如前述解答中定义$O$和$Y$，并令$E$为圆$S O M _ { A }$和圆$S M _ { B } M _ { C }$的第二个交点：

![](images/7c0c995ef65808cefc1918722b6733327fe663e17816f6416d068853d2f0dd2b.jpg)

引理. 有 $O E \bot A Y$

证明. 令 $M _ { A } ^ { \prime }$、$B ^ { \prime }$ 和 $C ^ { \prime }$ 分别是 $M _ { A }$、$B$ 和 $C$ 关于直线 $M _ { B } M _ { C }$ 的反射：如解法3中所述，$A$ 和 $I$ 关于 $M _ { B } M _ { C }$ 互为反射.因为 $M _ { A }$ 是圆 $B I C$ 的圆心，所以 $M _ { A } ^ { \prime }$ 是圆 $A B ^ { \prime } C ^ { \prime }$ 的圆心.另一方面，$Y$ 在直线 $M _ { B } M _ { C }$ 上，因此我们有 $Y B \cdot Y C = Y B ^ { \prime } \cdot Y C ^ { \prime }$.因此，$Y$ 在圆 $A B C$ 和圆 $A B ^ { \prime } C ^ { \prime }$ 的根轴上，所以 $O M _ { A } ^ { \prime } \perp A Y$.最后，注意到圆 $S O M _ { A }$ 和圆 $S M _ { B } M _ { C }$ 关于圆 $A B C$ 的反演分别是直线 $I M _ { A }$ 和圆 $I M _ { B } M _ { C }$，所以 $E$ 和 $M _ { A } ^ { \prime }$ 关于圆 $A B C$ 互为反演.因此，$E$ 在直线 $O M _ { A } ^ { \prime }$ 上，引理得证. □

令 $\tau$ 表示以 $S$ 为中心、半径为 $\sqrt { S I \cdot S O }$ 的反演与关于直线 $S I$ 的反射的复合。根据 Miquel 点的标准性质，$\tau$ 交换 $X$ 和 $Y$，以及圆 $A B C$ 上满足 $I \in Z _ { 1 } Z _ { 2 }$ 的任意点 $Z _ { 1 }$ 和 $Z _ { 2 }$。因此，$\tau$ 交换点对 $( A , M _ { A } )$ ， $( B , M _ { B } )$ ， $( C , M _ { C } )$ ， $( O , I )$ 和 $( X , Y )$。由于 $D = A I \cap B C$ 且 $E$ 是圆 $S O M _ { A }$ 和圆 $S M _ { B } M _ { C }$ 的交点，我们有 $\tau ( D ) = E$。因此，$\tau$ 将圆 $S I D$ 和圆 $S X M _ { A }$ 分别映射到直线 $O E$ 和直线 $A Y$ ，所以根据引理，圆 $S I D$ 和圆 $S X M _ { A }$ 正交，如所求。

![](images/55f819d24c11bf83c5ffb2126a1a6f8b7dd69f8b49925493e7895c3b47a6f762.jpg)

# G8.

设 $ABC$ 为一个满足 $AB < AC < BC$ 的三角形，且设 $D$ 为线段 $BC$ 内部的一点。设 $E$ 为三角形 $ABC$ 外接圆上的一点，使得 $A$ 和 $E$ 位于直线 $BC$ 的两侧，且 $\angle BAD = \angle EAC$。设 $I$ , $I_B$ , $I_C$ , $J_B$ , 和 $J_C$ 分别为三角形 $ABC$ , $ABD$ , $ADC$ , $ABE$ , 和 $AEC$ 的内心。

证明 $I _ { B }$ ， $I _ { C }$ ， $J _ { B }$ 和 $J _ { C }$ 共圆当且仅当 $A I$ ， $I _ { B } J _ { C }$ 和 $J _ { B } I _ { C }$ 共点。

(加拿大)

解 1． 设 $X$ 为 $I _ { B } J _ { C }$ 和 $J _ { B } I _ { C }$ 的交点。我们将证明，在 $A B < A C < B C$ 的条件下，以下两个条件是等价的：

(1) AX平分∠BAC
(2) I_B、I_C、J_B和J_C共圆

设圆 $AIB$ 和 $AIC$ 分别与 $BC$ 再次相交于点 $P$ 和 $Q$。注意到 $AB = BQ$ 且 $AC = CP$，因为圆 $AIB$ 和 $AIC$ 的圆心分别位于 $\zeta I$ 和 $BI$ 上。因此，点 $B$、$P$、$Q$ 和 $C$ 按此顺序共线，因为 $BQ + PC = AB + AC > BC$（根据三角不等式）。

命题 1. 点 $P$、$J_{B}$ 和 $I_{C}$ 共线，且点 $Q$、$I_{B}$ 和 $J_{C}$ 共线。证明。我们有

$$
\angle A J _ { B } B = 9 0 ^ { \circ } + \frac { 1 } { 2 } \angle A E B = 9 0 ^ { \circ } + \frac { 1 } { 2 } \angle A C B = \angle A I B = \angle A P B ,
$$

$A B J _ { B } P$ 共圆。由于A是△ABE与△ADC的螺旋相似中心，故A亦是△$AB J_{B}$与△$AD I_{C}$的螺旋相似中心。因此，A是自交四边形$BD I_{C} J_{B}$的密克点，所以P在$J_{B}I_{C}$上。同理，Q在$I_{B}J_{C}$上：□

![](images/e5e096a66e7e788008c71b86cc53ad7ea2d0d8e13a8d1fc110c6da2289813e90.jpg)

在解决方案的其余部分，我们将使用有向角。

证明：$( 1 ) \implies$ (2). 假设 (1) 成立. 由断言 1 及相似关系 $A B D I _ { B } \sim A E C J _ { C }$ 与 $A B E J _ { B } \sim A D C I _ { C }$ 可知

$$
{ } _ { B } X I _ { C } = \measuredangle J _ { C } Q C + \measuredangle B P J _ { B } = \measuredangle J _ { C } A C + \measuredangle B A J _ { B } = \measuredangle I _ { B } A D + \measuredangle D A I _ { C } = \measuredangle I _ { B } A I _ { C } .
$$

S0 $A I _ { B } X I _ { C }$ 是循环的。此外，由于 $X \in A I$ ，我们有

$$
\measuredangle I _ { B } A X = \measuredangle B A I - \measuredangle B A I _ { B } = \measuredangle I _ { B } A I _ { C } - \measuredangle I B _ { A } D = \measuredangle D A I _ { C } .
$$

由此可得，

$$
\measuredangle I _ { B } I _ { C } P = \measuredangle I _ { B } A X = \measuredangle D A I _ { C } = \measuredangle B A J _ { B } = \measuredangle B P J _ { B } ,
$$

s0 I_B I_C 平行于 BC。因此，

$$
\rlap / { 4 } I _ { B } I _ { C } J _ { B } = \rlap / { 4 } B P J _ { B } = \rlap / { 4 } B I J _ { B } = \rlap / { 4 } I _ { B } I J _ { B } ,
$$

所以 $I I _ { B } J _ { B } I _ { C }$ 共圆。同理，$I I _ { C } J _ { C } I _ { B }$ 共圆，所以 $I _ { B } J _ { B } J _ { C } I _ { C }$ 共圆，从而证明了 (2)。 □

$( 2 ) \implies ( 1 )$ 的证明。我们假设 (2) 成立。断言 $\mathcal { Z }$ 。圆 $I B C$ 、 $I J _ { B } I _ { C }$ 和 $I I _ { B } J _ { C }$ 在点 $I$ 处相切。证明。利用圆内接四边形 $B I J _ { B } P$ ，我们有

$$
\measuredangle I B C = \measuredangle I B P = \measuredangle I J _ { B } P = \measuredangle I J _ { B } I _ { C } .
$$

由于 $C$ 、 $I _ { C }$ 和 $I$ 共线，圆 $I J _ { B } I _ { C }$ 和圆 $I B C$ 在点 $I$ 处的切线重合，因此，圆 $I J _ { B } I _ { C }$ 和圆 $I B C$ 在点 $I$ 处相切。同理，圆 $I I _ { B } J _ { C }$ 和圆 $I B C$ 在点 $I$ 处相切，因此，这三个圆都在点 $I$ 处相切： □

断言 3.
点 $I$ 位于圆 $I _ { B } J _ { B } J _ { C } I _ { C }$ 上。

证明.
假设 $I$ 不在圆 $I _ { B } J _ { B } J _ { C } I _ { C }$ 上.
那么圆 $I I _ { B } J _ { C }$ ， $I J _ { B } I _ { C }$ 和 $I _ { B } J _ { B } J _ { C } I _ { C }$ 是不同的.
我们对这三个圆应用根轴定理.
根据引理2，圆 $I I _ { B } J _ { C }$ 和 $I J _ { B } I _ { C }$ 的根轴是圆 $I B C$ 在点 $I$ 处的切线
由于 $I _ { B } J _ { C }$ 和 $J _ { B } I _ { C }$ 相交于 $X$ ， $I X$ 必为圆 $I B C$ 的切线：

然而，根据引理1，我们有 $X$ 是 $P I _ { C }$ 和 $Q I _ { B }$ 的交点。由于 $\boldsymbol { D }$ 位于线段 $B C$ 的内部，$I _ { B }$ 位于线段 $B I$ 的内部，且 $I _ { C }$ 位于线段 $\zeta I$ 的内部。因此，$I _ { B }$ 、 $P$ 、 $Q$ 和 $I _ { C }$ 按此顺序都位于三角形 $I B C$ 的周长上，所以 $X$ 必须在三角形 $I B C$ 的内部。这意味着 $I X$ 不能与圆 $B I C$ 相切，所以 $I$ 必须在圆 $I _ { B } J _ { B } J _ { C } I _ { C }$ 上： □

根据断言 2 和 3，圆 $I I _ { B } I _ { C }$ 与 $I B C$ 相切，因此 $I _ { B } I _ { C } \parallel B C$ 。由于 $I _ { B } J _ { B } J _ { C } I _ { C }$ 共圆，可得

$$
I _ { C } J _ { B } J _ { C } = \measuredangle I _ { C } I _ { B } J _ { C } = \measuredangle P Q I _ { B } = \measuredangle P Q J _ { C }
$$

s0 $P J _ { B } J _ { C } Q$ 共圆。根据圆 $A I P J _ { B }$ ， $A I Q J _ { C }$ 和 $P J _ { B } J _ { C } Q$ 的根轴定理，我们得到 $A I$ ， $I _ { B } J _ { C }$ 和 $J _ { B } I _ { C }$ 共点于 $X$ ，从而证明了 (1)。

解法二. 令 $X$ 为 $I _ { B } J _ { C }$ 和 $J _ { B } I _ { C }$ 的交点. 与解法一类似，我们将证明条件 (1） 和 (2） 是等价的. 为此，我们引入新的条件：

(3)

并且证明(3)同时等价于(1)和(2)，在$A B < A C < B C$的条件下

注意 $A B D \stackrel { + } { \sim } A E C$ 和 $A B E \stackrel { + } { \sim } A D C$ ，其中 ${ ^ \downarrow }$ 表示正相似性。我们将利用以下事实。

事实。对于点 $P$ ， $P _ { 1 }$ ， $P _ { 2 }$ ， $P _ { 3 }$ 与 $P _ { 4 }$ ，其正相似性

$$
P P _ { 1 } P _ { 2 } \stackrel { + } { \sim } P P _ { 3 } P _ { 4 } \quad \mathrm { a n d } \quad P P _ { 1 } P _ { 3 } \stackrel { + } { \sim } P P _ { 2 } P _ { 4 }
$$

等价

$( 1 ) \iff (3)$ 的证明。设 $A I _ { B }$ 和 $A I _ { C }$ 分别与 $B C$ 交于点 $S$ 和 $T$，设 $A J _ { B }$ 与 $B E$ 交于点 $K$，$A J _ { C }$ 与 $C E$ 交于点 $L$，且 $K T$ 与 $S L$ 交于点 $Y$：

![](images/202258657adabc50c052357b7a85ecccf9778eeac419eb56ac982ff01323a41a.jpg)

命题 1. 直线 AY 平分角 BAC：

证明. 令 $Y ^ { \prime }$ 为 $K T$ 与 $\angle B A C$ 的角平分线的交点，由于

$$
\angle B A K = \frac { 1 } { 2 } \angle B A E = \frac { 1 } { 2 } \angle D A C = \angle T A C ,
$$

$A Y ^ { \prime }$ 也平分 $\angle K A T$ .因此，$Y ^ { \prime }$ 是三角形 AKT 中 $\angle K A T$ 的平分线的垂足。根据该事实，我们得到

$$
\begin{array} { r l } { A B E \stackrel { + } { \sim } A D C \implies A B E K \stackrel { + } { \sim } A D C T } \\ { \implies A B D \stackrel { + } { \sim } A K T \stackrel { + } { \sim } A E C } \\ { \implies A B D S \stackrel { + } { \sim } A K T Y ^ { \prime } \stackrel { + } { \sim } A E C L } \\ { \implies A B E K \stackrel { + } { \sim } A S L Y ^ { \prime } \stackrel { + } { \sim } A D C T . } \end{array}
$$

因为 $K$ 在 $B E$ 上，所以 $Y ^ { \prime }$ 在 $S L$ 上，因此 $Y = Y ^ { \prime }$ 且 $A Y$ 平分 $\angle B A C$

我们证明$X$位于$A Y$上当且仅当$I _ { B } I _ { C } \parallel B C$，这意味着$A Y$ $I _ { B } J _ { C }$ l， $J _ { B } I _ { C }$ $X _ { 1 }$ d． $X _ { 2 }$ $A B D$ $A E C$ $\begin{array} { r } { { \frac { A I _ { B } } { A S } } \ = \ { \frac { A J _ { C } } { A L } } } \end{array}$ $I _ { B } J _ { C } \parallel S L$ $J _ { B } I _ { C } \parallel K T$ 等价。因此，$X _ { 1 }$和$X _ { 2 }$与$X$重合当且仅当

$$
{ \frac { A I _ { B } } { A S } } = { \frac { A X _ { 1 } } { A Y } } = { \frac { A X _ { 2 } } { A Y } } = { \frac { A I _ { C } } { A T } } ,
$$

即 $I _ { B } I _ { C } \parallel B C$

(2) $\iff$ (3)的证明
设$A J _ { B }$和$A J _ { C }$分别与圆$A B C$相交于点$M$和$N$，且设$I _ { B } ^ { \prime }$和$I _ { C } ^ { \prime }$分别为三角形$ABD$和$ADC$的$A$-旁心。

![](images/5f53537236cce1d0f53c877c158b8ba14399969c54c2b95f21c063578b776247.jpg)

命题 2. 直线 $I_B I_C$、$I_B' I_C'$ 和 $BC$ 共点或两两平行。

证明.
我们在射影平面中工作.
令 $I _ { B } I _ { C }$ 和 $I _ { B } ^ { \prime } I _ { C } ^ { \prime }$ 分别与 $B C$ 相交于点 $Z$ 和 $Z ^ { \prime }$ .
注意到 $Z$ 是三角形 $A B D$ 和 $A D C$ 的内切圆的外公切线的交点，且 $A D$ 是三角形 $A B D$ 和 $A D C$ 的内切圆的一条内公切线，所以 $( A D , A Z ; A I _ { B } , A I _ { C } ) = - 1$ .
将同样的论证应用于三角形 $A B D$ 和 $A D C$ 的 A-旁切圆，可得 $( A D , A Z ^ { \prime } ; A I _ { B } ^ { \prime } , A I _ { C } ^ { \prime } ) = - 1$ ，这意味着 $Z = Z ^ { \prime }$ .
因此，$I _ { B } I _ { C }$ ， $I _ { B } ^ { \prime } I _ { C } ^ { \prime }$ 和 $B C$ 三线共点，该点可能在无穷远处.
□

![](images/5bdbaea924da6242bec1c3dceadee2bdd2632a69e146abc33df82dfd2d22fffb.jpg)

断言 3. 直线 $J _ { B } I _ { C }$ 与 $C M$ 是平行的，且直线 $I _ { B } J _ { C }$ 与 $B N$ 是平行的。证明。利用该事实，我们有

$$
A B E \stackrel { + } { \sim } A D C \implies A B E J _ { B } \stackrel { + } { \sim } A D C I _ { C } \implies A J _ { B } I _ { C } \stackrel { + } { \sim } A B D .
$$

因此, $\angle ( B D , J _ { B } I _ { C } ) = \angle B A J _ { B } = \angle B C M$ , 所以 $J _ { B } I _ { C } \parallel C M$ . 同理, $I _ { B } J _ { C } \parallel B N$

命题 4. $J _ { B } J _ { C }$ 与 $I _ { B } ^ { \prime } I _ { C } ^ { \prime }$ 的螺旋相似中心为 $A$。

证明. 由于 $I _ { B }$ 和 $I _ { B } ^ { \prime }$ 分别是三角形 $A B D$ 的内心和 $A$-旁心，我们有 $A B I _ { B } ^ { \prime } \stackrel { + } { \sim } A I _ { B } D$。利用相似性 $A B D \stackrel { + } { \sim } A E C$，这意味着 $A B I _ { B } ^ { \prime } \stackrel { + } { \sim } A J _ { C } C$，所以 $A B \cdot A C = A I _ { B } ^ { \prime } \cdot A J _ { C }$ 且 $\angle B A I _ { B } ^ { \prime } = \angle J _ { C } A C$。同理，我们有 $A B \cdot A C = A J _ { B } \cdot A I _ { C } ^ { \prime }$ 和 $\angle B A J _ { B } = \angle I _ { C } ^ { \prime } A C$。综合起来，这意味着 $A I _ { B } ^ { \prime } { \cdot } A J _ { C } = A J _ { B } { \cdot } A I _ { C } ^ { \prime }$ 和 $\angle J _ { B } A J _ { C } = \angle I _ { B } ^ { \prime } A I _ { C } ^ { \prime }$，所以 $A J _ { B } J _ { C } \stackrel { + } { \sim } A I _ { B } ^ { \prime } I _ { C } ^ { \prime }$： □

我们采用有向角进行证明。根据引理3，四边形$I_B J_B J_C I_C$内接于圆当且仅当

$$
\begin{array} { r c l } { { } } & { { } } & { { \leqslant I _ { B } I _ { C } J _ { B } = \preceq I I _ { B } J _ { C } J _ { B } \iff \preceq I I _ { B } I _ { C } J _ { B } + \preceq M C B = \preceq I _ { B } J _ { C } J _ { B } + \preceq M N B } } \\ { { } } & { { } } & { { \iff \preceq ( I _ { B } I _ { C } , B C ) = \preceq ( M N , J _ { B } J _ { C } ) . } } \end{array}
$$

根据断言4，我们得到

$$
\begin{array} { l l } { { \ltimes \ltimes \ltimes J _ { B } J _ { C } , I _ { B } ^ { \prime } I _ { C } ^ { \prime } \ltimes \ltimes J _ { B } ^ { \prime } A I _ { B } ^ { \prime } } } \\ { { \ l } } \\ { { \ l } } \\ { { \ l } } \\ { { \ l } } \\ { { \ l } } \\ { { \ l } } \end{array} \ltimes \ltimes E { A I _ { B } } + \ l \times M A B
$$

这等价于 $\measuredangle ( B C , I _ { B } ^ { \prime } I _ { C } ^ { \prime } ) = \measuredangle ( M N , J _ { B } J _ { C } )$ 。因此，$I _ { B } J _ { B } J _ { C } I _ { C }$ 四点共圆当且仅当

$$
\measuredangle ( I _ { B } I _ { C } , B C ) = \measuredangle ( B C , I _ { B } ^ { \prime } I _ { C } ^ { \prime } ) .
$$

假设 $I _ { B } I _ { C }$ 平行于 $B C$ 。根据引理2，$I _ { B } ^ { \prime } I _ { C } ^ { \prime }$ 也平行于 $B C$ ，因此我们有 $\measuredangle ( I _ { B } I _ { C } , B C ) = \measuredangle ( B C , I _ { B } ^ { \prime } I _ { C } ^ { \prime } ) = 0 ^ { \circ }$ 。因此，$( * )$ 成立，所以 $I _ { B } J _ { B } J _ { C } I _ { C }$ 共圆。

![](images/fb234cc04268e68a3646e74e105462d39d87e964635fd2b862337fe854fd5bc0.jpg)

现在假设 $I _ { B } I _ { C }$ 不平行于 $B C$，而 $I _ { B } J _ { B } J _ { C } I _ { C }$ 是圆内接四边形。根据引理2，$I _ { B } I _ { C }$ ， $I _ { B } ^ { \prime } I _ { C } ^ { \prime }$ 和 $B C$ 交于一点 $Z$ 。由于 $I _ { B }$ 和 $I _ { C }$ 分别位于线段 $B I$ 和 $C I$ 上，$Z$ 必位于线段 $B C$ 之外。因为 $A$ 是 $ABD$ 的内切圆和 $A$-旁切圆的公外切线的交点，且 $ZD$ 是 $ABD$ 的内切圆和 $A$-旁切圆的公内切线，所以有 $( Z A , Z D ; Z I _ { B } , Z I _ { B } ^ { \prime } ) = - 1$ 。根据 (\*)，$Z D$ 平分 $\angle I _ { B } Z I _ { B } ^ { \prime }$，所以 $\angle A Z D = 9 0 ^ { \circ }$：即 $Z$ 是 $A$ 到 $B C$ 的垂足。但这意味着 $\angle A B C$ 或 $\angle B C A$ 是钝角，这与 $A B < A C < B C$ 的事实相矛盾： □

注.虽然为了简洁起见，我们使用调和束写出了这个解法，但也有方法可以在不使用射影几何的情况下证明断言2并得出最终的矛盾。断言2可以通过应用梅涅劳斯定理来证明，并且最终的矛盾可以利用一个三角形的旁切圆总是大于其内切圆这一事实来得到。

解法 3. 设 $\omega _ { B }$ 和 $\omega _ { C }$ 分别表示圆 $A I B$ 和圆 $A I C$。如解法 1 中那样引入点 $P$、$Q$ 和 $X$，并回顾解法 1 中的引理 1，$P$、$J _ { B }$ 和 $I _ { C }$ 共线，且 $J _ { B }$ 位于 $\omega _ { B }$ 上。由此，我们可以用 $X$ 来定义 $J _ { B }$ 和 $I _ { C }$：$I _ { C } = X P \cap C I$，而 $J _ { B } \neq P$ 是直线 $X P$ 与 $\omega _ { B }$ 的第二个交点。类似地，我们可以定义 $I _ { B } = X Q \cap B I$，而 $J _ { C } \neq Q$ 是直线 $X Q$ 与 $\omega _ { C }$ 的第二个交点。请注意，这现在将点 $I _ { B }$、$I _ { C }$、$J _ { B }$ 和 $J _ { C }$ 的定义与点 $D$ 和 $E$ 分离开来：

设 $\ell$ 为一条经过点 $I$ 的直线。现在我们允许点 $X$ 沿着 $\ell$ 移动，同时固定 $\triangle ABC$ 以及点 $I$、$P$ 和 $Q$。我们使用上述定义来构造点 $I_B$、$I_C$、$J_B$ 和 $J_C$。我们将分类所有这四个点共圆的情况。在本解法的其余部分，我们将使用有向角和有向长度。

出于非退化性的考虑，我们排除 $X = I$ 且 $X$ 位于直线 $BC$ 上的情况，这意味着 $I_B$、$J_B \ne B$ 且 $I_C$、$J_C \ne C$。我们也排除直线 $\ell$ 与圆 $\omega_B$ 或 $\omega_C$ 相切的情况。在这些情况下，类似的结果也成立，并且它们可以被当作极限情况来处理。

![](images/4113ae6369576d9572d0c1e57d69273b4d56cc250fcbdcbbed44d0368863779e.jpg)

命题 1. 直线 $I _ { B } J _ { B }$ 经过 $\omega _ { B }$ 上的一个定点，且直线 $I _ { C } J _ { C }$ 经过 $\omega _ { C }$ 上的一个定点，当 $X$ 在 $\ell$ 上变动时：

证明。设 $U \neq J _ { B }$ 为 $I _ { B } J _ { B }$ 与 $\omega _ { B }$ 的第二个交点。根据正弦定理，我们有

$$
\frac { I J _ { B } U } { U J _ { B } B } = \frac { \sin \preceq I J _ { B } I _ { B } } { \sin \preceq I _ { B } J _ { B } B } = \frac { \sin \preceq J _ { B } I I _ { B } } { \sin \preceq J _ { B } B I _ { B } } \cdot \frac { I I _ { B } } { I _ { B } B } = \frac { \sin \preceq J _ { B } I B } { \sin \preceq J _ { B } B I } \cdot \frac { I I _ { B } } { I _ { B } B } = \frac { \sin \preceq X P Q } { \sin \preceq X P I } \cdot \frac { I I } { I _ { B } }
$$

我们也有

$$
{ \frac { I I _ { B } } { I _ { B } B } } = { \frac { \sin \measuredangle I Q I _ { B } } { \sin \measuredangle I _ { B } Q B } } \cdot { \frac { | I Q | } { | B Q | } } = { \frac { \sin \measuredangle I Q X } { \sin \measuredangle X Q P } } \cdot { \frac { | I Q | } { | B Q | } } .
$$

结合这些，并在三角形 PIQ 中对点 X 应用塞瓦定理，我们得到，

$$
{ \frac { \xi I J _ { B } U } { U J _ { B } B } } = { \frac { \sin \xi X P Q } { \sin \xi X P I } } \cdot { \frac { \sin \ z I Q X } { \sin \xi X Q P } } \cdot { \frac { | I Q | } { | B Q | } } = { \frac { \sin \ z X I Q } { \sin \xi X I P } } \cdot { \frac { | I Q | } { | B Q | } } = { \frac { \sin \ z ( \ell , I Q ) } { \sin \ z ( \ell , I P ) } } \cdot { \frac { | I Q | } { | B Q | } }
$$

这与在$\ell$上对$X$的选择无关。由于$\measuredangle I J _ { B } U + \measuredangle U J _ { B } B = \measuredangle I J _ { B } B = \measuredangle I A B$是固定的，这就足以证明点$U$在$\omega _ { B }$上是固定的。

同样地，如果我们定义 $V \ne J _ { C }$ 为 $I _ { C } J _ { C }$ 与 $\omega _ { C }$ 的第二个交点，我们得到 $V$ 在 $\omega _ { C }$ 上是固定的：□

设 $G \neq X$ 和 $H \neq X$ 分别为 $\ell$ 与 $\omega _ { B }$ 和 $\omega _ { C }$ 的第二个交点，由于我们假设 $\ell$ 与 $\omega _ { B }$ 和 $\omega _ { C }$ 均不相切，故这两个交点存在。

断言 $\boldsymbol { \mathcal { Z } }$ 点U，G和Q共线，并且点V，H和P共线。

证明. 取 $X = G$ ， 我们有 $J _ { B } = G$ 且 $I _ { B } = X Q \cap B I$ 。 这两点都在直线 $\mathcal { Q } G$ 上，根据引理1，这表明 $U$ ， $G$ ， $Q$ 共线。 同理，$V$ ， $H$ ， $P$ 共线。 $\boxed { \begin{array} { r l } \end{array} }$

断言 3. 点 $I _ { B }$ ， $I _ { C }$ ， $J _ { B }$ ， $J _ { C }$ 共圆当且仅当点 $P$ ， $Q$ ， $G$ ， $H$ 共圆。特别地，此性质仅取决于 $\ell$ ，而不取决于 $\ell$ 上 $X$ 的选择：

证明。
我们有

$$
\begin{array} { l } { { \notin I _ { C } J _ { B } I _ { B } = \preceq P J _ { B } U = \preceq P G U = \preceq P G Q } } \\ { { \notin I _ { C } J _ { C } I _ { B } = \preceq V J _ { C } Q = \preceq V H Q = \preceq P H Q . } } \end{array}
$$

因此 $\measuredangle I _ { C } J _ { B } I _ { B } = \measuredangle I _ { C } J _ { C } I _ { B } \Longleftrightarrow \measuredangle P G Q = \measuredangle P H Q$，这证明了该论断。

断言 $\it 4$：$P$，$Q$，$G$，$H$ 共圆当且仅当 $\ell \in \{ IA, IP, IQ, t \}$，其中 $t$ 为圆 $BIC$ 在点 $I$ 处的切线：

证明.
当 $\ell = I A$ 时，我们有 $G = H = A$，因此引理3中的循环条件成立。
类似地，当 $\ell = I P$ 或 $\ell = I Q$ 时，分别有 $G = P$ 或 $H = Q$，因此循环条件再次成立。

现在，考虑 $\ell \not \in \{ I A , I P , I Q \}$ 的情况。在这种情况下，显而易见的是，四个点 $P$ ， $Q$ ， $G$ 和 $H$ 是不同的。于是我们有 $\angle Q P G = \angle B P G = \angle B I G$ ，所以

$$
{ } ^ { 5 } Q G H \ \mathrm { c o n c y c l i c } \iff { \forall } \ Q H G = { \exists } Q P G \iff { \exists } Q H G = { \exists } B I G \iff Q H \ \| \ B I .
$$

我们同样可以得到角CQH等于角CIH，所以

$$
B I C \Longleftrightarrow \varnothing C I H = \varnothing C B I \Longleftrightarrow \varnothing C Q H = \varnothing C B I \Longleftrightarrow Q H \parallel B I .
$$

因此，在这种情况下，$P$ 、 $Q$ 、 $G$ 、 $H$ 共圆当且仅当直线 $\ell$ 与圆 $B I C$ 相切，如前所述。

我们现在回到使用点D和E来定义点 $I _ { B }$、$I _ { C }$、$J _ { B }$、$J _ { C }$ 和 $X$，回到最初的设定。

命题 5. 设 $\Gamma$ 为经过点 $P$ 和点 $Q$ 且与 $IP$ 和 $IQ$ 相切的圆，由于 $IP = IQ = IA$，该圆存在。则点 $X$ 位于圆 $\Gamma$ 上。此外，点 $X$ 与点 $A$ 位于直线 $BC$ 的同侧，且点 $X$ 不在直线 $BC$ 上：

证明。
我们有

$$
\begin{array} { r l } & { \measuredangle X P I = \measuredangle J _ { B } P I = \measuredangle J _ { B } A I = \measuredangle B A I - \measuredangle B A J _ { B } = \measuredangle J _ { B } A J _ { C } - \measuredangle J _ { B } A E } \\ & { \qquad = \measuredangle E A J _ { C } = \measuredangle J _ { C } A C = \measuredangle J _ { C } Q C = \measuredangle X Q P , } \end{array}
$$

圆 $XPQ$ 与 $IP$ 相切。同理，圆 $XPQ$ 与 $IQ$ 相切，所以 $X$ 在 $\Gamma$ 上：

由于D位于线段BC的内部，I_C位于线段ζI的内部。由于X是PI_C与Γ的第二个交点并且IP与Γ相切，X位于Γ上弧$\hat{P}\hat{Q}$的内部，且在BC与A的同侧。这就证明了命题的第二部分。□

根据引理5，在原问题中，我们不能有 $\ell \in \{ I P , I Q \}$。此外，如解法1的引理2所示，我们有 $X$ 位于三角形 $I B C$ 内部，这意味着 $\ell \neq t$：因此，引理4中唯一剩下的可能性是 $\ell = A I$。于是我们有

$$
I _ { B } I _ { C } J _ { B } J _ { C } { \mathrm { ~ c o n c y c l i c } } \underbrace { { \mathrm { C l a i m } } 3 } _ { \begin{array} { c } { { P Q G H \mathrm { ~ c o n c y c l i c } } } \end{array} } \underbrace { { \mathrm { C l a i m } } 4 } _ { \begin{array} { c } { { \mathrm { } } } \\ { { \mathrm { } } } \end{array} } \underbrace { { } } X { \mathrm { ~ l i e s ~ o n ~ } } A I ,
$$

解决问题

注. 条件 $AB < AC < BC$ 在解答中被本质性地使用。在解答1中，它被用于引理3的证明，以确保点 $X$ 位于三角形 $IBC$ 的内部。在解答2中，它被用于最后一步，以确保 $\angle ABC$ 和 $\angle BCA$ 不能是钝角。在解答3中，它被用于排除 $\ell = t$ 的情况。如果该条件被移除，那么该命题不再成立：每当 $\angle ABC$ 或 $\angle BCA$ 为钝角时，总能在 $BC$ 上选取一点 $D$，使得 $I_B J_B J_C I_C$ 四点共圆，但 $AI$、$I_B J_C$ 和 $J_B I_C$ 三线不共点。这个反例的构造可以利用解答3来完成：令 $X$ 为直线 $t$ 与圆 $\Gamma$ 的交点，且该交点与 $A$ 位于直线 $BC$ 的同侧，然后按照解答中所述的方法构造 $I_B$、$I_C$、$J_B$ 和 $J_C$，由此我们可以重构出点 $D$：

反之，当$\angle A B C$和$\angle B C A$均非钝角时，命题成立，如解法2所示。因此，这是使该命题成立的、关于三角形ABC的最弱必要条件。

![](images/5babb5156d817935ab3bf68ec99b764e1321325518a23506cb8025ff4627e906.jpg)

当 $X$ 位于圆 $I B C$ 在点 $I$ 处的切线上时，
在解法1的命题3的证明中不存在矛盾：
圆 $I I _ { B } J _ { C }$ 和 $I J _ { B } I _ { C }$ 是互异的，
且 $X$ 是圆 $I I _ { B } J _ { C }$ 、 $I J _ { B } I _ { C }$ 和 $I _ { B } J _ { B } I _ { C } J _ { C }$ 的根心。
在解法2的最后一步中同样不存在矛盾，
并且事实上 $I _ { B } I _ { C }$ 和 $B C$ 相交于从 $A$ 到 $B C$ 的垂足。

方向 (1) => (2) 不存在构型问题。这个蕴含对于三角形 $A B C$ 无需任何限制都成立，并且解法1和解法2中的证明无需任何修改即可适用。

# 数论

# N1.

找出所有具有以下性质的正整数 $n$：对于 $n$ 的所有正因数 $d$，都有 $d + 1 \mid n$ 或 $d + 1$ 是素数。

(加纳)

答案：$n \in \{ 1 , 2 , 4 , 12 \}$

解法 1. 不难验证，$n = 1$ , 2, 4,12 都满足条件.我们必须证明它们是唯一的可能性.我们设 $n = 2 ^ { k } m$ ，其中 $k$ 是一个非负整数，$m$ 是奇数.因为 $m \mid n$ ，所以要么 $m + 1$ 是素数，要么 $m + 1 \mid n$ ：

在前一种情况下，因为 $m + 1$ 是偶数，所以它必须是 2，因此 $n \ = \ 2 ^ { k }$。如果 $k \geqslant 3$ ，我们就会得到一个矛盾，因为 $8$ 能整除 $n$ 而 $9$ 不能整除 $n$ 。因此 $k \leqslant 2$ ，所以 $n \in \{ 1 , 2 , 4 \}$ ：

在后一种情况下，我们有 $m + 1 \mid 2 ^ { k } m$ 且 $m + 1$ 与 $m$ 互质，因此 $m + 1 \mid 2 ^ { k }$。这意味着 $m + 1 = 2 ^ { j }$，其中 $2 \leqslant j \leqslant k$（因为当 $j = 1$ 时，$m = 1$，而这在之前已经考虑过）。

那么我们有 $2^{k} + 1 \nmid n$ ：因为 $2^{k} + 1$ 是奇数，它必须整除 $m$ 但它比 $m$ 大 ：因此，根据问题的条件，$2^{k} + 1$ 是素数。如果 $k = 2$，$j$ 也必须是 2，这就得到了解 $n = 12$。此外，对于 $k > 2$，有 $2^{k-1} + 1 \nmid n$ ：因为它是奇数，它必须整除 $m$ 。然而，对于满足 $j \leqslant k$ 的情况，我们没有 $2^{k-1} + 1 \mid 2^{j} - 1$ 的解 ：除非 $j = k$，否则左边大于右边；而当 $j = k$ 时，左边比右边的一半稍大。

由于我们有 $2^k$ 整除 $n$ 且 $2^k + 1$ 不整除 $n$ ，并且 $2^{k-1}$ 整除 $n$ 且 $2^{k-1} + 1$ 不整除 $n$ ，我们必然有 $2^k + 1$ 和 $2^{k-1} + 1$ 都是素数。然而，如果 $a$ 是奇数，那么 $2^a + 1$ 是 3 的倍数，所以我们必须有 $2^k + 1 = 3$ （这是不可能的，因为这会得出 $k = 1$ ）或 $2^{k-1} + 1 = 3$ ，这得出 $j = k = 2$ ，由此 $n = 12$ ：

解法 2. 我们如解法1中那样进行，直到确定出 $n = 2 ^ { k } ( 2 ^ { j } - 1 )$，其中 $j \leqslant k$：现在，我们有 $2 ^ { j } \mid n$ 但 $2 ^ { j } + 1 \nmid n$，因为它是奇数并且不能整除 $2 ^ { j } - 1$。因此，$2 ^ { j } + 1$ 是素数。费马素数理论告诉我们，我们必然有 $j = 2 ^ { h }$，其中 $h > 0$：

那么 $2 ^ { 2 ^ { h } } - 1$ 根据 $h$ 是奇数还是偶数，分别同余于 3 或 6 (模 9)。特别地，它不能被 9 整除，所以 $n = 2 ^ { k } ( 2 ^ { 2 ^ { h } } - 1 )$ 不能被 9 整除；所以我们必须有 $k \leqslant 2$ ，因为如果 $k \geqslant 3$，那么 $8 \mid n$ 但 $9 \nmid n$，且 9 不是素数。

解法 3. 设 $p$ 是不整除 $n$ 的最小整数。因为 $p - 1$ 是 $n$ 的一个因数，所以 $p$ 必定是一个素数。设 $1 \leqslant r \leqslant p - 1$ 为 $n$ 除以 $p$ 的余数。因为 $p - r < p$，所以 $p - r \mid n$，因此我们可以考虑因数 $\begin{array} { r } { d = \frac { n } { p - r } } \end{array}$

因为 $p \mid n - r$ ，我们有 $p \mid n + p - r$ ，因此 $p \mid d + 1$ 。因此 $d + 1 \nmid n$ ；所以它必须是素数。另一方面，这个素数可以被 $p$ 整除 ，所以我们得出结论 $d + 1 = p$ ，这意味着 $n = ( p - 1 ) ( p - r )$ ：

于是由 $p - 2 , p - 3 \mid n$ 得 $( p - 2 ) ( p - 3 ) \mid 2 ( p - r )$ ，由此可得

$$
( p - 2 ) ( p - 3 ) \leqslant 2 ( p - r ) \leqslant 2 ( p - 1 ) .
$$

解这个二次不等式得出 $p \leqslant 5$，这意味着 $n \in \{ 1 , 2 , 4 , 8 , 1 2 , 1 6 \}$。在这个集合中，$n = 8$ 和 $n = 1 6$ 不是解。

解法4。我们假设$n$既不是1也不是2。

因为 $n \mid n$ 并且 $n + 1 \nmid n$ ，我们知道 $n + 1$ 是素数。因此它是奇数，所以 $2 \mid n$；因为 $n > 2$，我们有 ${ \frac { n } { 2 } } \mid n$ 并且 $\textstyle { \frac { n } { 2 } } + 1 \nmid n$ ，所以 $\frac { n } { 2 } + 1$ 是素数。因此它也是奇数，所以 $4 \mid n$：

我们必须有$\textstyle { \frac { n } { 4 } } + 1 \mid n$或${ \frac { n } { 4 } } + 1$为素数。

在前一种情况下，$\frac { n } { 4 } \mid 4 ( \frac { n } { 4 } + 1 ) - n$ ，所以 $\frac { n } { 4 } + 1 \mid$ 4. 这意味着 $n = 4$ 或 $n = 12$ ：

在后一种情况下，如果 $n \neq 4$，则 $\frac{n}{4} + 1$ 必须是奇数。因此我们有 $n = 8m$，其中 $2m + 1$、$4m + 1$、$8m + 1$ 都是素数；$n = 8$ 不成立，所以 $3 \mid m$ (否则这些数中会有一个能被3整除)。因此 $24 \mid n$，所以 $25 \mid n$，因为25不是素数。

现在假设 $p$ 是不整除 $n$ 的最小正整数：如解法3中，我们知道 $p$ 是素数，并且我们到目前为止所做的工作表明 $p \geqslant 7$。如果 $p ^ { 2 } - 1 = ( p - 1 ) ( p + 1 )$ 是小于 $p$ 的互素整数的乘积，那么它整除 $n$，并且 $p ^ { 2 }$ 不是素数，所以也整除 $n$（这是一个矛盾）；$p - 1$ 和 $p + 1$ 都是偶数，并且没有大于2的公因数，因此它们乘积的所有奇素数幂因子都小于 $p$，并且 $p ^ { 2 } - 1$ 不是小于 $p$ 的互素整数乘积的唯一情况是当 $p - 1$ 和 $p + 1$ 之一是2的幂时，即 $2 ^ { m }$ （其中 $m \geqslant 3$ ）。如果 $p = 2 ^ { m } - 1$，那么 $3 p - 1 = 4 ( 3 \times 2 ^ { m - 2 } - 1 )$，并且 $3 \times 2 ^ { m - 2 } - 1$ 是一个小于 $p$ 的奇数，所以 $3 p - 1 \mid n$，因此 $3 p \mid n$。最后，如果 $p = 2 ^ { m } + 1$，那么 $m$ 是偶数，并且 $2 p - 1 = 2 ^ { m + 1 } + 1$ 是3的倍数；它是3的幂的唯一情况是当 $m = 2$ 时，但我们有 $m \geqslant 3$，所以 $2 p - 1$ 是小于 $p$ 的互素整数的乘积，我们再次得到一个矛盾。

解法 5. 如同在解法 4 中，我们推导出如果 $n > 2$，那么 $n$ 必须是偶数。我们记 $n = 2 \cdot 3 ^ { k } \cdot r$，其中 $k$ 是一个非负整数且 $3 \nmid r$

由于 $r$ 和 $2r$ 在模 3 下都不同且非零，所以它们中必然有一个同余于 2 模 3。我们设它为 $a r$，其中 $a \in \{ 1 , 2 \}$。

由于 ar 能整除 n，我们必然得到 ar + 1 要么是质数，要么是 n 的一个因数。在第一种情况下，ar + 1 = 3，因为 3 ∣ ar + 1，因此 n = 2 · 3^k · r，其中 r = 2 / a 为 1 或 2。注意到我们必须有 k ⩽ 1 (否则 9 ∣ n 但 10 ∤ n)，我们可以通过检验情况来推断出 n ∈ { 2 , 4 , 1 2 } 是仅有的可能性。

否则，$a r + 1 \mid n$ 。因为 $a r + 1$ 与 $r$ 互质 ，因此必有 $a r + 1 \mid 2 \cdot 3 ^ { k }$ ，并且根据假设 $3 \ | \ a r \ + \ 1$，我们推导出 $k \geqslant 1$ 。特别地，$3 ^ { k } + 1$ 是一个至少为 4 的偶数，因此它不是素数并且必须整除 $n$ 。因为它与 3 互质，因此必有 $3 ^ { k } + 1 \mid 2 r$ ：

设 $q _ { 1 }$ 和 $q _ { 2 }$ 满足 $q _ { 1 } ( a r + 1 ) = 2 \cdot 3 ^ { k }$ 和 $q _ { 2 } ( 3 ^ { k } + 1 ) = 2 r$ 。我们有 $q _ { 1 } a r < 2 \cdot 3 ^ { k }$ 和 $q _ { 2 } 3 ^ { k } < 2 r$ ，将它们相乘得到 $q _ { 1 } q _ { 2 } a < 4$ ：

如果 $a = 2$ 那么 $q _ { 1 } = q _ { 2 } = 1$ ，所以 $2 r + 1 = 2 \cdot 3 ^ { k }$ ，这是不可能的(考虑两边对2取模)。

如果 $a \ = \ 1$ 那么 $r$ 必须模 3 同余于 2，所以 $q _ { 2 } ( 3 ^ { k } + 1 ) = 2 r$ 可得 $q _ { 2 }$ 模 3 同余于 1，因此 $q _ { 2 } = 1$ 。因此我们推断出 $2 r = 3 ^ { k } + 1$ 。于是我们推断出 $q _ { 1 } ( 3 ^ { k } + 3 ) = 4 \cdot 3 ^ { k }$ ，整理可得 $3 ^ { k - 1 } ( 4 - q _ { 1 } ) = q _ { 1 }$ ，由此可得 $3 ^ { k - 1 } \leqslant q _ { 1 } < 4$ 并且 $k \leqslant 2$ 。我们可以通过检验各种情况来推断出 $n = 12$ 是唯一的可能性。

# N2.

确定所有有限、非空的正整数集合 $\boldsymbol { S }$，满足对于所有 $a$ ， $b \in S$，都存在 $c \in S$ 使得 $a$ 整除 $b + 2c$ ：

(荷兰)

答案：可能的集合是 ${ \cal { S } } = \{ t \}$ 和 $\boldsymbol { S } = \{ t , 3 t \}$，其中 $t$ 是任意正整数。

解法 1. 不失一般性，我们可以将 $\boldsymbol { S }$ 的所有元素除以任意一个公因子，之后它们不可能全部为偶数。由于当 $a$ 为偶数且 $b$ 为奇数时，$a \uparrow b + 2 c$ 为奇数，因此 $\boldsymbol { S }$ 的元素都为奇数。

我们现在分为三种情况：

情况1：$| S | = 1$ ： 集合 ${ \mathcal { S } } = \{ t \}$ 显然是可行的。

情况2：集合S的元素个数为2：

设 $\boldsymbol { \mathcal { S } } = \{ \boldsymbol { r } , \boldsymbol { s } \}$ 且 $r \ < \ s$ ，
因此要么 $s \mid r + 2 r$ 要么 $s \mid r + 2 s$ ，
无论哪种情况，都有 $s \mid 3 r$ 。
不可能有 $s = 3 r / 2$ ，因为我们假设 $r$ 是奇数，
所以 $s = 3 r$ 且 $\boldsymbol { S } = \{ \boldsymbol { r } , 3 \boldsymbol { r } \}$ ，
通过检验 $a$ 和 $b$ 的情况可以清楚地看到这是成立的：

情况3：$| S | \geqslant 3$

如果集合 $\boldsymbol { S }$ 的所有元素都是奇数，那么对于任意 $b$ ， $c \in S$ ， $b + 2 c \not \equiv b$ (mod 4)。如果 $a \mid b + 2 c$ 且 $a \equiv b$ (mod 4)，这意味着存在一个 $k$ 使得 $b + 2 c = k a$ 且 $k \equiv 3$ (mod 4)，所以 $k \geqslant 3$ 。如果 $a$ 是 $\boldsymbol { S }$ 的最大元素且 $b < a$ ，我们有 $b + 2 c < 3 a$ ，这是一个矛盾。因此，当 $a$ 是最大元素时，不存在 $b < a$ 满足 $b \equiv a$ (mod 4)（因此，除了最大元素之外的所有元素在模 4 下同余）。

令 $d$ 和 $e$ 分别是集合 $\boldsymbol { S }$ 的最大和第二大元素。令 $f \neq d , e$ 是集合 $\boldsymbol { S }$ 的任意其他元素。存在某个 $c \in S$ 使得 $e \mid f + 2 c$ 且 $e \not \equiv f + 2 c \pmod{4}$，所以 $f + 2 c \geqslant 3 e$，所以 $c > e$。由于 $e$ 是集合 $\boldsymbol { S }$ 的第二大元素，所以 $c = d$，所以 $e \mid f + 2 d$，并且这对于所有 $f \in S$ 且 $f < e$ 都成立，但这最多只能对一个这样的 $f$ 成立。因此 $| S | \leqslant 3$ ：

因此，$\boldsymbol { S }$ 的元素为 $d > e > f$，并且根据上述讨论，不失一般性，我们可以假设这些元素都是奇数，$e \equiv f$ (mod 4) 且 $d \not \equiv e$ (mod 4)。我们在上面已经得到 $e \mid f + 2 d$ 。此外，存在某个 $c \in S$ 使得 $d \mid f + 2 c$，且 $c \neq d$，因为 $d > f$ 所以 $d \nmid f$，所以 $c \leqslant e$；因为 $f + 2 e < 3 e$，我们有 $e > d / 3$ 。因为 $f + 2 c$ 是奇数且 $f + 2 c < 3 d$，我们有 $f + 2 c = d$：

子情况 3.1：$c = f$

这里 $d = 3f$ 且 $e \mid f + 2d = 7f$。由于 $e > f$ 且 $e \equiv f \pmod{4}$，我们有 $e = 7f / 3$ 且这些元素是 $\{ 3, 7, 9 \}$ 的一些倍数。但是 $a = 7$ 且 $b = 9$ 没有对应的 $c$ 值：

子情况 3.2：$c = e$

这里 $d = f + 2 e$ 且 $e \mid f + 2 d = 3 f + 4 e$，因此 $e \mid 3 f$。但是，在 $e > f$ 和 $e \equiv f$ (mod 4) 的情况下，这是不可能的。

解法 2. 与解法 1 类似，我们将其归约为 $\boldsymbol { S }$ 的所有元素均为奇数的情形。由于所有单元素集都满足给定条件，我们证明，如果 $| S | \geqslant 2$，那么 $| S | = 2$ 且 ${ \cal { S } } = \{ t , 3 t \}$，其中 $t$ 为某个正整数：

令 $d$ 为最大的元素。对于任意 $e \in S$ 且 $e \neq d$，必定存在一个 $f \in S$ 使得 $\textit { d } | \textit { e } + 2 f$。这意味着 $2 f \equiv - e$ (mod $d$ )，因此 $2 f \equiv d - e$ (mod $d$ )。现在，$d - e$ 是偶数（因为 $\boldsymbol { S }$ 中的所有元素都是奇数），且 $d$ 是奇数，所以 $\scriptstyle { \frac { d - e } { 2 } }$ 是一个整数，并且我们有 $\textstyle f \equiv { \frac { d - e } { 2 } }$ (mod $d$ )。此外，$\textstyle 0 < { \frac { d - e } { 2 } } < d$，同时我们必须有 $0 < f \leqslant d$，所以 $\begin{array} { r } { f = \frac { d - e } { 2 } } \end{array}$。我们得出结论，对于任意 $e \in S$ 且 $e \neq d$，整数 $\frac { d - e } { 2 }$ 也在 $\boldsymbol { S }$ 中并且不等于 $d$。

用 $e _ { 1 } < e _ { 2 } < \cdots < e _ { k } < d$ 表示 $\boldsymbol { S }$ 的元素，其中 $k \geqslant 1$ 。于是 $\begin{array} { r } { \frac { d - e _ { 1 } } { 2 } > \frac { d - e _ { 2 } } { 2 } > } \end{array}$ $\begin{array} { r } { \dots > { \frac { d - e _ { k } } { 2 } } } \end{array}$ 也是 S 的元素，且它们都不等于 d。因此，我们必须有 $\begin{array} { r } { e _ { 1 } = \frac { d - e _ { k } } { 2 } } \end{array}$ 和 $\begin{array} { r } { e _ { k } = \frac { d - e _ { 1 } } { 2 } } \end{array}$ ，所以 $2 e _ { 1 } + e _ { k } = d = 2 e _ { k } + e _ { 1 }$ 。由此可得 $e _ { 1 } = e _ { k }$ ，所以 $k = 1$ ，并且 $d = 2 e _ { k } + e _ { 1 } = 3 e _ { 1 }$因此 $\boldsymbol { S } = \{ e _ { 1 } , 3 e _ { 1 } \}$ ，其中 $e _ { 1 }$ 为某个正整数。

解法三. 如同解法一，我们将其归约为集合$\boldsymbol { S }$中所有元素均为奇数的情况。由于所有单元素集合都满足给定条件，我们证明，如果 $| S | \geqslant 2$，那么 $| S | = 2$ 且 ${ \cal { S } } = \{ t , 3 t \}$，其中 $t$ 为某个正整数：

令 $d$ 为最大元素，并令 $e \in S$ 为任意其他元素。我们称 $x \in S$ (模 $d$ )，如果在 $\{ 1 , \ldots , d \}$ 中满足 $x \equiv y$ (mod $d$ ) 的唯一元素 $y$ 是 $\boldsymbol { S }$ 的一个元素。注意，由于 $d$ 是最大元素，如果 $x \neq d$，那么 $x \not \equiv 0$ (mod $d$ )。给定的条件意味着，如果 $b \in S$，那么 $- { \frac { b } { 2 } } \in { \mathcal { S } }$ (模 $d$ )。重复此过程得到 $\begin{array} { r } { - \frac { b } { 2 } \in \mathcal { S } \Rightarrow \frac { b } { 4 } \in \mathcal { S } } \end{array}$ (模 $d$ )，并且通过迭代，我们有 $\begin{array} { r } { b \in \mathcal { S } \Rightarrow \frac { b } { ( - 2 ) ^ { k } } \in \mathcal { S } } \end{array}$ (模 $d$ )对于所有 $k$。由于 $d$ 是奇数，存在某个 $g$ 使得 $( - 2 ) ^ { g } \equiv 1$ (模 $d$ )，所以通过令 $k = g - 1$，我们得到

现在，如果 $\begin{array} { r } { e > \frac { d } { 2 } } \end{array}$ ，那么 $- 2 e \in { \mathcal { S } } { \mathrm { ~ ( m o d ~ } } d { \mathrm { ) } }$ 并且 $d - 2 e < 0$ ，所以 $2 d - 2 e \in S$ ，这与没有偶元素相矛盾。因此 $\begin{array} { r } { e < \frac { d } { 2 } } \end{array}$ 对于任意 $e \in { \mathcal { S } } \setminus \{ d \}$ ，所以我们有 $e \in S \Rightarrow d - 2 e \in S$ . 由于 $d - 2 e \neq d$ ，我们必然有 $\begin{array} { r } { d - 2 e < \frac { d } { 2 } } \end{array}$ ，整理可得 $\textstyle e > { \frac { d } { 4 } }$

设 $\lambda \in ( 0 , 1 )$ 为一个正实数，并假设我们已经证明了对于任意 $e \in { \mathcal { S } } \setminus \{ d \}$，有 $e > \lambda d$。10 $d - 2 e > \lambda d$ 可得 $\begin{array} { r } { e < \frac { ( 1 - \lambda ) d } { 2 } } \end{array}$ $\begin{array} { r } { d - 2 e < \frac { ( 1 - \lambda ) d } { 2 } } \end{array}$ $\textstyle e > { \frac { ( 1 + \lambda ) d } { 4 } }$ $\begin{array} { r } { \lambda _ { 0 } = \frac { 1 } { 4 } } \end{array}$ $\begin{array} { r } { \lambda _ { i } = \frac { 1 + \lambda _ { i - 1 } } { 4 } } \end{array}$ $i \geqslant 1$ $e \in { \mathcal { S } } \backslash \{ d \}$ 且对于所有 $\lambda _ { i }$，有 $e > \lambda _ { i } d$。现在注意到序列 $\lambda _ { i }$ 是递增的并且以 1 为上界，因此它收敛于某个极限 l，该极限满足 $l = \frac{1+l}{4}$。$\begin{array} { r } { \ell = \frac { 1 } { 3 } } \end{array}$ 因此 $\begin{array} { r } { e \geqslant \frac { d } { 3 } } \end{array}$ 但于是 $\begin{array} { r } { d - 2 e \geqslant \frac { d } { 3 } } \end{array}$ $\begin{array} { r } { e \leqslant \frac { d } { 3 } } \end{array}$ $e$ $\frac { d } { 3 }$

注释。我们也可以采用另一种方法完成解法3：在证明若$e \in { \mathcal { S } } \setminus \{ d \}$则$d - 2 e \in S \setminus \{ d \}$之后，注意到

$$
( d - 2 e ) - \frac { d } 3 = \frac { 2 d } 3 - 2 e = - 2 \left( e - \frac { d } 3 \right) .
$$

因此，考虑 $e \in { \mathcal { S } } \backslash \{ d \}$ 使得 $\left| e - \frac { d } { 3 } \right|$ 最大。如果 $\begin{array} { r } { e \neq \frac { d } { 3 } } \end{array}$ ，那么上述证明表明 $\begin{array} { r } { | ( d - 2 e ) - \frac { d } { 3 } | > | e - \frac { d } { 3 } | } \end{array}$ ，这是一个矛盾。因此 ${ \mathcal { S } } \setminus \{ d \}$ 为空集或等于 $\{ \frac { d } { 3 } \}$ ，这完成了证明。

# N3.

确定所有正整数序列 $a _ { 1 }$ ， $a _ { 2 }$ ，.\*. 使得对于任意正整数 $m \leqslant n$，其算术平均值和几何平均值

$$
\frac { a _ { m } + a _ { m + 1 } + \cdot \cdot \cdot + a _ { n } } { n - m + 1 } \mathrm { a n d } ( a _ { m } a _ { m + 1 } \cdot \cdot \cdot a _ { n } ) ^ { \frac { 1 } { n - m + 1 } }
$$

都是整数。

(新加坡)

答案：唯一满足条件的序列是常数序列（它们显然是成立的）。

解法 1. 我们称一个整数序列 $b _ { 1 }$ ， $b _ { 2 }$ ，... 是“好的”，如果对于任意一对满足 $m \leqslant n$ 的正整数，$b_m, b_{m+1}, \dots, b_n$ 的算术平均数是一个整数。那么，题目中的条件等价于说，序列 $\left( { { a } _ { i } } \right)$ 以及对于所有素数 $p$ 的序列 $\left( \nu _ { p } ( a _ { i } ) \right)$ 都是“好的”。

断言 1. 如果 $\left( b _ { i } \right)$ 是一个好序列，那么 $n - m \mid b _ { n } - b _ { m }$ 对于所有整数对 $m$ ， $n$。

证明. 这由 $n - m$ 整除 $b _ { m } + b _ { m + 1 } + \cdot \cdot \cdot + b _ { n - 1 }$ 和 $b _ { m + 1 } + b _ { m + 2 } + \cdot \cdot \cdot + b _ { n }$ 得出，然后作差. □

断言 2. 如果 $\left( b _ { i } \right)$ 是一个好序列，其中某个整数 $b$ 出现无限多次，那么 $\left( b _ { i } \right)$ 是常数。

证明。假设 $b _ { n _ { 1 } }$ ， $b _ { n _ { 2 } }$ ， $b _ { n _ { 3 } }$ ，... 都等于 $b$ 。那么对于所有的 $m$，$b - b _ { m } = b _ { n _ { j } } - b _ { m }$ 能被无限多个不同的整数 $n _ { j } - m$ 整除，所以它必须为零。因此该序列是常数。□

现在，对于一个给定的素数 $p$ ，我们考察序列 $\left( \nu _ { p } ( a _ { i } ) \right)$ 。令 $k = \nu _ { p } ( a _ { 1 } )$ 。那么引理1告诉我们，对于所有 $n$ ，有 $a _ { 1 } \equiv a _ { n p ^ { k + 1 } + 1 }$ (mod $p ^ { k + 1 }$ ），这意味着对于所有 $n$ ，有 $\nu _ { p } ( a _ { n p ^ { k + 1 } + 1 } ) = k$ ：现在我们有 $k$ 在这个优良序列中出现了无限多次，因此根据引理2，序列 $\left( \nu _ { p } ( a _ { i } ) \right)$ 是常数列。这对所有素数 $p$ 都成立，所以 $\left( a _ { i } \right)$ 实际上必须是常数列。

解法二。如同解法一中的断言1，我们有 $u _ { i + r } \equiv u _ { i }$ (mod $r$ )，这告诉我们序列 $a _ { i }$ 在模 $p$ 下是周期为 $p$ 的周期序列。此外，通过类似的论证，我们有 $a _ { i + r } / a _ { i }$ 是一个有理数的 $r$ 次方。

现在假设对于某些 $i \not \equiv j$ (mod $p$ ） 我们有 $a _ { i }$ ， $a _ { j } \not \equiv 0$ (mod $p$ ). 由于 $p$ 和 $p - 1$ 互质，我们可以找到一些 $i ^ { \prime } \equiv i$ (mod $p$ ） $j ^ { \prime } \equiv j$ (mod $p$ ） 使得 $p - 1 \mid i ^ { \prime } - j ^ { \prime }$ . 那么 $a _ { i ^ { \prime } } / a _ { j ^ { \prime } }$ 是一个完全 $( p - 1 ) ^ { \mathrm { t h } }$ 次方幂，所以

$$
a _ { i ^ { \prime } } = t u ^ { p - 1 } , \quad a _ { j ^ { \prime } } = t v ^ { p - 1 }
$$

对于某些不被 $p$ 整除的正整数 $t$ 、$u$ 、$\boldsymbol{v}$。根据费马小定理，$u ^ { p - 1 }$ 和 $v ^ { p - 1 }$ 在模 $p$ 下必为 1。因此必有

$$
a _ { i } \equiv a _ { i ^ { \prime } } \equiv t \equiv a _ { j ^ { \prime } } \equiv a _ { j } { \pmod { p } } .
$$

因此，所有不能被 $p$ 整除的 $a _ { i }$ 的值在模 $p$ 下同余：

为了使 $p$ 个连续值的和能被 $p$ 整除，这意味着所有的 $a _ { i }$ 都模 $p$ 同余。由于这对所有素数 $p$ 都成立，因此这个序列必须是常数列。

解法3 固定任意指标$m$。首先，我们证明对于充分大的$n$，$a_m$整除$a_n$。取充分大的$n$使得对于每个素数$p$都有$n > \nu_p(a_m) + m$。根据解法1的引理1，我们有

$$
\nu _ { p } ( a _ { m } ) \equiv \nu _ { p } ( a _ { n } ) { \pmod { n - m } } .
$$

因为 $\nu _ { p } ( a _ { m } ) < n - m$ ，所以 $\nu _ { p } ( a _ { m } ) \leqslant \nu _ { p } ( a _ { n } )$ 。这对每个素数 $p$ 都成立，因此 $a _ { m } \mid a _ { n }$

接下来，假设存在某个指标$k$使得$a_m$不整除$a_k$。根据前述，存在最大的这样的$k$。那么$a_{k+1}$，$a_{k+2}$，...都能被$a_m$整除。但此时应用第一个条件可得

$$
a _ { m } \mid a _ { k } + a _ { k + 1 } + \cdot \cdot \cdot + a _ { k + a _ { m } - 1 } ,
$$

$a_m$ 整除 $a_k$，这是一个矛盾。
因此，每一项 $a_n$ 都能被 $a_m$ 整除。

由于 $m$ 是任意的，我们现在得到对于所有 $m$，$n$，都有 $a_m$ 整除 $a_n$，反之亦然。所以该数列必为常数。


# N4. 

确定所有正整数 $a$ 和 $b$ 使得存在一个正整数 $g$ 使得 $\operatorname* { g c d } ( a ^ { n } + b , b ^ { n } + a ) = g$ 对于所有充分大的 $n$

(印度尼西亚)

答案：唯一的解是 $( a , b ) = ( 1 , 1 )$

解法1. 显然，当 $( a , b )= ( 1 , 1 )$ 时，我们可以取 $g = 2$。假设 $( a , b )$ 满足题目中的条件，令 $N$ 为一个正整数，使得对于所有 $n \geqslant N$，恒有 $\operatorname* { g c d } ( a ^ { n } +b , b ^ { n } +a ) = g$：

引理. 我们有 $g = \operatorname*{gcd}( a , b )$ 或 $g = 2 \operatorname*{gcd}( a , b )$

证明. 注意到 $a ^ { N } + b$ 和 $a ^ { N + 1 } + b$ 都可被 $g$ 整除.因此

$$
a ( a ^ { N } + b ) - ( a ^ { N + 1 } + b ) = a b - b = a ( b - 1 )
$$

可被 $g$ 整除。同理，$b ( a - 1 )$ 可被 $g$ 整除。它们的差 $a - b$ 因此可被 $g$ 整除，所以 $g$ 也整除 $a ( b - 1 ) + a ( a - b ) = a ^ { 2 } - a$。$a$ 的所有幂次因此在模 $g$ 下同余，所以 $a + b \equiv a ^ { N } + b \equiv 0$ (mod $g$)。于是 $2 a = ( a + b ) + ( a - b )$ 和 $2 b = ( a + b ) - ( a - b )$ 都可被 $g$ 整除，所以 $g \mid 2 \operatorname* { g c d } ( a , b )$。另一方面，显然 $\operatorname* { g c d } ( a , b ) \mid g$，从而证明了该引理。□

设 $d = \operatorname*{gcd}(a, b)$，并记 $a = d x$ 和 $b = d y$，其中 $x$ 和 $y$ 为互质的正整数。我们有

$$
\operatorname* { g c d } \left( ( d x ) ^ { n } + d y , ( d y ) ^ { n } + d x \right) = d \operatorname* { g c d } \left( d ^ { n - 1 } x ^ { n } + y , d ^ { n - 1 } y ^ { n } + x \right) ,
$$

因此引理表明

$$
\operatorname* { g c d } \left( d ^ { n - 1 } x ^ { n } + y , d ^ { n - 1 } y ^ { n } + x \right) \leqslant 2
$$

对于所有 $n \geqslant N$ 。定义 $K = d ^ { 2 } x y + 1$ ，注意 $K$ 与 $d$ 、$x$ 和 $y$ 均互质。根据欧拉定理，当 $n \equiv - 1$ （模 $\varphi ( K )$ ）时，我们有

$$
d ^ { n - 1 } x ^ { n } + y \equiv d ^ { - 2 } x ^ { - 1 } + y \equiv d ^ { - 2 } x ^ { - 1 } ( 1 + d ^ { 2 } x y ) \equiv 0 { \pmod { K } } ,
$$

s0 $K \mid d^{n-1}x^n + y$。类似地，我们有 $K \mid d^{n-1}y^n + x$。取这样一个满足 $n \geqslant N$ 的 $n$，我们得到

$$
K \mid \operatorname* { g c d } ( d ^ { n - 1 } x ^ { n } + y , d ^ { n - 1 } y ^ { n } + x ) \leqslant 2 .
$$

这只有在 $d = x = y = 1$ 时才可能，由此得出唯一的解 $( a , b ) = ( 1 , 1 )$

解决方案2. 在证明引理后，即可如下完成证明：

对于$ab+1$的任意素因子$p$，$p$与$a$和$b$互质。取一个$n \geqslant N$，使得$n \equiv -1$ (mod $p - 1$)。根据费马小定理，我们有

$$
\begin{array} { r l } & { a ^ { n } + b \equiv a ^ { - 1 } + b = a ^ { - 1 } ( 1 + a b ) \equiv 0 \pmod p , } \\ & { b ^ { n } + a \equiv b ^ { - 1 } + a = b ^ { - 1 } ( 1 + a b ) \equiv 0 \pmod p , } \end{array}
$$

那么 $p$ 整除 $g$。根据引理，我们有 $p \mid 2 \operatorname*{gcd}(a, b)$，因此 $p = 2$。因此，$a b + 1$ 是 2 的幂，且 $a$ 和 $b$ 都是奇数。

如果 $( a , b ) \neq ( 1 , 1 )$ ，那么 $a b + 1$ 能被4整除，因此 $\{ a , b \} = \{ - 1 , 1 \}$ (mod 4)。对于奇数 $n \geqslant N$ ，我们有

$$
a ^ { n } + b \equiv b ^ { n } + a \equiv ( - 1 ) + 1 = 0 { \pmod { 4 } } ,
$$

那么 $4 \mid g$ 。但是根据引理，我们有 $\nu _ { 2 } ( g ) \leqslant \nu _ { 2 } ( 2 \operatorname* { g c d } ( a , b ) ) = 1$ ，这是一个矛盾。所以该问题的唯一解是 $( a , b ) = ( 1 , 1 )$ ：

# N5.

设 $\boldsymbol { S }$ 为一个素数的有限非空集合。设 $1 = b _ { 1 } < b _ { 2 } < \cdots$ 为所有素因子均属于 $\boldsymbol { S }$ 的正整数构成的序列。证明，对于除有限个外的所有正整数 $n$，都存在正整数 $a _ { 1 }$，$a _ { 2 }$，…，$a _ { n }$ 使得

$$
{ \frac { a _ { 1 } } { b _ { 1 } } } + { \frac { a _ { 2 } } { b _ { 2 } } } + \cdots + { \frac { a _ { n } } { b _ { n } } } = \left\lceil { \frac { 1 } { b _ { 1 } } } + { \frac { 1 } { b _ { 2 } } } + \cdots + { \frac { 1 } { b _ { n } } } \right\rceil .
$$

(克罗地亚)

$\boldsymbol{S}$ $p$ $t，g$ $b_{i} = p^{i-1}$ $a_{1}$ $a_{n}$ $\begin{array}{r}{2\ =\ \left|\sum_{i=0}^{n-1}{\frac{1}{p^{i}}}\right|\ =\ \sum_{i=0}^{n-1}{\frac{a_{i}}{p^{i-1}}}}\end{array}$ $a_{1} = a_{2} = \cdot\cdot\cdot = a_{n-1} = 1$ $a_{n} =$ $p^{n-1} - (p + p^{2} + \ldots + p^{n-2})$ $：$

更一般地，观察到 $\frac{1}{b_i}$ 对所有 $i$ 的和是

$$
\begin{array} { l } { \displaystyle \sum _ { i } \frac { 1 } { b _ { i } } = \prod _ { i } \left( 1 + \frac { 1 } { p _ { i } } + \frac { 1 } { p _ { i } ^ { 2 } } + \dots \right) } \\ { \displaystyle = \prod _ { p \in \mathcal { S } } \frac { p } { p - 1 } . } \end{array}
$$

特别地，若$n$充分大，则

$$
\left\lceil \sum _ { j = 1 } ^ { n } \frac { 1 } { b _ { j } } \right\rceil = \left\lceil \prod _ { p \in \mathcal { S } } \frac { p } { p - 1 } \right\rceil .
$$

在证明的其余部分，我们仅考虑足够大的 $n$，使得该等式成立。接下来，我们处理特例 ${ \mathcal { S } } = \{ 2 , 3 \}$，其乘积为 3。首先，设

$$
a _ { i } = { \left\{ \begin{array} { l l } { 1 , } & { { \mathrm { i f ~ } } 2 b _ { i } \leqslant b _ { n } { \mathrm { ; } } } \\ { 2 , } & { { \mathrm { i f ~ } } 2 b _ { i } > b _ { n } . } \end{array} \right. }
$$

然后，

$$
\sum _ { i \leqslant n } { \frac { a _ { i } } { b _ { i } } } = \left\{ { \frac { 2 } { 3 ^ { t } } } , \quad { \mathrm { i f ~ } } b _ { n } \geqslant 3 ^ { t } ; \right.
$$

因此，

$$
\begin{array} { r } { \displaystyle \sum _ { i \leqslant n } \displaystyle \frac { a _ { i } } { b _ { i } } = \displaystyle \sum _ { t \geqslant 0 } \displaystyle \frac { 2 } { 3 ^ { t } } } \\ { = \displaystyle 3 - \displaystyle \frac { 1 } { 3 ^ { T } } } \end{array}
$$

其中 $T$ 是满足 $3 ^ { t } \leqslant b _ { n }$ 的最大的 $t \geqslant 0$。因此，将 $a _ { j }$ 增加 1（其中 $b _ { j } = 3 ^ { T }$ ），可以得到一个可行的 $a _ { i }$ 序列。

否则，我们可以假设 $| { \cal S } | > 1$ 并且 ${ \cal S } \ \ne \ \{ 2 , 3 \}$，这意味着乘积 $\textstyle { \big \vert } \ln _{ p \in S } { \frac { p } { p - 1 } }$ 不是一个整数。事实上，

·如果 $| S | > 2$，那么2至少整除分母两次，因此也整除整个分数的分母；
·如果 $| S | = 2$ 并且 $2 \notin S$，那么2整除分母但不整除分子；

·如果 $S = \{ 2 , p \}$，那么乘积为 $2 p / ( p - 1 )$，对于 $p > 3$，该值不是一个整数：

由此可得，对于某个固定的 $\alpha > 0$，我们有

$$
\left\lceil \prod _ { p \in { \cal S } } { \frac { p } { p - 1 } } \right\rceil = \prod _ { p \in { \cal S } } { \frac { p } { p - 1 } } + \alpha ,
$$

由此可知

$$
\left\lceil \sum _ { i = 1 } ^ { n } { \frac { 1 } { b _ { i } } } \right\rceil - \sum _ { i = 1 } ^ { n } { \frac { 1 } { b _ { i } } } > \alpha .
$$

现在只需证明以下论断。

断言。假设 $n$ 足够大，并令 $e _ { p }$ 为满足 $p ^ { e _ { p } } \leqslant b _ { n }$ 的最大非负整数，令 $\begin{array} { r } { M = \prod _ { p \in S } p ^ { e _ { p } } } \end{array}$ 。如果 $u$ 是一个满足 $u / M > \alpha$ 的正整数，那么存在非负整数 $a _ { i }$ 使得

$$
\sum _ { i } { \frac { a _ { i } } { b _ { i } } } = { \frac { u } { M } } .
$$

问题陈述如下：将每个 $a _ { i }$ 替换为 $a _ { i } + 1$ 后

为了证明这一点，选择某个常数 $c$ 使得 $\textstyle \sum _ { p \in S } p ^ { - c } < \alpha$，并假设 $n$ 足够大以至于对于每个 $p\in S$ 都有 $p ^ { c } < b _ { n }$；特别地，$p ^ { c } \mid M$，其中 $M$ 如上定义。

对于每个 $p \in S$ ，设 $i _ { p }$ 满足 $b _ { i _ { p } } = p ^ { e _ { p } }$ ，并选择满足条件的最小非负整数 $a _ { i _ { p } }$

$$
p ^ { e _ { p } - c } \Bigm \lvert a _ { i _ { p } } \left( \frac { M } { p ^ { e _ { p } } } \right) - u .
$$

这样的 $a _ { i _ { p } }$ 必须存在并且至多为 $p ^ { e _ { p } - c }$ ；事实上，$\frac { M } { p ^ { e _ { p } } }$ 是一个与 $p$ 互质的整数，因此我们可以取 $a _ { i _ { p } }$ 等于 $u$ 乘以它模 $p ^ { e _ { p } - c }$ 的乘法逆元。来自 $a _ { i _ { p } }$ 的贡献之和至多为

$$
\sum _ { p \in S } { \frac { p ^ { e _ { p } - c } } { p ^ { e _ { p } } } } = \sum _ { p \in S } p ^ { - c } < \alpha .
$$

所以，我们有

$$
{ \frac { u } { M } } = \sum _ { p \in S } { \frac { a _ { i _ { p } } } { p ^ { e _ { p } } } } + { \frac { r } { \prod _ { p \in S } p ^ { c } } } ,
$$

其中，由于我们对 $a _ { i _ { p } }$ 的选择，$r$ 是一个整数，并且由于 $u$ 的界限，$r$ 是非负的。只需选择 $a _ { i } = r$，其中 $b _ { i } = \textstyle { \big \vert } \operatorname { l } _ { p \in S } p ^ { c }$，即可完成证明。

解法 2. 我们将其归结为解法1中的命题，并提供一种构造 $a _ { i }$ 的替代方法：

令 $p _ { 0 } \in S$ 为 $\boldsymbol { S }$ 中最小的素数 令 $z _ { 0 } = u / M$ 。 我们通过以下迭代过程构造一个序列 $z _ { 0 }$，$z _ { 1 }$，$z _ { 2 }$，……以及 $a _ { i }$ 的值： 为了构造 $z _ { j + 1 }$，

· 选择能整除 $z_j$ 分母的集合 $S$ 中的最大素数 $p$，并令 $\mu$ 为 $p$ 整除 $z_j$ 分母的次数：，   
· 选择最大的 $\nu$ 使得 $p_0^\nu p^\mu \leqslant b_n$，并令 $i \leqslant n$ 满足 $b_i = p_0^\nu p^\mu$：，   
· 选择 $0 \leqslant a_i < p$ 使得 $z_k - a_i / b_i$ 的分母至多含有 $\mu - 1$ 个 $p$ 的因子，并令 $z_{k+1} = z_k - a_i / b_i$ ·，   
· 继续此过程，直到 $p_0$ 是唯一能整除 $z_k$ 分母的素数：

注意，我们总可以在步骤3中选择$a _ { i }$；由构造可知，$z _ { k } b _ { i }$的分母中不含$p$的因子，因此它必须被实现为$\mathbb { Z } _ { p }$的一个元素。

每次我们这样做时，根据构造都有 $b _ { i } > M / p _ { 0 }$，所以

$$
\frac { a _ { i } } { b _ { i } } < \frac { p p _ { 0 } } { M } \leqslant \frac { p _ { 0 } p _ { 1 } } { M } ,
$$

其中 $p _ { 1 }$ 是 $\boldsymbol { S }$ 中最大的质数。并且我们执行此操作的次数最多为

$$
\sum _ { \stackrel { p \in S } { p > p _ { 0 } } } e _ { p } \leqslant | S | \log _ { 2 } ( M ) ,
$$

因此我们已分配的$a _ { i } / b _ { i}$之和至多为$| S | p _ { 0 } p _ { 1 } \log _ { 2 } ( M ) / M$

选择足够大的 M 使得 $\log _ { 2 } ( M ) / M < \alpha$；根据上述界限，从 r 中减去上述选择的 $a _ { i } / b _ { i }$ 后的结果是正的。只需设 $a _ { i } = r$，其中 r 根据构造是一个整数，并且 $b _ { i } = p _ { 0 } ^ { e _ { p _ { 0 } } }$，我们便得到一个形如 $r / p _ { 0 } ^ { \epsilon _ { p _ { 0 } } }$ 的量以完成证明。

解法三. 如同在解法一中，我们可以分别处理 $| { \cal S } | = 1$ 和 ${ \mathcal { S } } = \{ 2 , 3 \}$ 的情况；否则，我们可以像在那个解法中一样定义 $\alpha$。同样，定义 $e _ { p }$ 为满足 $p ^ { e _ { p } } \leqslant b _ { n }$ 的最大非负整数，如同我们在解法一中做的那样。

我们将证明，当 $n$  充分大时，可以选取某个 $j \leqslant n$ ，以及正整数 $a _ { i }$ ，使得

$$
\sum _ { i \neq j } { \frac { a _ { i } } { b _ { i } } } - \sum _ { i \neq j } { \frac { 1 } { b _ { i } } } < \alpha .
$$

并且所有的 $\frac { a _ { i } } { b _ { i } }$ 都是 $\frac { 1 } { b _ { j } }$ 的整数倍。然后我们设定 $a _ { j }$ 为最小的正整数，使得左边的和是一个整数，这显然会具有所需的值。

具体地，选择 $j$ 使得 $\begin{array} { r } { b _ { j } \ = \ \prod _ { p \in S } p ^ { \lfloor e _ { p } / \rfloor S \prod } } \end{array}$ ，根据构造该值小于 $b _ { n }$。对于 $i \neq j$，令 $a _ { i } = b _ { i } / \operatorname* { g c d } \left( b _ { i } , b _ { j } \right)$。我们有

$$
\sum _ { i \neq j } { \frac { a _ { i } } { b _ { i } } } - \sum _ { i \neq j } { \frac { 1 } { b _ { i } } } < \sum _ { i \neq j } { \frac { a _ { i } } { b _ { i } } } .
$$

二 $a _ { i } > 1$ , 则必然存在某个 $p \in S$ 使得 $p ^ { \lfloor e _ { p } / S \rfloor + 1 } \mid b _ { i }$ , 因此

$$
\frac { a _ { i } } { b _ { i } } = \frac { 1 } { \operatorname* { g c d } \left( b _ { i } , b _ { j } \right) } \leqslant \frac { 1 } { p ^ { \lfloor e _ { p } / \lvert S \rvert ] } } < \frac { p } { b _ { n } ^ { 1 / \lvert S \rvert } } ,
$$

其中最后一个不等式由以下事实得出：$p ^ { e _ { p } + 1 } > b _ { n }$

现在 $\begin{array} { r } { n \leqslant \prod _ { p \in { \cal S } } ( \log _ { p } ( b _ { n } ) + 1 ) \leqslant ( 2 \log b _ { n } ) ^ { | { \cal S } | } } \end{array}$ ，s0

$$
\sum _ { i \neq j } \frac { a _ { i } } { b _ { i } } \leqslant \frac { ( 2 \log b _ { n } ) ^ { | \mathcal { S } | } } { b _ { n } ^ { 1 / | \mathcal { S } | } } ,
$$

因此我们可以选取足够大的 $n$ 使得这个量小于 $\alpha$，如要求所示。

# N6.

设 $n$ 为一个正整数。我们称一个具有整数系数的多项式 $P$ 是 $n$-好的，如果存在一个具有整数系数的二次多项式 $Q$，使得对于任意整数 $k$，$Q ( k ) ( P ( k ) + Q ( k ) )$ 都不被 $n$ 整除：

确定所有整数$n$，使得每个具有整数系数的多项式都是$n$-好多项式。

(法国)

答案：这样的 $n$ 的集合是任何 $n > 2$

解法 1. 首先，观察到没有多项式是1-好的（因为 $Q ( X ) ( P ( X ) + Q ( X ) )$ 在模 1 下总有根），并且多项式 $P ( X ) = 1$ 不是 2-好的（因为 $Q ( X ) ( Q ( X ) + 1 )$ 总能被 2 整除）。

现在，如果 $P$ 对于某个 $Q$ 是 $d$ -好的，那么 $Q \cdot ( P + Q )$ 在模 $d$ 下没有根。因此，对于 $d \mid n$ ，它在模 $n$ 下肯定没有根，所以 $P$ 必须是 $n$ -好的。因此，只需证明当 $n$ 是一个奇素数，或 $n = 4$ 时，所有多项式都是 $n$ -好的：

我们从处理 $n = 4$ 的情况开始。我们将构造一个 $Q$，使得 $Q ( X )$ 永远不被 4 整除，并且 $Q ( X ) + P ( X )$ 总是奇数；这将清楚地表明 $P$ 是 4-好的。注意，模 2 的任意函数必须是常数或线性的——换句话说，存在 $a , b \in \{ 0 , 1 \}$ 使得对于所有 $X$，都有 $P ( X ) = a X + b$ mod 2。如果 $a = 0$，则设 $Q ( X ) = 4 X ^ { 2 } + b + 1$，并且如果 $a = 1$，则设 $Q ( X ) = X ^ { 2 } + b + 1$；在所有情况下，$Q$ 都将满足所需的性质。

尚需证明任意多项式是 $p$-好的，其中 $p$ 是一个奇素数。我们将证明，对于任何模 $p$ 定义的函数 $f$，都存在一个在模 $p$ 下无根的二次多项式 $Q$，使得对于所有 $x$，都有 $Q ( x ) \neq f ( x )$ mod $p$；关于 $P$ 的命题即可通过将 $f$ 替换为 $-P$ 得出。在证明的其余部分，我们将在模 $p$ 下考虑所有等式。

假设存在一个不满足上述条件的函数 $f$；换句话说，$f$ 具有以下性质：对于任何在模 $p$ 下无根的二次多项式 $Q$，都存在某个 $x$ 使得 $Q ( x ) = f ( x )$ .不失一般性，我们可以假设 $f$ 在模 $p$ 下无根。为了理解其原因，假设对于某个 $u$，有 $f ( u ) = 0$，并令 $g$ 为如下函数：当 $x \neq u$ 时，$g ( x ) = f ( x )$，并且 $g ( u ) = 1$ .对于任何无根的 $Q$，我们知道存在某个 $x \neq u$ 使得 $P ( x ) = f ( x )$，因此对于那个选定的 $x$，有 $P ( x ) = g ( x )$ .特别地，$g$ 也不是 $p$-良的。

现在，首先假设存在某个非零的 $t$，使得 $t$ 不在 $f$ 的像中。
那么我们可以取 $Q ( X ) = p X ^ { 2 } + t$；这个二次式永不等于 $f$ 且永不等于零。
因此，$f$ 必须是到模 $p$ 的非零剩余类上的满射。
$X$ 有 $p$ 种取值，而模 $p$ 的非零剩余类有 $p-1$ 个，因此必然存在模 $p$ 下互不相同的 $x_1$ 和 $x_2$，使得 $f ( x _ { 1 } ) = f ( x _ { 2 } )$，并且 $f$ 是从模 $p$ 的剩余类中除去 $x_2$ 后的集合到模 $p$ 的非零剩余类集合的一个双射：

现在，请注意，我们可以选择任意的 $b$ 和 $c$，其中 $b$ 非零，并将 $f ( X )$ 替换为 $g ( X ) =$ $f ( b X + c )$；如果存在某个无根的 $Q$，使得对于所有 $x$，都有 $Q ( x ) \neq g ( x)$，那么 $Q ( X / b { - } c / b )$ 对 $f$ 就适用。选择 $b$ 和 $c$ 使得 $b x _ { 1 } + c = 1$ 且 $b x _ { 2 } + c = - 1$；这样的 $b$ 和 $c$ 必然存在（我们可以取 $b = 2 / ( x _ { 1 } - x _ { 2 } )$ 和 $c = ( x _ { 1 } + x _ { 2 } ) / ( x _ { 2 } - x _ { 1 } )$）。将 $g$ 重命名为 $f$，我们看到我们可以假设 $f ( 1 ) = f ( - 1 )$：

令 $r ^ { \prime }$ 为模 $p$ 的一个二次非剩余。选择 $y \ne 0$ 使得 $f ( y ) = ( 1 - r ^ { \prime } ) f ( 0 )$，这样的 $y$ 必然存在，因为右边非零且 $1 - r ^ { \prime }$ 不等于 1。选择 $r = y ^ { 2 } / r ^ { \prime }$，它是一个二次非剩余。

考虑 $\phi ( X ) = f ( X ) / ( X ^ { 2 } - r )$ 。根据定义，$\phi ( 1 ) = \phi ( - 1 )$ 且 $\phi ( 0 ) = \phi ( y )$ ，因此 $\phi$ 的像中至多有 $p - 2$ 个值。选择某个不在 $\phi$ 的像中的非零 $a$，于是 $f ( X ) / ( X ^ { 2 } - r )$ 永不等于 $a$ 。该二次多项式 $Q ( X ) = a ( X ^ { 2 } - r ) $ 永不等于零，并且也永不等于 $f ( X )$ ，这便完成了证明。

评论。事实上，没有必要从多项式 $P$ 转换到函数 $f$，因为模 $p$ 的任何函数都是一个多项式。具体来说，与其从 $f$ 转换到 $g$，我们本可以将 $P ( X )$ 替换为 $P ( X ) + 1 - ( X - u ) ^ { p - 1 }$，这是一个除了在 $X = u$ 点之外都保持不变的多项式：

解 2.给定一个模 $p$ 的函数 $f$，使得 $f$ 是 $\mathbb { Z } / p \mathbb { Z }$ 的非零元素上的满射且 $f ( 1 ) = f ( - 1 )$，我们提供一种替代方法来构造一个非零二次式 $Q ( X )$ 使得 $Q ( X ) \neq f ( X )$。令 $r$ 为模 $p$ 的最小二次非剩余（因此 $r - 1$ 是一个平方），并且令 $a$ 取遍模 $p$ 的非零元素；我们将证明，可以选择某个 $a$ 使得 $Q _ { a } ( X ) = a ( X ^ { 2 } - r )$。注意，任何此形式的二次式都将无处为零。

假设没有这样的 $Q _ { a }$ 成立。那么，对于每一个 $a$，都存在一个 $x$ 使得 $a ( x ^ { 2 } - r ) = f ( x )$ 我们可以假设 $x \neq - 1$，因为如果等式在 $x = - 1$ 时成立，那么它在 $x = 1$ 时也成立： 然而，$a ( x ^ { 2 } - r ) = f ( x )$ 意味着 $a = f ( x ) / ( x ^ { 2 } - r )$ ，所以 $f ( x ) / ( x ^ { 2 } - r )$ 必须是一个从 $\{ x \neq - 1 \}$ 到所有非零 $a$ 的集合的满射，因此这是一个双射。特别地，对于每一个 $a$，都存在一个唯一的 $x _ { a }$ 使得 $f ( x _ { a } ) = a ( x _ { a } ^ { 2 } - r )$ ：

我们现在拥有

$$
\begin{array} { c } { { \displaystyle \prod _ { t \neq 0 } t = \prod _ { a \neq 0 } f ( x _ { a } ) } } \\ { { = \displaystyle \prod _ { a \neq 0 } a \prod _ { a \neq 0 } ( x _ { a } ^ { 2 } - r ) } } \\ { { = \displaystyle \prod _ { a \neq 0 } a \prod _ { x \neq - 1 } ( x ^ { 2 } - r ) } } \end{array}
$$

其中第一个等式成立是因为 $f$ 是一个到模 $p$ 的非零剩余类上的满射，而第二个等式由 $x _ { a }$ 的定义得出。这两个乘积相互抵消，这意味着 $\begin{array} { r } { \prod _ { x \neq - 1 } ( x ^ { 2 } - r ) = 1 } \end{array}$：

然而，我们也获得

$$
\prod _ { x \ne - 1 } ( x ^ { 2 } - r ) = ( - r ) ( 1 - r ) \left( \prod _ { x = 2 } ^ { ( p - 1 ) / 2 } ( x ^ { 2 } - r ) \right) ^ { 2 } .
$$

然而，这是一个矛盾，因为 $- r ( 1 - r ) = r ( r - 1 )$，而该式不是一个二次剩余（根据我们对 $r$ 的选择）。

注.根据威尔逊定理，我们知道模 $p$ 的非零元素的乘积是 $- 1$，然而，这一事实对于解决该问题并非必要，因此我们选择在呈现解答时无需陈述它。

注：实际上可以证明

$$
\prod _ { x \neq - 1 } ( x ^ { 2 } - r ) = { \frac { - 4 r } { 1 - r } } .
$$

为此，注意到多项式 $X ^ { \frac { p - 1 } { 2 } } - 1$ 以 $\frac { p - 1 } { 2 }$ 个二次剩余为根，因此我们有

$$
\prod \quad ( X - s ) = X ^ { \frac { p - 1 } { 2 } } - 1
$$

等等

$$
\prod _ { x \neq 0 } ( X - x ^ { 2 } ) = ( X ^ { \frac { p - 1 } { 2 } } - 1 ) ^ { 2 } .
$$

由于 $r$ 是二次非剩余，根据欧拉准则，$r ^ { \frac { p - 1 } { 2 } } = - 1$，由此得证。

因此，可以将“$r$ 是最小的二次非剩余”这一条件替换为“$r$ 是一个不等于 $- \frac { 1 } { 3 }$ 的二次非剩余”这一条件（这对于所有 $p \geqslant 3$ 都是可能的）。

解法三. 如同解法一，我们将问题归约到 $p$ 为奇素数且 $f$ 为一个模 $p$ 的无根函数，其值域为模 $p$ 的非零剩余集的情形，尽管我们不对满足 $f ( x _ { 1 } ) = f ( x _ { 2 } )$ 的 $x _ { 1 }$ 和 $x _ { 2 }$ 的值做任何假设：

我们将再次考虑形如 $Q _ { a , b , c } ( X ) = a R ( b X + c )$ 的二次式，其中 $R ( X ) = X ^ { 2 } - r$，$r$ 为一个任意固定的二次非剩余，$a$ 和 $b$ 是模 $p$ 的非零元，并且 $c$ 是模 $p$ 的任意剩余：

对于每一个固定的 $b$ 和 $c$，必然存在 $n$ 对 $( a , x )$ 使得 $a R ( b x + c ) = f ( x )$，因为对于每一个 $x$，$a$ 都必须有且仅有一个值。如果某个 $a$ 没有出现在任何这样的对中，那么我们就完成了，因此我们假设情况并非如此。换句话说，必须有且仅有一个 $a$ 使得存在两个这样的 $x$，而对于所有其他的 $a$，都只有一个这样的 $x$：

因此，对于每一个 $( b , c )$ ，恰好有一个无序对 $\{ x _ { 1 } , x _ { 2 } \}$ 使得存在某个 $a$ 满足 $f ( x _ { i } ) = a R ( b x _ { i } + c )$ ；换句话说，恰好有一个无序对 $\{ x _ { 1 } , x _ { 2 } \}$ 使得 $f ( x _ { 1 } ) / R ( b x _ { 1 } + c ) = f ( x _ { 2 } ) / R ( b x _ { 2 } + c )$

现在，我们表明，对于每一个无序对 $\{ x _ { 1 } , x _ { 2 } \}$，必须存在至少一个对 $( b , c )$ 使得 $f ( x _ { 1 } ) / R ( b x _ { 1 } + c ) = f ( x _ { 2 } ) / R ( b x _ { 2 } + c )$ 。事实上，令 $t = f ( x _ { 1 } ) / f ( x _ { 2 } )$ 。必须存在某些 $x _ { 1 } ^ { \prime } , x _ { 2 } ^ { \prime }$ 使得 $R ( x _ { 1 } ^ { \prime } ) / R ( x _ { 2 } ^ { \prime } ) = t$ ；这是因为 $R ( X )$ 和 $t R ( X )$ 在模 $p$ 下都取 $\textstyle { \frac { p + 1 } { 2 } }$ 个非零值，所以根据鸽巢原理，它们的交集必须非空。选择 $b$ 和 $c$ 使得 $b x _ { 1 } + c = x _ { 1 } ^ { \prime }$ 且 $b x _ { 2 } + c = x _ { 2 } ^ { \prime }$ ，便得到结论。

进一步注意，如果 $( b , c )$ 和 $\{ x _ { 1 } , x _ { 2 } \}$ 满足该关系，那么对于 $( - b , - c )$ 和 $\{ x _ { 1 } , x _ { 2 } \}$ 也同样成立，因为 $R ( b x + c ) = R ( - b x - c )$。由于 $b$ 非零，这意味着每一对 $\{ x _ { 1 } , x _ { 2 } \}$ 至少对应于两对 $( b , c )$。然而，由于有 $p ( p - 1 )$ 个 $b$ 非零的 $( b , c )$ 对和 $p ( p - 1 ) / 2$ 个无序对 $\{ x _ { 1 } , x _ { 2 } \}$，每个 $\{ x _ { 1 } , x _ { 2 } \}$ 必须恰好对应于两对 $( b , c )$ 和 $( - b , - c )$，其中 $( b , c )$ 为某一对：

现在，由于 $f$ 的像只有 $p - 1$ 个元素，所以必然存在一些 $x _ { 1 }$ ， $x _ { 2 }$ 使得 $f ( x _ { 1 } ) = f ( x _ { 2 } )$ 。任意选择 $b$ ， $c$ 使得 $b x _ { 1 } + c = - ( b x _ { 2 } + c )$ ，所以 $R ( b x _ { 1 } + c ) = R ( b x _ { 2 } + c )$ 并且 $f ( x _ { 1 } ) / R ( b x _ { 1 } + c ) = f ( x _ { 2 } ) / R ( b x _ { 2 } + c )$ 。对任意非零 $b$，都存在 $c$ 使得 $(b,c)$ 是这样的对，所以至少有 $p - 1$ 个这样的对，并且对于 $p \geqslant 5$ ，这个数量大于 2：

最后，对于 $p = 3$ 的特殊情况，我们观察到对于每个 $x$，$Q(x)$ 必须至少有一个允许的值，因此通过拉格朗日插值法，必然存在这样一个二次多项式 $Q$。

注释.我们也可以如下处理 p=3 的情况。回想一下，我们可以假设 f 是非零的，并且是模 3 下到 {1, 2} 上的满射，因此 f 的像必须是 (1, 1, 2) 或 (1, 2, 2) 的某种排列。不失一般性，设 f(1) = f(2)，因此我们要么有 (f(0), f(1), f(2)) = (1, 2, 2)，要么有 (2, 1, 1)。在第一种情况下，取 Q(X) = 2X² + 2，在第二种情况下取 Q(X) = X² + 1：

在某种意义上，这相当于拉格朗日插值法，因为在每种情况下，多项式 $Q ( X )$ 都可以通过拉格朗日插值来确定。

解法 4. 同样地，我们将其归约为 $p$ 是一个奇素数且 $f$ 是一个模 $p$ 的函数的情况；我们将证明存在一个无处为零的二次式，使得方程 $Q ( x ) = f ( x )$ 无解。我们可以如同解法 3 中那样单独处理 $p = 3$ 的情况，因此假设 $p \geqslant 5$ ：

我们将证明以下更一般的命题：令 $p \geqslant 5$ 为一个素数，并令 $\mathcal { A } _ { 1 }$ ， $\boldsymbol { \mathcal { A } } _ { 2 }$ ， ..., $A _ { p }$ 为 $\mathbb { Z } / p \mathbb { Z }$ 的子集，且对于所有 $i$，都有 $| { \mathcal { A } } _ { i } | = 2$。那么存在一个次数至多为2的多项式 $Q \in \mathbb { Z } / p \mathbb { Z } [ X ]$，使得对于所有 $i$，都有 $Q ( i ) \notin { \mathcal { A } } _ { i }$。事实上，将此命题应用于集合 $\mathcal { A } _ { i } = \{ 0 , f ( i ) \}$（并在必要时加上 $p X ^ { 2 }$），便可得到一个满足所需性质的二次多项式 $Q$。

从 $\mathbb { Z } / p \mathbb { Z }$ 中均匀随机地选择 $Q$ 的系数，并令 $T$ 为表示满足 $Q ( i ) \in \mathcal { A } _ { i }$ 的 $i$ 的数量的随机变量。注意到对于 $k \leqslant 3$ ，我们有

$$
\mathbb { E } \left[ { \binom { T } { k } } \right] = 2 ^ { k } { \binom { p } { k } } p ^ { - k } .
$$

要明白为何，令 $k \leqslant 3$ 如果 $S \subseteq \mathbb { Z } / p \mathbb { Z }$ 的大小为 $k$ 且 $( a _ { i } ) _ { i \in \mathcal { S } }$ 是一个 $k$ 元组，那么在 $\boldsymbol{S}$ 上 $Q(i) = a_i$ 的概率等于 $p^{-k}$；当 $k=3$ 时，这由拉格朗日插值法可得，而对于 $k<3$

这可由 $k=3$ 的情况通过求和得出。因此，期望等于大小为 $k$ 的子集 $S \subseteq \mathbb { Z } / p \mathbb { Z }$ 的数量乘以对于每个 $i \in S$，$Q ( i ) \in \mathcal { A } _ { i }$ 的概率，由于每个 $A _ { i }$ 的大小为 2，这等于右式。

现在，观察到我们有恒等式 $( t - 1 ) ( t - 3 ) ( t - 4 ) = - 1 2 + 1 2 { \binom { t } { 1 } } - 1 0 { \binom { t } { 2 } } + 6 { \binom { t } { 3 } }$

$$
\begin{array} { l } { { [ ( T - 1 ) ( T - 3 ) ( T - 4 ) ] = - 1 2 + 1 2 \mathbb { E } \left[ \binom { T } { 1 } \right] - 1 0 \mathbb { E } \left[ \binom { T } { 2 } \right] + 6 \mathbb { E } \left[ \binom { T } { 3 } \right] } } \\ { { \mathrm { } = - 1 2 + 1 2 \cdot 2 - 1 0 \cdot 2 \left( 1 - \frac { 1 } { p } \right) + 6 \cdot \frac { 4 } { 3 } \left( 1 - \frac { 1 } { p } \right) \left( 1 - \frac { 2 } { p } \right) } } \\ { { \mathrm { } = - \frac { 4 } { p } + \frac { 1 6 } { p ^ { 2 } } . } } \end{array}
$$

这在 $p \geqslant 5$ 时为负。因为对于所有整数 $t > 0$，$( t - 1 ) ( t - 3 ) ( t - 4 ) \geqslant 0$，因此，$T = 0$ 以正概率成立，这意味着必然存在某个 $Q$，使得对于所有 $i$，$Q ( i ) \notin { \mathcal { A } } _ { i }$，如所愿。

注.在此论证中，我们没有太多选择余地来用一个不同的多项式代替 $R ( T ) \ =$ $( T - 1 ) ( T - 3 ) ( T - 4 )$。事实上，可以证明（通过比较 $\binom { T } { K }$ 的系数）如果 $R$ 的次数最多为 3，那么当 $p$ 趋向于无穷大时，$R ( T )$ 的期望值趋向于 ${ \frac { 1 } { 3 } } ( R ( 4 ) + 2 R ( 1 ) )$，因此 $R$ 必须同时以 1 和 4 为根。特别地，$R$ 必须具有如下形式 $R ( T ) = ( T - 1 ) ( T - 4 ) ( T - d )$，其中 $d \geqslant 3$，并且如果 $d < 4$，那么该论证对任何 $p > 4 / ( 4 - d )$ 都成立：

# N7.

令 $\mathbb { Z } _ { > 0 }$ 表示正整数集合。设 $f \colon \mathbb { Z } _ { > 0 } \to \mathbb { Z } _ { > 0 }$ 是一个满足以下性质的函数：对于 $m$，$n \in \mathbb { Z } _ { > 0 }$，方程

$$
f ( m n ) ^ { 2 } = f ( m ^ { 2 } ) f ( f ( n ) ) f ( m f ( n ) )
$$

当且仅当 $m$ 和 $n$ 互质时成立。

对于每一个正整数 $n$，确定 $f(n)$ 的所有可能的值。

(日本)

答案：所有与 $n$ 具有相同质因数集的数：

通用说明。我们将给定的性质称为 $P ( m , n )$ 。我们用 $\operatorname { r a d } ( n )$ 表示 $n$ 的根：即 $n$ 的所有不同素因数的乘积：

解决方案 1. 我们从一系列直接推导开始：

·由 $P ( 1 , 1 )$ 可得 $f ( 1 ) ^ { 2 } = f ( 1 ) f ( f ( 1 ) ) ^ { 2 }$ ，所以 $f ( 1 ) = f ( f ( 1 ) ) ^ { 2 }$   
·由 $P ( 1 , f ( 1 ) )$ 可得 $f ( f ( 1 ) ) ^ { 2 } = f ( 1 ) f ( f ( f ( 1 ) ) ) f ( f ( f ( 1 ) ) )$ ，所以 $f ( f ( f ( 1 ) ) ) = 1$   
·由 $P ( 1 , f ( f ( 1 ) ) )$ 可得 $f ( f ( f ( 1 ) ) ) ^ { 2 } = f ( 1 ) f ( f ( f ( f ( 1 ) ) ) ) f ( f ( f ( f ( 1 ) ) ) )$ ，这可以简化为 $1 = f ( 1 ) ^ { 3 }$ ，所以 $f ( 1 ) = 1$ ：  
·由 $P ( 1 , n )$ 可推导出 $f ( n ) = f ( f ( n ) )$ 对于所有 $n$ ：  
·由 $P ( m , 1 )$ 可推导出 $f ( m ) = f ( m ^ { 2 } )$ 对于所有 $m$ ：  
Ωimnlif.inm D/m \~)  h +h>t

$$
f ( m n ) ^ { 2 } = f ( m ) f ( n ) f ( m f ( n ) )
$$

当且仅当 $m$ 和 $n$ 互质；将此记为 $Q ( m , n )$ ：

·由 $Q ( m , f ( n ) )$ ，可得 $f ( m f ( n ) ) \ = \ f ( m ) f ( n )$ 当且仅当 $m$ 和 $f ( n )$ 互质；将此记为 $R ( m , n )$

断言.
如果 $f(a) = 1$，则 $a = 1$。

证明. 如果 $a \neq 1$，那么 $Q ( a , a )$ 给出 $f ( a ) ^ { 2 } \neq f ( a ) ^ { 2 } f ( a f ( a ) )$。如果 $f ( a ) = 1$，那么两边都化简为 1，这是一个矛盾。□

断言。若 $n \neq 1$，则 $\operatorname* { s c d } ( n , f ( n ) ) \neq 1$

证明. 如果 $\operatorname* { g c d } ( n , f ( n ) ) = 1$ ，那么 $Q ( f ( n ) , n )$ 给出 $f ( n f ( n ) ) ^ { 2 } \ = \ f ( n ) ^ { 3 }$ ，并且 $Q ( n , f ( n ) )$ 给出 $f ( n f ( n ) ) ^ { 2 } = f ( n ) ^ { 2 } f ( n f ( n ) )$ ，这两者一起推出 $f ( n ) = 1$ ，从而产生矛盾。 □

断言. 对于所有的 $n$，我们有 $\operatorname{rad}(n)$ 整除 $f(n)$

证明. 对于任意整除 $n$ 的素数 $p$，将 $n$ 记作 $p^{v}n^{\prime}$，其中 $p$ 不整除 $n^{\prime}$。根据 $Q(p^{v}, n^{\prime})$，我们有 $f(n)^{2} =$ $f(p^{v})f(n^{\prime})f(p^{v}f(n^{\prime}))$。由于 $\gcd(p^{v}, f(p^{v})) \neq 1$，因此 $p \mid f(p^{v})$，所以 $p \mid f(n)$，从而 $\operatorname{rad}(n) \mid f(n)$： □

断言. 如果 $n$ 与 $f ( k )$ 互质，那么 $f ( n )$ 与 $f ( k )$ 互质

证明. 由 $Q ( f ( k ) , n )$ 可得 $f ( n f ( k ) ) ^ { 2 } = f ( k ) f ( n ) f ( f ( k ) f ( n ) )$ ；将 $R ( n , k )$ 应用于 LHS，我们得出 $f ( k ) f ( n ) = f ( f ( k ) f ( n ) )$ 。应用 $R ( f ( n ) , k )$，我们推断出 $f ( n )$ 与 $f ( k )$ 互质，如所求。 □

断言. 如果 $p$ 是素数，那么 $f(\boldsymbol{p})$ 是 $p$ 的幂：

证明. 假设不然. 我们知道 $p \mid f ( p )$ ; 令 $q \neq p$ 为另一个满足 $q \mid f ( p )$ 的素数： 如果对于某个正整数 $N$，我们有 $p \nmid f ( N )$，那么 $f ( \boldsymbol p )$ 与 $f ( N )$ 互质，所以 $q \nmid f ( N )$，所以 $q \nmid N$ ; 因此，如果 $q \mid N$，那么 $p \mid f ( N )$ （特别地，通过取 $N = q$，有 $p \mid f ( q )$）

类似地，如果 $q \nmid f ( N )$ 那么 $f ( q )$ 与 $f ( N )$ 互质；由于 $p \mid f ( q )$ ，这意味着 $p \nmid f ( N )$ ，所以 $p \nmid N$ 因此，如果 $p \mid N$ ，那么 $q \mid f ( N )$ ：

结合 $\operatorname { r a d } ( n ) \mid f ( n )$ ，这意味着对于任意与 $p q$ 不互质的 $n$ ，有 $p q \mid f ( n )$。

令 $m = \operatorname*{min} \{ \nu _ { p } ( f ( x ) ) \mid x$ 不与 $p q$ 互质 $\}$，并且令 $X$ 为一个不与 $p q$ 互质的正整数，使得 $\nu _ { p } ( f ( X ) ) = m$。上面的论证表明 $m \geqslant 1$。我们可以写成 $f ( X ) =$ $p ^ { m } q ^ { y } X ^ { \prime }$，其中 $y \geqslant 1$，$p \nmid X ^ { \prime }$ 并且 ${ q } \nmid X ^ { \prime }$。因为 $f ( f ( X ) ) = f ( X )$，所以我们有 $f ( p ^ { m } q ^ { y } X ^ { \prime } ) = p ^ { m } q ^ { y } X ^ { \prime }$。应用 $Q ( p ^ { m } , q ^ { y } X ^ { \prime } )$ 得到 $( p ^ { m } q ^ { y } X ^ { \prime } ) ^ { 2 } \ : = \ : f ( p ^ { m } ) f ( q ^ { y } X ^ { \prime } ) f ( p ^ { m } f ( q ^ { y } X ^ { \prime } ) )$。右边能被 $p ^ { 3 m }$ 整除，但左边仅能被 $p ^ { 2 m }$ 整除，从而产生矛盾。□

断言. 对于任何整数 $n$ ， $\operatorname{根}(f(n)) = \operatorname{根}(n)$ ：

证明. 我们已经知道 $\operatorname { r a d } ( n ) \mid f ( n )$ ，因此，只需证明没有其他素数整除 $f ( n )$ 。如果 $p$ 是素数且 $p \nmid n$ ，根据前面的引理，$n$ 与 $f ( \boldsymbol p )$ 互质，因此 $f ( n )$ 与 $f ( \boldsymbol p )$ 互质；即 $p \nmid f ( n )$ 。所以，整除 $f ( n )$ 的素数与整除 $n$ 的素数完全相同： □

剩下的只需展示一些函数，以证明所有满足 $\operatorname{rad}(f(n)) = \operatorname{rad}(n)$ 的 $f(n)$ 的值都是可能的。
对于每个素数 $p$，给定 $e(p) \geqslant 1$，取

$$
f ( n ) = \prod _ { p \mid n } p ^ { e ( p ) }
$$

我们通过检验每个质因数的指数来验证，这符合题目条件。

注释。一个更快但不太直接的 $f(1) = 1$ 的证明是：设 $f(n) = M$ 为 $f$ 取得的最小值；然后 $P(1, n)$ 给出 $M^2 = f(n)^2 = f(1) f(f(n))^2 \geqslant M^3$，所以 $M = 1$ 且 $f(1) = 1$：

解法 2. 如同在解法 1 中，我们看到确实存在满足给定条件并生成所有 $f ( n )$ 给定值的函数 $f$，并且我们遵循解法 1 来证明以下事实：

· $f ( 1 ) = 1$ ：对于所有 $m$，$f ( m ) = f ( m ^ { 2 } )$   
· 对于所有 $n$，$f ( n ) = f ( f ( n ) )$   
： $f ( m n ) ^ { 2 } = f ( m ) f ( n ) f ( m f ( n ) )$ 当且仅当 $m$ 和 $n$ 互质；将此称为 $Q ( m , n )$ ：

联立 $Q ( m , n )$ 与 $Q ( n , m )$ 可得 $f ( m f ( n ) ) = f ( n f ( m ) )$ 证 $m$ 和 $n$ 互质。现在假设 $m$ 与 $n$ 及 $f(n)$ 均互质。有 $f ( m n ) ^ { 2 } = f ( m ) f ( n ) f ( m f ( n ) )$ 且两边平方后得到

$$
\begin{array} { l } { f ( m n ) ^ { 4 } = f ( m ) ^ { 2 } f ( n ) ^ { 2 } f ( m f ( n ) ) ^ { 2 } } \\ { \quad \quad = f ( m ) ^ { 2 } f ( n ) ^ { 2 } f ( m ) f ( f ( n ) ) f ( m f ( f ( n ) ) ) } \\ { \quad \quad = f ( m ) ^ { 3 } f ( n ) ^ { 3 } f ( m f ( n ) ) . } \end{array}
$$

因此 $f ( m f ( n ) ) = f ( m ) f ( n )$ ，于是 $f ( m n ) ^ { 2 } = f ( m ) ^ { 2 } f ( n ) ^ { 2 }$ ，于是 $f ( m n ) = f ( m ) f ( n ) = f ( m f ( n ) ) = f ( n f ( m ) )$ ：

若$m$与$n$和$f(n)$均互质，但$n$与$f(m)$不互质，我们有

$$
\begin{array} { r l } & { f ( n f ( m ) ) ^ { 2 } \neq f ( n ) f ( f ( m ) ) f ( n f ( f ( m ) ) ) } \\ & { \quad \quad = f ( n ) f ( m ) f ( n f ( m ) ) } \\ & { \quad \quad = f ( n f ( m ) ) ^ { 2 } , } \end{array}
$$

一个矛盾.因此，给定 $m$ 和 $n$ 互质，我们知道 $m$ 与 $f ( n )$ 互质当且仅当 $n$ 与 $f ( m )$ 互质.特别地，如果 $p$ 和 $q$ 是不同的素数，那么 $p$ 整除 $f ( q )$ 当且仅当 $q$ 整除 $f ( p )$ ，同样地，对于任意正整数 $k$ ， $p \mid f ( q ^ { k } )$ 当且仅当 $q \mid f ( p )$ ：更一般地，如果 $p \nmid n$ ，那么 $p \mid f ( n )$ 当且仅当 $n$ 与 $f ( \boldsymbol p )$ 不互质

现在构造一个图，其顶点是素数，并且在素数 $p \neq q$ 之间存在一条边当且仅当 $p \mid f ( q )$ (因此 $q \mid f ( p ) )$ ；每个顶点的度数都是有限的。
对于任意整数 $n$ ，所有整除 $f ( n )$ 的素数是所有与任意满足 ${ \boldsymbol { q } } \mid n$ 的素数 ${ \boldsymbol { q } }$ 相邻的素数，并可能还包含一些满足 $p \mid n$ 的其他素数：

如果 $p$ 和 $q$ 是不同的素数，我们有 $f ( p f ( q ) ) = f ( q f ( p ) )$ . 左边能被所有（在图中）是 $p$ 的邻居或 $q$ 的邻居的邻居的素数整除，并且也可能被 $p$ 以及一些是 $q$ 的邻居的素数整除，而一个将 $p$ 和 $q$ 互换后的对应陈述适用于右边.因此，任何是 $q$ 的邻居的邻居的素数必须是以下之一：$p$、$q$、与 $q$ 的距离为 1，或与 $p$ 的距离为 1 或 2.对于任何与 $q$ 的距离为 2 的素数 $r$，与它的距离小于或等于 2 的素数 $p$ 只有有限个，因此通过选择一个合适的素数 $p$（取决于 $q$），我们得出结论：每一个是 $q$ 的邻居的邻居的素数实际上就是 $q$ 本身或 $q$ 的一个邻居.

所以，图的连通分量是（有限的）完全图。如果 $m$ 仅被一个分量中的素数整除，并且 $n$ 仅被另一个分量中的素数整除，那么 $f ( m n ) = f ( m ) f ( n )$ 如果 $n$ 被一个分量中的多个素数整除，那么考虑将 $f ( m n ) ^ { 2 }$ 的表达式应用于 $n$ 的连续素数幂除数，可以表明 $f ( n )$ 可被该分量中的所有素数整除。然而，尽管 $f ( p ^ { k } )$ 可被 $p$ 所在分量中的所有素数整除（$p$ 本身可能除外），但我们尚不知道 $p \mid f ( p ^ { k } )$ ： 我们现在来考虑一个分量的阶的各种情况。

对于任意素数 $p$ ，我们不能有 $f ( p ^ { k } ) = 1$ ，因为 $Q ( p ^ { k } , p ^ { k } )$ 给出

$$
f ( p ^ { 2 k } ) ^ { 2 } \neq f ( p ^ { k } ) f ( p ^ { k } ) f ( p ^ { k } f ( p ^ { k } ) ) ,
$$

并使用 $f ( m ^ { 2 } ) = f ( m )$ 进行简化，得到 $1 \neq 1$ 。所以，对于一个1阶分量，$f ( p ^ { k } )$ 是 $p$ 的一个正幂次，因此它与 $p$ 具有相同的素因子集合，正如所要求的。

现在考虑一个阶至少为 2 的分支。由于 $f ( f ( n ) ) \ : = \ : f ( n )$ ，如果该分支的阶至少为 3，那么对于任何其质因数都在该分支中的 $n \ne 1$，$f ( n )$ 可被该分支中的所有质数整除。如果该分支的阶为 2，我们上面看到，除了可能 $n = p ^ { k }$ 的情况外，这是成立的。然而，如果该分支中的质数是 $p$ 和 $q$，且 $f ( p ^ { k } ) = q ^ { \ell }$，那么 $f ( q ^ { \ell } ) = f ( f ( p ^ { k } ) ) = f ( p ^ { k } ) = q ^ { \ell }$，这与 $p \mid f ( q ^ { \ell } )$ 矛盾。因此，对于任何阶至少为 2 的分支，以及任何其质因数都在该分支中的 $n \neq 1$，$f ( n )$ 可被该分支中的所有质数整除。

在一个阶至少为2的分支中，令 $m$ 为该分支中所有素数的乘积，并且令 $t$ 为最大的整数使得对于所有素因子都在该分支中的 $n \ne 1$，都有 $m ^ { t } \mid f ( n )$；我们已经看到 $t \geqslant 1$ 。如果 $m$ 和 $n$ 是大于1的互质数，且其所有素因子都在该分支中，那么根据 $Q ( m , n )$ 我们可知 $m ^ { 3 t / 2 } \mid f ( m n )$ 。对于任意 $n ^ { \prime } \ne 1$，其所有素因子都在该分支中，$f ( n ^ { \prime } )$ 能被该分支中的所有素数整除，因此可以表示为这样的一个乘积，所以 $m ^ { 3 t / 2 } \mid f ( f ( n ^ { \prime } ) ) = f ( n ^ { \prime } )$ 。但这意味着 $t \geqslant 3 t / 2$，这是一个矛盾，因此所有分支的阶都为1，于是我们得证。

![](images/21ce890c2e307c9cd53c43744a441bdbaebff30fc0fceed53c2be4ddfe518c8d.jpg)